<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="UTF-8">
		<title>Adding Event System 2.3 into 2.0 - Source - Eclipse Community</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<link rel="shortcut icon" href="http://www.touchofdeathforums.com/community/favicon.ico">
		<link rel="image_src" href="http://www.touchofdeathforums.com/community/public/style_images/eclipse31/meta_image.png">
                <link href="Event%20System%202.3%20into%202.0.php_files/css.css" rel="stylesheet" type="text/css">
		<script async="" src="Event%20System%202.3%20into%202.0.php_files/cbgapi.loaded_0"></script><script src="Event%20System%202.3%20into%202.0.php_files/all.js" id="facebook-jssdk"></script><script type="text/javascript">
		//<![CDATA[
			jsDebug			= 0; /* Must come before JS includes */
			USE_RTE			= 1;
			DISABLE_AJAX	= parseInt(0); /* Disables ajax requests where text is sent to the DB; helpful for charset issues */
			inACP			= false;
			var isRTL		= false;
			var rtlIe		= '';
			var rtlFull		= '';
		//]]>
		</script>
		
	
				
	

				
	

				
	

				
	

				
	

				
	
	
		<link rel="stylesheet" type="text/css" media="screen,print" href="Event%20System%202.3%20into%202.0.php_files/index.css">
	

<!--[if lte IE 7]>
	<link rel="stylesheet" type="text/css" title='Main' media="screen" href="http://www.touchofdeathforums.com/community/public/style_css/css_4/ipb_ie.css" />
<![endif]-->
<!--[if lte IE 8]>
	<style type='text/css'>
		.ipb_table { table-layout: fixed; }
		.ipsLayout_content { width: 99.5%; }
	</style>
<![endif]-->
<!--[if IE 9]>
	<style type='text/css'>
</style>
<![endif]-->

	<style type="text/css">
		img.bbc_img { max-width: 100% !important; }
	</style>

		<meta property="og:title" content="Adding Event System 2.3 into 2.0 - Source">
		<meta property="og:site_name" content="Eclipse Community">
		<meta property="og:image" content="http://www.touchofdeathforums.com/community/public/style_images/eclipse31/meta_image.png">
		<meta property="og:type" content="article">
		
	
		
			<meta name="keywords" content="Adding,Event,System,into,first,off,credit,goes,Jcsnider,did,rip,own,project,make,tutsorry,multi,posts">
		
		
		
	

		
			<meta name="description" content="Page 1 of 2 - Adding Event System 2.3 into 2.0 - posted in Source: first off, all credit goes to Jcsnider all i did was rip it into my own project. and make the tut.sorry for the multi posts. but i typed it 2x and both times it cut me off. on the 3rd try i wanted to be sure it would work.this may contain errors in the begining as its alot and i may have missed something.&nbsp; just post here or pm me and ill try to figure out whats missing if anything.there are a few things that you need t...">
		
		
		
			<meta property="og:description" content="Page 1 of 2 - Adding Event System 2.3 into 2.0 - posted in Source: first off, all credit goes to Jcsnider all i did was rip it into my own project. and make the tut.sorry for the multi posts. but i typed it 2x and both times it cut me off. on the 3rd try i wanted to be sure it would work.this may contain errors in the begining as its alot and i may have missed something.&nbsp; just post here or pm me and ill try to figure out whats missing if anything.there are a few things that you need t...">
		
	

		
			<meta name="identifier-url" content="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/">
		
		
			<meta property="og:url" content="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/">
		
		
	

		
		
		
		<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/index_002.js"></script>
	
	<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/index.js" charset="UTF-8"></script>


	
		
			
			
			
			
				<link id="ipsCanonical" rel="canonical" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/">
			
		

			
			
			
			
				<link rel="stylesheet" type="text/css" title="Main" media="print" href="Event%20System%202.3%20into%202.0.php_files/ipb_print.css">
			
		

			
			
			
			
				<link rel="next" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20">
			
		

			
			
			
			
				<link rel="last" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20">
			
		

			
			
			
			
				<link rel="up" href="http://www.touchofdeathforums.com/community/index.php?/forum/76-source/">
			
		

			
			
			
			
				<link rel="author" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/">
			
		
	

		
			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4-gallery/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3-wiki/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Articles" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c1-articles/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Pages" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c4-pages/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Miscellaneous" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c5-miscellaneous/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Forum Integration" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c2-forum-integration/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Frontpage" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c3-frontpage/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Databases" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c6-databases/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Templates" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c7-templates/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Articles: Media" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c8-media/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Sprites" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c26-sprites/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Tiles" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c30-tiles/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: GUI" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c31-gui/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Music" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c32-music/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Items" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c33-items/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Spells" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c34-spells/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Other" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c35-other/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Gallery: Tools" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c36-tools/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Media Demo: Sprites" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c10-sprites/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Media Demo: Tiles" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c27-tiles/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Media Demo: GUI" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c28-gui/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Media Demo: Music" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c29-music/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Eclipse Nightly" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c15-eclipse-nightly/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Event System" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c13-event-system/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Eclipse Origins" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c16-eclipse-origins/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Visual Basic 6" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c17-visual-basic-6/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: C++" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c23-c/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Eclipse.net" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c37-eclipsenet/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Website" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c40-website/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c19-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Source Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c20-source-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c21-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Source Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c22-source-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Source Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c18-source-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c24-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Codebase" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c25-codebase/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c38-tutorials/">
			
			
			
		

			
			
				<link rel="alternate" type="application/rss+xml" title="Wiki: Source Tutorials" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c39-source-tutorials/">
			
			
			
		
	

	



		
		<script type="text/javascript">
	//<![CDATA[
		/* ---- URLs ---- */
		ipb.vars['base_url'] 			= 'http://www.touchofdeathforums.com/community/index.php?s=cf687af71e8c6be1c9bee8f201530bfb&';
		ipb.vars['board_url']			= 'http://www.touchofdeathforums.com/community';
		ipb.vars['img_url'] 			= "http://www.touchofdeathforums.com/community/public/style_images/eclipse31";
		ipb.vars['loading_img'] 		= 'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/loading.gif';
		ipb.vars['active_app']			= 'forums';
		ipb.vars['upload_url']			= 'http://www.touchofdeathforums.com/community/uploads';
		/* ---- Member ---- */
		ipb.vars['member_id']			= parseInt( 56158 );
		ipb.vars['is_supmod']			= parseInt( 0 );
		ipb.vars['is_admin']			= parseInt( 0 );
		ipb.vars['secure_hash'] 		= 'bebd230150525e2b52ebad4aacd61915';
		ipb.vars['session_id']			= 'cf687af71e8c6be1c9bee8f201530bfb';
		ipb.vars['twitter_id']			= 0;
		ipb.vars['fb_uid']				= 0;
		ipb.vars['auto_dst']			= parseInt( 1 );
		ipb.vars['dst_in_use']			= parseInt( 0 );
		ipb.vars['is_touch']			= false;
		ipb.vars['member_group']		= {"g_mem_info":"1"}
		/* ---- cookies ----- */
		ipb.vars['cookie_id'] 			= '';
		ipb.vars['cookie_domain'] 		= '';
		ipb.vars['cookie_path']			= '/';
		/* ---- Rate imgs ---- */
		ipb.vars['rate_img_on']			= 'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/star.png';
		ipb.vars['rate_img_off']		= 'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/star_off.png';
		ipb.vars['rate_img_rated']		= 'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/star_rated.png';
		/* ---- Uploads ---- */
		ipb.vars['swfupload_swf']		= 'http://www.touchofdeathforums.com/community/public/js/3rd_party/swfupload/swfupload.swf';
		ipb.vars['swfupload_enabled']	= true;
		ipb.vars['use_swf_upload']		= ( 'default' == 'flash' ) ? true : false;
		ipb.vars['swfupload_debug']		= false;
		/* ---- other ---- */
		ipb.vars['highlight_color']     = "#ade57a";
		ipb.vars['charset']				= "UTF-8";
		ipb.vars['seo_enabled']			= 1;
		
		ipb.vars['seo_params']			= {"start":"-","end":"\/","varBlock":"\/page__","varSep":"__"};
		
		/* Templates/Language */
		ipb.templates['inlineMsg']		= "";
		ipb.templates['ajax_loading'] 	= "<div id='ajax_loading'><img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/ajax_loading.gif' alt='" + ipb.lang['loading'] + "' /></div>";
		ipb.templates['close_popup']	= "<img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/close_popup.png' alt='x' />";
		ipb.templates['rss_shell']		= new Template("<ul id='rss_menu' class='ipbmenu_content'>#{items}</ul>");
		ipb.templates['rss_item']		= new Template("<li><a href='#{url}' title='#{title}'>#{title}</a></li>");
		
			ipb.templates['m_add_friend']	= new Template("<a href='http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=profile&amp;section=friends&amp;do=add&amp;member_id=#{id}' title='Add as Friend' class='ipsButton_secondary'><img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/user_add.png' alt='Add as Friend' /></a>");
			ipb.templates['m_rem_friend']	= new Template("<a href='http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=profile&amp;section=friends&amp;do=remove&amp;member_id=#{id}' title='Remove Friend' class='ipsButton_secondary'><img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/user_delete.png' alt='Remove Friend' /></a>");
		
		ipb.templates['autocomplete_wrap'] = new Template("<ul id='#{id}' class='ipb_autocomplete' style='width: 250px;'></ul>");
		ipb.templates['autocomplete_item'] = new Template("<li id='#{id}' data-url='#{url}'><img src='#{img}' alt='' class='ipsUserPhoto ipsUserPhoto_mini' />&nbsp;&nbsp;#{itemvalue}</li>");
		ipb.templates['page_jump']		= new Template("<div id='#{id}_wrap' class='ipbmenu_content'><h3 class='bar'>Jump to page</h3><p class='ipsPad'><input type='text' class='input_text' id='#{id}_input' size='8' /> <input type='submit' value='Go' class='input_submit add_folder' id='#{id}_submit' /></p></div>");
		ipb.templates['global_notify'] 	= new Template("<div class='popupWrapper'><div class='popupInner'><div class='ipsPad'>#{message} #{close}</div></div></div>");
		
		
		ipb.templates['header_menu'] 	= new Template("<div id='#{id}' class='ipsHeaderMenu boxShadow'></div>");
		
			ipb.global.checkDST();
		
		Loader.boot();
	//]]>
	</script>
	<script src="Event%20System%202.3%20into%202.0.php_files/ips_config.js" type="text/javascript"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}
.fb_invisible{display:none}
.fb_reset{background:none;border-spacing:0;border:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}
.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}
.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px}
.fb_dialog_content{background:#fff;color:#333}
.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px;top:8px\9;right:7px\9}
.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}
.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}
.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}
.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}
.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}
.fb_dialog_top_left,
.fb_dialog_top_right,
.fb_dialog_bottom_left,
.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}
.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}
.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}
.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}
.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}
.fb_dialog_vert_left,
.fb_dialog_vert_right,
.fb_dialog_horiz_top,
.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}
.fb_dialog_vert_left,
.fb_dialog_vert_right{width:10px;height:100%}
.fb_dialog_vert_left{margin-left:-10px}
.fb_dialog_vert_right{right:0;margin-right:-10px}
.fb_dialog_horiz_top,
.fb_dialog_horiz_bottom{width:100%;height:10px}
.fb_dialog_horiz_top{margin-top:-10px}
.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}
.fb_dialog_iframe{line-height:0}
.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}
.fb_dialog_content .dialog_title > span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif)
no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}
body.fb_hidden{-webkit-transform:none;height:100%;margin:0;left:-10000px;overflow:visible;position:absolute;top:-10000px;width:100%
}
.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif)
white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}
.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}
#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}
#fb-root #fb_dialog_ipad_overlay.hidden{display:none}
.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}
.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0 0, 0 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}
.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%
}
.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px
}
.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px
}
.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0 0, 0 100%, from(#4966A6),
color-stop(0.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset,
rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}
.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}
.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}
.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}
.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}
#fb_dialog_loader_close{float:left}
.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}
.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{position:relative;display:-moz-inline-block;display:inline-block}
.fb_iframe_widget iframe{position:absolute}
.fb_iframe_widget_lift{z-index:1}
.fb_iframe_widget span{position:relative;display:inline-block;vertical-align:text-bottom;text-align:justify}
.fb_hide_iframes iframe{position:relative;left:-10000px}
.fb_iframe_widget_loader{position:relative;display:inline-block}
.fb_iframe_widget_fluid{display:inline}
.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}
.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_button_simple,
.fb_button_simple_rtl{background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yH/r/eIpbnVKI9lR.png);background-repeat:no-repeat;cursor:pointer;outline:none;text-decoration:none}
.fb_button_simple_rtl{background-position:right 0}
.fb_button_simple .fb_button_text{margin:0 0 0 20px;padding-bottom:1px}
.fb_button_simple_rtl .fb_button_text{margin:0 10px 0 0}
a.fb_button_simple:hover .fb_button_text,
a.fb_button_simple_rtl:hover .fb_button_text,
.fb_button_simple:hover .fb_button_text,
.fb_button_simple_rtl:hover .fb_button_text{text-decoration:underline}
.fb_button,
.fb_button_rtl{background:#29447e url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/FGFbc80dUKj.png);background-repeat:no-repeat;cursor:pointer;display:inline-block;padding:0 0 0 1px;text-decoration:none;outline:none}
.fb_button .fb_button_text,
.fb_button_rtl .fb_button_text{background:#5f78ab url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/FGFbc80dUKj.png);border-top:solid 1px #879ac0;border-bottom:solid 1px #1a356e;color:#fff;display:block;font-family:"lucida grande",tahoma,verdana,arial,sans-serif;font-weight:bold;padding:2px 6px 3px 6px;margin:1px 1px 0 21px;text-shadow:none}
a.fb_button,
a.fb_button_rtl,
.fb_button,
.fb_button_rtl{text-decoration:none}
a.fb_button:active .fb_button_text,
a.fb_button_rtl:active .fb_button_text,
.fb_button:active .fb_button_text,
.fb_button_rtl:active .fb_button_text{border-bottom:solid 1px #29447e;border-top:solid 1px #45619d;background:#4f6aa3;text-shadow:none}
.fb_button_xlarge,
.fb_button_xlarge_rtl{background-position:left -60px;font-size:24px;line-height:30px}
.fb_button_xlarge .fb_button_text{padding:3px 8px 3px 12px;margin-left:38px}
a.fb_button_xlarge:active{background-position:left -99px}
.fb_button_xlarge_rtl{background-position:right -268px}
.fb_button_xlarge_rtl .fb_button_text{padding:3px 8px 3px 12px;margin-right:39px}
a.fb_button_xlarge_rtl:active{background-position:right -307px}
.fb_button_large,
.fb_button_large_rtl{background-position:left -138px;font-size:13px;line-height:16px}
.fb_button_large .fb_button_text{margin-left:24px;padding:2px 6px 4px 6px}
a.fb_button_large:active{background-position:left -163px}
.fb_button_large_rtl{background-position:right -346px}
.fb_button_large_rtl .fb_button_text{margin-right:25px}
a.fb_button_large_rtl:active{background-position:right -371px}
.fb_button_medium,
.fb_button_medium_rtl{background-position:left -188px;font-size:11px;line-height:14px}
a.fb_button_medium:active{background-position:left -210px}
.fb_button_medium_rtl{background-position:right -396px}
.fb_button_text_rtl,
.fb_button_medium_rtl .fb_button_text{padding:2px 6px 3px 6px;margin-right:22px}
a.fb_button_medium_rtl:active{background-position:right -418px}
.fb_button_small,
.fb_button_small_rtl{background-position:left -232px;font-size:10px;line-height:10px}
.fb_button_small .fb_button_text{padding:2px 6px 3px;margin-left:17px}
a.fb_button_small:active,
.fb_button_small:active{background-position:left -250px}
.fb_button_small_rtl{background-position:right -440px}
.fb_button_small_rtl .fb_button_text{padding:2px 6px;margin-right:18px}
a.fb_button_small_rtl:active{background-position:right -458px}
.fb_share_count_wrapper{position:relative;float:left}
.fb_share_count{background:#b0b9ec none repeat scroll 0 0;color:#333;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;text-align:center}
.fb_share_count_inner{background:#e8ebf2;display:block}
.fb_share_count_right{margin-left:-1px;display:inline-block}
.fb_share_count_right .fb_share_count_inner{border-top:solid 1px #e8ebf2;border-bottom:solid 1px #b0b9ec;margin:1px 1px 0 1px;font-size:10px;line-height:10px;padding:2px 6px 3px;font-weight:bold}
.fb_share_count_top{display:block;letter-spacing:-1px;line-height:34px;margin-bottom:7px;font-size:22px;border:solid 1px #b0b9ec}
.fb_share_count_nub_top{border:none;display:block;position:absolute;left:7px;top:35px;margin:0;padding:0;width:6px;height:7px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yU/r/bSOHtKbCGYI.png)}
.fb_share_count_nub_right{border:none;display:inline-block;padding:0;width:5px;height:10px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yX/r/i_oIVTKMYsL.png);vertical-align:top;background-position:right 5px;z-index:10;left:2px;margin:0 2px 0 0;position:relative}
.fb_share_no_count{display:none}
.fb_share_size_Small .fb_share_count_right .fb_share_count_inner{font-size:10px}
.fb_share_size_Medium .fb_share_count_right .fb_share_count_inner{font-size:11px;padding:2px 6px 3px;letter-spacing:-1px;line-height:14px}
.fb_share_size_Large .fb_share_count_right .fb_share_count_inner{font-size:13px;line-height:16px;padding:2px 6px 4px;font-weight:normal;letter-spacing:-1px}
.fb_share_count_hidden .fb_share_count_nub_top,
.fb_share_count_hidden .fb_share_count_top,
.fb_share_count_hidden .fb_share_count_nub_right,
.fb_share_count_hidden .fb_share_count_right{visibility:hidden}
.fb_connect_bar_container div,
.fb_connect_bar_container span,
.fb_connect_bar_container a,
.fb_connect_bar_container img,
.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}
.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}
.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}
.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size:13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}
.fb_connect_bar a:hover{color:#fff}
.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}
.fb_connect_bar div a,
.fb_connect_bar span,
.fb_connect_bar span a{color:#bac6da;font-size:11px;text-decoration:none}
.fb_connect_bar .fb_buttons{float:right;margin-top:7px}
.fb_edge_widget_with_comment{position:relative;*z-index:1000}
.fb_edge_widget_with_comment span.fb_edge_comment_widget{position:absolute}
.fb_edge_widget_with_comment span.fb_send_button_form_widget{z-index:1}
.fb_edge_widget_with_comment span.fb_send_button_form_widget .FB_Loader{left:0;top:1px;margin-top:6px;margin-left:0;background-position:50% 50%;background-color:#fff;height:150px;width:394px;border:1px #666 solid;border-bottom:2px solid #283e6c;z-index:1}
.fb_edge_widget_with_comment span.fb_send_button_form_widget.dark .FB_Loader{background-color:#000;border-bottom:2px solid #ccc}
.fb_edge_widget_with_comment span.fb_send_button_form_widget.siderender
.FB_Loader{margin-top:0}
.fbpluginrecommendationsbarleft,
.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}
/* @noflip */
.fbpluginrecommendationsbarleft{left:10px}
/* @noflip */
.fbpluginrecommendationsbarright{right:10px}
</style><script src="Event%20System%202.3%20into%202.0.php_files/skin.js" type="text/javascript"></script><link href="Event%20System%202.3%20into%202.0.php_files/editor.css" type="text/css" rel="stylesheet"><script src="Event%20System%202.3%20into%202.0.php_files/ipb.js" type="text/javascript"></script><script src="Event%20System%202.3%20into%202.0.php_files/default.js" type="text/javascript"></script></head>
	<body onpageshow='event.persisted &amp;&amp; (function(){var allInstances = CKEDITOR.instances, editor, doc;for ( var i in allInstances ){	editor = allInstances[ i ];	doc = editor.document;	if ( doc )	{		doc.$.designMode = "off";		doc.$.designMode = "on";	}}})();' id="ipboard_body">

				<div class="main_width">
				</div>
				<script type="text/javascript">
					if( $('primary_nav') ){	ipb.global.activateMainMenu(); }
				</script>
				
		<p id="content_jump" class="hide"><a id="top"></a><a href="#j_content" title="Jump to content" accesskey="m">Jump to content</a></p>
		<div id="ipbwrapper">
			<!-- ::: TOP BAR: Sign in / register or user drop down and notification alerts ::: -->
			<div id="header_bar" class="clearfix">

			</div>
			<!-- ::: BRANDING STRIP: Logo and search box ::: -->
			<div id="branding">
				<div class="main_width">
					
	<div id="shoutbox-tab-count-wrap"><span id="shoutbox-tab-count" class="ipsHasNotifications" style="display: none;">4</span></div>
	<script type="text/javascript">
		document.observe("dom:loaded", function(){
			var _thisHtml	= $('nav_app_shoutbox').innerHTML;
			_thisHtml = _thisHtml.replace( /\<\/a\>/ig, '' ) + $('shoutbox-tab-count-wrap').innerHTML + "</a>";
			$('nav_app_shoutbox').update( _thisHtml );
			$('shoutbox-tab-count-wrap').remove();
			$('shoutbox-tab-count').show();
		});
	</script>

<div class="user_links_header">
					<div id="user_navigation" class="logged_in">
							<ul class="ipsList_inline right main">
								<li><a data-clicklaunch="getInboxList" id="inbox_link" href="http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=messaging" title="Messenger">&nbsp;</a></li>
									<li><a data-clicklaunch="getNotificationsList" id="notify_link" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=usercp&amp;area=notificationlog" title="Notifications">&nbsp;</a></li>
								<li><a class="" id="user_link" href="http://www.touchofdeathforums.com/community/index.php?/user/56158-vakarieser/" title="Your Profile">vakarieser &nbsp;<span id="user_link_dd"></span></a></li>
															
								<li class="mainlink"><a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=login&amp;do=logout&amp;k=bebd230150525e2b52ebad4aacd61915" class="last_top_nav">Sign Out</a></li>								
							</ul>
						</div>
						<!-- ::: USER DROP DOWN MENU ::: -->
						<div id="user_link_menucontent" class="ipsHeaderMenu clearfix boxShadow" style="display: none; position: absolute; z-index: 9999;">
							<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/user/56158-vakarieser/" title="Your Profile" class="ipsUserPhotoLink left">
								<img style="z-index: 10000;" src="Event%20System%202.3%20into%202.0.php_files/dd945e8ab186f3fa04a312fb8ad4b5fa.png" alt="vakarieser's Photo" class="ipsUserPhoto ipsUserPhoto_medium photo">
							</a>
							
							<div style="z-index: 10000;" class="left">
								<form style="z-index: 10000;" id="statusForm" action="http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=profile&amp;section=status&amp;do=new&amp;k=bebd230150525e2b52ebad4aacd61915&amp;id=56158" method="post">
										<input placeholder="What's on your mind?" id="statusUpdateGlobal" name="content" class="input_text" style="width: 97%; z-index: 10000;" type="text"><br style="z-index: 10000;">
										<input style="z-index: 10000;" id="statusSubmitGlobal" class="ipsButton_secondary" value="Update" type="submit">
										
										<br style="z-index: 10000;">
										<hr style="z-index: 10000;">
									</form>
									<ul style="z-index: 10000;" id="links">
										<li style="z-index: 10000;" id="user_profile"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/user/56158-vakarieser/" title="Your Profile">My Profile</a></li>
										<li style="z-index: 10000;" id="user_ucp"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=usercp" title="Edit my settings, such as signature, photo and more...">My Settings</a></li>
										<li style="z-index: 10000;" id="user_content"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=search&amp;do=user_activity&amp;mid=56158" title="My Content">My Content</a></li>
										
											<li style="z-index: 10000;" id="user_likes"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=search&amp;do=followed" title="Content I Follow">Content I Follow</a></li>
										
										
											<li style="z-index: 10000;" id="user_friends"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=profile&amp;section=friends&amp;do=list" title="Manage Friends" class="manage_friends">Manage Friends</a></li>
										
										<li style="z-index: 10000;" id="user_enemies"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=usercp&amp;tab=core&amp;area=ignoredusers" title="Manage Ignore Prefs" class="manage_enemies">Manage Ignore Prefs</a></li>
										
										
											<li style="z-index: 10000;" id="user_pm"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=members&amp;module=messaging">Personal Messenger</a></li>
										
										
										
									</ul>
							</div>
						</div>
</div>
				</div>
				<div class="main_width">
					<div id="logo">
						
							<a href="http://www.touchofdeathforums.com/community" title="Go to community index" rel="home" accesskey="1"><img src="Event%20System%202.3%20into%202.0.php_files/4_logu_03.png" alt="Logo"></a>
						
					</div>
<div class="nav_search_bar">
					
						<div id="search" class="right">
	<form action="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=search&amp;do=search&amp;fromMainBar=1" method="post" id="search-box">
		<fieldset>
			<label for="main_search" class="hide">Search</label>
			<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=search&amp;search_in=forums" title="Advanced Search" accesskey="4" rel="search" id="adv_search" class="right">Advanced</a>
			<span id="search_wrap" class="right">
				<input placeholder="Search..." id="main_search" name="search_term" class="" size="17" tabindex="6" type="text">
				<span class="choice ipbmenu clickable" id="search_options" style="">This topic</span>
				<ul id="search_options_menucontent" class="ipbmenu_content ipsPad" style="display: none; position: absolute; z-index: 9999;">
					<li style="z-index: 10000;" class="title"><strong style="z-index: 10000;">Search section:</strong></li>
					<li style="z-index: 10000;" class="special">
							<label style="z-index: 10000;" for="s_topic" title="This topic">
								
									<input style="z-index: 10000;" name="search_app" value="forums:topic:128599" class="input_radio" id="s_topic" checked="checked" type="radio"> 
								
								<strong style="z-index: 10000;">This topic</strong>
							</label>
						</li>
					
					
					<li style="z-index: 10000;" class="app"><label style="z-index: 10000;" for="s_forums" title="Forums"><input style="z-index: 10000;" name="search_app" class="input_radio" id="s_forums" value="forums" type="radio">Forums</label></li><li style="z-index: 10000;" class="app"><label style="z-index: 10000;" for="s_members" title="Members"><input style="z-index: 10000;" name="search_app" class="input_radio" id="s_members" value="members" type="radio">Members</label></li><li style="z-index: 10000;" class="app"><label style="z-index: 10000;" for="s_core" title="Help Files"><input style="z-index: 10000;" name="search_app" class="input_radio" id="s_core" value="core" type="radio">Help Files</label></li>
						
					

						<li style="z-index: 10000;" class="app"><label style="z-index: 10000;" for="s_ccs" title="Home"><input style="z-index: 10000;" name="search_app" class="input_radio" id="s_ccs" value="ccs" type="radio">Home</label></li>
					

						
					

						
					

						
					

						<li style="z-index: 10000;" class="app"><label style="z-index: 10000;" for="s_tracker" title="Bug Tracker"><input style="z-index: 10000;" name="search_app" class="input_radio" id="s_tracker" value="tracker" type="radio">Bug Tracker</label></li>
					

						
					

						
					

						
					
				</ul>
				<input class="submit_input clickable" value="" type="submit">
			</span>
			
		</fieldset>
	</form>
</div>
					

<div class="navigation">



					<ul class="nav_inline" id="community_app_menu">
						
								
		
			
				
										
				
			
			
		

			
				
										
				
			
			<li id="nav_app_ccs" class="left "><a href="http://www.touchofdeathforums.com/community/index.php?/page/index.html/index.html" title="Go to Home">Home</a></li>
		

			
				
										
				
			
			<li id="nav_app_forums" class="left active"><a href="http://www.touchofdeathforums.com/community/" title="Go to Forums">Forums</a></li>
		

			
				
										
				
			
			<li id="nav_app_members" class="left "><a href="http://www.touchofdeathforums.com/community/index.php?/members/" title="Go to Members">Members</a></li>
		

			
				
										
				
			
			
		

			
				
										
				
			
			
		

			
				
										
				
			
			
		

			
				
										
				
			
			
		

			
				
										
				
			
			
		
	
	
		
						<li id="nav_menu_2" class="left  ">
					<a id="nav_menu_2_trigger" href="http://www.touchofdeathforums.com/community/index.php?/page/index.html/tinychat.html" title="">Tinychat </a>
					
					
				</li>
		
	
						
						
							<li class="right">
								<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=navigation&amp;inapp=forums" rel="quickNavigation" accesskey="9" id="quickNavLaunch" title="Open Quick Navigation"><span> </span></a>
							</li>
						
<li id="nav_explore" class="right">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=search&amp;do=viewNewContent&amp;search_app=forums" accesskey="2">View New Content</a>
						</li>
						
						<li id="nav_other_apps" style="display: none">
							<a href="#" class="ipbmenu" id="more_apps">More <img src="Event%20System%202.3%20into%202.0.php_files/useropts_arrow.png"></a>
						</li>
					</ul>



</div>
</div>
				</div>
			</div>

			<!-- ::: APPLICATION TABS ::: -->
<!--			-->
			<!-- ::: MAIN CONTENT AREA ::: -->
			<div id="content" class="clearfix">
<div class="announcement_notice">
<div class="announcement_notice-p">

<strong>Eclipse Design &amp; Code Contest!</strong><br><br>
Are you bored? Sitting on a chair, staring at your screen? Or are you 
sitting on the toilet, doing absolutely nothing? Well, this ends now! 
Test your luck in contest with numerous prizes, as a reward! <br><br>

Visit this <a href="http://www.touchofdeathforums.com/community/index.php?/topic/128967-contest-eclipse-design-code/#entry847041">link</a> to see what the contest is about and what you can win!

</div>
</div><br>		<!-- ::: NAVIGATION BREADCRUMBS ::: -->
				<div id="secondary_navigation" class="clearfix">
						<ol class="breadcrumb top ipsList_inline left">
														<li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
									<a href="http://www.touchofdeathforums.com/community/" itemprop="url">
										<span itemprop="title">Eclipse Community</span>
									</a>
								</li>
								
							
								<li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class="nav_sep">→</span>
									 <a href="http://www.touchofdeathforums.com/community/index.php?/forum/6-development/" title="Return to Development" itemprop="url"><span itemprop="title">Development</span></a>
								</li>
								
							

								<li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class="nav_sep">→</span>
									 <a href="http://www.touchofdeathforums.com/community/index.php?/forum/17-tutorials/" title="Return to Tutorials" itemprop="url"><span itemprop="title">Tutorials</span></a>
								</li>
								
							

								<li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
									<span class="nav_sep">→</span>
									 <a href="http://www.touchofdeathforums.com/community/index.php?/forum/76-source/" title="Return to Source" itemprop="url"><span itemprop="title">Source</span></a>
								</li>
								
							
						</ol>
					</div>
				<noscript>
					<div class='message error'>
						<strong>Javascript Disabled Detected</strong>
						<p>You currently have javascript disabled. Several functions may not work. Please re-enable javascript to access full functionality.</p>
					</div>
					<br />
				</noscript>
				<!-- ::: CONTENT ::: -->
				
				

<script type="text/javascript">
//<![CDATA[
	ipb.topic.inSection = 'topicview';
	ipb.topic.topic_id  = 128599;
	ipb.topic.forum_id  = 76;
	ipb.topic.start_id  = 0;
	ipb.topic.topPid    = 0;
	ipb.topic.counts    = { postTotal: 23,
							curStart:  ipb.topic.start_id,
							perPage:   20 };
	//Search Setup
	ipb.vars['search_type']			= 'forum';
	ipb.vars['search_type_id']		= 76;
	ipb.vars['search_type_2']		= 'topic';
	ipb.vars['search_type_id_2']	= 128599;
	
	
	// Delete stuff set up
	ipb.topic.deleteUrls['hardDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=04&f=76&t=128599&st=&auth_key=bebd230150525e2b52ebad4aacd61915&p=#{pid}" );
	ipb.topic.deleteUrls['softDelete'] = new Template( ipb.vars['base_url'] + "app=forums&module=moderate&section=moderate&do=postchoice&tact=sdelete&t=128599&f=76&auth_key=bebd230150525e2b52ebad4aacd61915&selectedpids[#{pid}]=#{pid}&pid=#{pid}" );
	
	
	ipb.templates['post_moderation'] = new Template("<div id='comment_moderate_box' class='ipsFloatingAction' style='display: none'><span class='desc'>With <span id='comment_count'>#{count}</span> checked posts: </span><select id='tactInPopup' class='input_select'><option value='approve'>Approve</option><option value='delete'>Hide</option><option value='sundelete'>Unhide</option><option value='deletedo'>Delete</option><option value='merge'>Merge</option><option value='split'>Split</option><option value='move'>Move</option></select>&nbsp;&nbsp;<input type='button' class='input_submit' id='submitModAction' value='Go' /></div>");
	
//]]>
</script>




<div class="__like right" data-app="forums" data-area="topics" data-relid="128599" data-isfave="">
	<span class="ipsButton_extra right " title="0 member(s) follow this topic" data-tooltip="0 member(s) follow this topic"><img src="Event%20System%202.3%20into%202.0.php_files/icon_users.png"> <strong>0</strong></span>
<a href="#" title="Follow this topic and receive notifications on updates" class="ftoggle ipsButton_secondary">Follow this topic</a>
</div>
<script type="text/javascript">
	var FAVE_TEMPLATE = new Template( "<h3>Unfollow this topic</h3><div class='ipsPad'><span class='desc'>If you unfollow this topic you will no longer receive any notifications</span><br /><p class='ipsForm_center'><input type='button' value='Unfollow this topic' class='input_submit _funset' /></p></div>");
</script>

<a href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" class="ipsUserPhotoLink">

	<img src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_medium left">

</a>

<div itemscope="" itemtype="http://schema.org/Article" class="ipsBox_withphoto">
	
	<h1 itemprop="name" class="ipsType_pagetitle">Adding Event System 2.3 into 2.0</h1>
	<div class="desc lighter blend_links">
		 Started by <span itemprop="creator"><a id="anonymous_element_3" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>, <span itemprop="dateCreated">Aug 08 2012 06:15 PM</span>
	</div>
	
	<meta itemprop="interactionCount" content="UserComments:23">
</div>


<br>
<div class="topic_controls">
	<div class="pagination clearfix left ">
		<ul class="ipsList_inline back left">
			
			
		</ul>
		<ul class="ipsList_inline left pages">
			<li id="anonymous_element_1" class="pagejump clickable pj0737678001">
					<a href="#">Page 1 of 2 <!--<img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/dropdown.png' alt='+' />--></a>
					<script type="text/javascript">
						ipb.global.registerPageJump( '0737678001', { url: "http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/", stKey: 'st', perPage: 20, totalPages: 2, anchor: '' } );
					</script>
				</li>
			
				
					
						<li class="page active">1</li>
					
				

					<li class="page"><a href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20" title="Adding Event System 2.3 into 2.0 - Page 2">2</a></li>
				
			
		</ul>
		<ul class="ipsList_inline forward left">
			
				<li class="next"><a href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20" title="Adding Event System 2.3 into 2.0 - Next page" rel="next">Next</a></li>
			
			
		</ul>
	</div>
	<ul class="topic_buttons">
			
						<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599" title="Reply to this topic" accesskey="r">Reply to this topic</a></li>
					
			
			
		</ul>
</div>

<div class="maintitle clear clearfix">
	<span class="ipsType_small">
		22 replies to this topic
	</span>
		
</div>

<div class="topic hfeed clear clearfix">
	
	

	<div class="ipsBox">
		<div class="ipsBox_container" id="ips_Posts">
			
				<!--post:842326-->

<div class="post_block hentry clear clearfix " id="post_id_842326">
		<a id="entry842326"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842326" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #1">
					
					#1
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_4" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:15:00+00:00">08 August 2012 - 06:15 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->first off, all credit goes to <strong class="bbc">Jcsnider</strong> all i did was rip it into my own project. and make the tut.<br><br>sorry for the multi posts. but i typed it 2x and both times it cut me off. on the 3rd try i wanted to be sure it would work.<br><br>this
 may contain errors in the begining as its alot and i may have missed 
something.&nbsp; just post here or pm me and ill try to figure out whats
 missing if anything.<br><br>there are a few things that you need to be aware of before you begin.&nbsp; <br>1.this is from the 2.3 download avalible on this website.<br>2.this is the dx7 version.<br>3.this will only compile in p-code (for now)<br>4.for extra files needed please download the new 2.3 version of eclipse and take needed the files from it.<br><br><br><strong class="bbc"><span style="font-size: px;">server side</span>.</strong><br><br><br>in mod database find <strong class="bbc">Sub SaveMap(ByVal mapnum As Long)</strong><br>then add this at the top <br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> p </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre>then below <br><pre class="prettyprint"><span class="typ">Close</span><span class="pln"> </span><span class="com">#F </span></pre> <br>add<br><pre class="prettyprint"><span class="str">'This is for event saving, it is in .ini files becuase there are non-limited values (strings) that cannot easily be loaded/saved in the normal manner.<br>&nbsp; &nbsp; filename = App.Path &amp; "\data\maps\map" &amp; mapnum &amp; "_eventdata.dat"<br>&nbsp; &nbsp; PutVar filename, "Events", "EventCount", Val(Map(mapnum).EventCount)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If Map(mapnum).EventCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To Map(mapnum).EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i, "Name", .Name<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i, "Global", Val(.Global)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i, "x", Val(.x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i, "y", Val(.y)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i, "PageCount", Val(.PageCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).PageCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For x = 1 To Map(mapnum).Events(i).PageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i).Pages(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "chkVariable", Val(.chkVariable)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "VariableIndex", Val(.VariableIndex)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "VariableCondition", Val(.VariableCondition)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "VariableCompare", Val(.VariableCompare)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "chkSwitch", Val(.chkSwitch)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "SwitchIndex", Val(.SwitchIndex)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "SwitchCompare", Val(.SwitchCompare)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "chkHasItem", Val(.chkHasItem)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "HasItemIndex", Val(.HasItemIndex)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "chkSelfSwitch", Val(.chkSelfSwitch)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "SelfSwitchIndex", Val(.SelfSwitchIndex)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "SelfSwitchCompare", Val(.SelfSwitchCompare)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "GraphicType", Val(.GraphicType)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "Graphic", Val(.Graphic)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "GraphicX", Val(.GraphicX)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "GraphicY", Val(.GraphicY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "GraphicX2", Val(.GraphicX2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "GraphicY2", Val(.GraphicY2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveType", Val(.MoveType)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveSpeed", Val(.MoveSpeed)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveFreq", Val(.MoveFreq)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "IgnoreMoveRoute", Val(.IgnoreMoveRoute)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "RepeatMoveRoute", Val(.RepeatMoveRoute)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRouteCount", Val(.MoveRouteCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Index", Val(.MoveRoute(y).index)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data1", Val(.MoveRoute(y).Data1)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data2", Val(.MoveRoute(y).Data2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data3", Val(.MoveRoute(y).Data3)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data4", Val(.MoveRoute(y).data4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data5", Val(.MoveRoute(y).data5)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "MoveRoute" &amp; y &amp; "Data6", Val(.MoveRoute(y).data6)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "WalkAnim", Val(.WalkAnim)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "DirFix", Val(.DirFix)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "WalkThrough", Val(.WalkThrough)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "ShowName", Val(.ShowName)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "Trigger", Val(.Trigger)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandListCount", Val(.CommandListCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "Position", Val(.Position)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(x).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To Map(mapnum).Events(i).Pages(x).CommandListCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "CommandCount", Val(Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "ParentList", Val(Map(mapnum).Events(i).Pages(x).CommandList(y).ParentList)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i).Pages(x).CommandList(y).Commands(z)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Index", Val(.index)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Text1", .Text1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Text2", .Text2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Text3", .Text3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Text4", .Text4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Text5", .Text5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data1", Val(.Data1)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data2", Val(.Data2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data3", Val(.Data3)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data4", Val(.data4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data5", Val(.data5)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "Data6", Val(.data6)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchCommandList", Val(.ConditionalBranch.CommandList)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchCondition", Val(.ConditionalBranch.Condition)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchData1", Val(.ConditionalBranch.Data1)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchData2", Val(.ConditionalBranch.Data2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchData3", Val(.ConditionalBranch.Data3)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "ConditionalBranchElseCommandList", Val(.ConditionalBranch.ElseCommandList)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRouteCount", Val(.MoveRouteCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For w = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Index", Val(.MoveRoute(w).index)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data1", Val(.MoveRoute(w).Data1)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data2", Val(.MoveRoute(w).Data2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data3", Val(.MoveRoute(w).Data3)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data4", Val(.MoveRoute(w).data4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data5", Val(.MoveRoute(w).data5)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PutVar filename, "Event" &amp; i &amp; "Page" &amp; x, "CommandList" &amp; y &amp; "Command" &amp; z &amp; "MoveRoute" &amp; w &amp; "Data6", Val(.MoveRoute(w).data6)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If</span></pre><br>in moddatabase find <strong class="bbc">Sub LoadMaps()</strong><br>add this at the top of the sub<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> p </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre>then below this <br>&nbsp; &nbsp; &nbsp; &nbsp; <pre class="prettyprint"><span class="typ">ClearTempTile</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CacheResources</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">DoEvents</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre>&nbsp; <br>add<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAPS<br>&nbsp; &nbsp; &nbsp; &nbsp; filename </span><span class="pun">=</span><span class="pln"> </span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data\maps\map"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> z </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"_eventdata.dat"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Events"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"EventCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Name</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Name"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Global</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Global"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">"x"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">"y"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">PageCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> </span><span class="str">"PageCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkVariable </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"chkVariable"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"VariableIndex"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableCondition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"VariableCondition"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"VariableCompare"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"chkSwitch"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SwitchIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SwitchIndex"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SwitchCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SwitchCompare"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkHasItem </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"chkHasItem"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">HasItemIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"HasItemIndex"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkSelfSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"chkSelfSwitch"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SelfSwitchIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SelfSwitchIndex"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SelfSwitchCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"SelfSwitchCompare"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"GraphicType"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Graphic</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Graphic"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicX</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"GraphicX"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicY</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"GraphicY"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicX2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"GraphicX2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicY2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"GraphicY2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveType"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveSpeed"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveFreq"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">IgnoreMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"IgnoreMoveRoute"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"RepeatMoveRoute"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRouteCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="pln">index </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Index"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data1"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data3"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="pln">data4 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data4"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="pln">data5 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data5"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="pln">data6 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data6"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">WalkAnim</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"WalkAnim"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">DirFix</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"DirFix"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"WalkThrough"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ShowName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ShowName"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Trigger</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Trigger"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandListCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Position</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Position"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"CommandCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ParentList"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">index </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Index"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Text1"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Text2"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Text3"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Text4"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Text5"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data1"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data3"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">data4 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data4"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">data5 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data5"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">data6 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data6"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchCommandList"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchCondition"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchData1"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchData2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchData3"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">ElseCommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"ConditionalBranchElseCommandList"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRouteCount"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="pln">index </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Index"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data1"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data2"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data3"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="pln">data4 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data4"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="pln">data5 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data5"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="pln">data6 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Event"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Page"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CommandList"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Command"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"MoveRoute"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> w </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Data6"</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842326">
				<ul class="ipsList_inline">
					<li id="like_post_842326" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842326&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842326" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842326&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842326" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842326', { domLikeStripId: 'like_post_842326', app: 'forums', type: 'pid', typeid: '842326' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842326" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842326" class="_ips_trigger_quote ipsButton_secondary" pid="842326" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842326" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842326" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842326&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842326);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842326') )
	{
		$('multiq_842326').show();
	}
	
	if( $('toggle_post_842326') )
	{
		$('toggle_post_842326').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842326] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842331-->

<div class="post_block hentry clear clearfix " id="post_id_842331">
		<a id="entry842331"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842331" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #2">
					
					#2
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_5" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:36:01+00:00">08 August 2012 - 06:36 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->at the bottom of moddatabase add<br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SaveSwitches</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> filename </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>filename </span><span class="pun">=</span><span class="pln"> </span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data\switches.ini"</span><span class="pln"><br><br></span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES<br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">PutVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Switches"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Switch"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">CStr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Name"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">i</span><span class="pun">))</span><span class="pln"><br></span><span class="typ">Next</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SaveVariables</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> filename </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>filename </span><span class="pun">=</span><span class="pln"> </span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data\variables.ini"</span><span class="pln"><br><br></span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES<br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">PutVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Variables"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Variable"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">CStr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Name"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">i</span><span class="pun">))</span><span class="pln"><br></span><span class="typ">Next</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">LoadSwitches</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> filename </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>filename </span><span class="pun">=</span><span class="pln"> </span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data\switches.ini"</span><span class="pln"><br><br></span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES<br>&nbsp; &nbsp; </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Switches"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Switch"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">CStr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Name"</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Next</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">LoadVariables</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> filename </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>filename </span><span class="pun">=</span><span class="pln"> </span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data\variables.ini"</span><span class="pln"><br><br></span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES<br>&nbsp; &nbsp; </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetVar</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Variables"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Variable"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">CStr</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Name"</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Next</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in modgamelogic find <strong class="bbc">Public Sub SpawnNpc(ByVal mapNpcNum As Long, ByVal mapnum As Long)</strong><br>below that sub add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SpawnMapEventsFor</span><span class="pun">(</span><span class="pln">index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> spawncurrentevent </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln"> p </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> buffer </span><span class="typ">As</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Step</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="pln">chkVariable </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">Variables</span><span class="pun">(.</span><span class="typ">VariableIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">.</span><span class="typ">VariableCondition</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="pln">chkSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">Switches</span><span class="pun">(.</span><span class="typ">SwitchIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="pln">chkHasItem </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">HasItem</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="pun">.</span><span class="typ">HasItemIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="pln">chkSelfSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">SelfSwitches</span><span class="pun">(.</span><span class="typ">SelfSwitchIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spawncurrentevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">'spawn the event... send data to player<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventMap.CurrentEvents = TempPlayer(index).EventMap.CurrentEvents + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve TempPlayer(index).EventMap.EventPages(TempPlayer(index).EventMap.CurrentEvents)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With TempPlayer(index).EventMap.EventPages(TempPlayer(index).EventMap.CurrentEvents)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(z).GraphicType = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Select Case Map(mapnum).Events(i).Pages(z).GraphicY<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicNum = Map(mapnum).Events(i).Pages(z).Graphic<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicType = Map(mapnum).Events(i).Pages(z).GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicX = Map(mapnum).Events(i).Pages(z).GraphicX<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicY = Map(mapnum).Events(i).Pages(z).GraphicY<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicX2 = Map(mapnum).Events(i).Pages(z).GraphicX2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicY2 = Map(mapnum).Events(i).Pages(z).GraphicY2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Select Case Map(mapnum).Events(i).Pages(z).MoveSpeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 12<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .movementspeed = 24<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Global Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .x = TempEventMap(mapnum).Events(i).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .y = TempEventMap(mapnum).Events(i).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Dir = TempEventMap(mapnum).Events(i).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRouteStep = TempEventMap(mapnum).Events(i).MoveRouteStep<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .x = Map(mapnum).Events(i).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .y = Map(mapnum).Events(i).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRouteStep = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Position = Map(mapnum).Events(i).Pages(z).Position<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .eventID = i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .pageID = z<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If spawncurrentevent = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Visible = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Visible = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveType = Map(mapnum).Events(i).Pages(z).MoveType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveType = 2 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRouteCount = Map(mapnum).Events(i).Pages(z).MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim .MoveRoute(0 To Map(mapnum).Events(i).Pages(z).MoveRouteCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(z).MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For p = 0 To Map(mapnum).Events(i).Pages(z).MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(p) = Map(mapnum).Events(i).Pages(z).MoveRoute(p)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .RepeatMoveRoute = Map(mapnum).Events(i).Pages(z).RepeatMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .IgnoreIfCannotMove = Map(mapnum).Events(i).Pages(z).IgnoreMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveFreq = Map(mapnum).Events(i).Pages(z).MoveFreq<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveSpeed = Map(mapnum).Events(i).Pages(z).MoveSpeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .WalkingAnim = Map(mapnum).Events(i).Pages(z).WalkAnim<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .WalkThrough = Map(mapnum).Events(i).Pages(z).WalkThrough<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .FixedDir = Map(mapnum).Events(i).Pages(z).DirFix<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoTo nextevent<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>nextevent:<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If TempPlayer(index).EventMap.CurrentEvents &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To TempPlayer(index).EventMap.CurrentEvents<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SSpawnEvent<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With TempPlayer(index).EventMap.EventPages(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteString Map(GetPlayerMap(index)).Events(i).Name<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicNum<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicX<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicX2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicY<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .GraphicY2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .Position<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong .Visible<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Map(mapnum).Events(.eventID).Pages(.pageID).WalkAnim<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Map(mapnum).Events(.eventID).Pages(.pageID).DirFix<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Map(mapnum).Events(.eventID).Pages(.pageID).WalkThrough<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Map(mapnum).Events(.eventID).Pages(.pageID).ShowName<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>End Sub</span></pre><br>find in modgamelogic <strong class="bbc">Sub SpawnAllMapNpcs()</strong><br>below this function add<br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SpawnAllMapGlobalEvents</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAPS<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SpawnGlobalEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SpawnGlobalEvents</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">PageCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Global</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">GraphicType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">GraphicY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="pln">active </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveType</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">z</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">z</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">RepeatMoveRoute</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">IgnoreIfCannotMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">IgnoreMoveRoute</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveFreq</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">MoveSpeed</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">WalkThrough</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">FixedDir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">DirFix</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pun">).</span><span class="typ">WalkingAnim</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">WalkAnim</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in <strong class="bbc">modplayer</strong> add<br><pre class="prettyprint"><span class="typ">Function</span><span class="pln"> </span><span class="typ">FindItem</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> itemnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' Check for subscript out of range<br>&nbsp; &nbsp; If IsPlaying(index) = False Or itemnum &lt;= 0 Or itemnum &gt; MAX_ITEMS Then<br>&nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; For i = 1 To MAX_INV<br><br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to see </span><span class="kwd">if</span><span class="pln"> the player has the item<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">GetPlayerInvItemNum</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> itemnum </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">FindItem</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842331">
				<ul class="ipsList_inline">
					<li id="like_post_842331" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842331&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842331" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842331&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842331" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842331', { domLikeStripId: 'like_post_842331', app: 'forums', type: 'pid', typeid: '842331' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842331" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842331" class="_ips_trigger_quote ipsButton_secondary" pid="842331" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842331" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842331" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842331&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842331);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842331') )
	{
		$('multiq_842331').show();
	}
	
	if( $('toggle_post_842331') )
	{
		$('toggle_post_842331').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842331] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842335-->

<div class="post_block hentry clear clearfix " id="post_id_842335">
		<a id="entry842335"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842335" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #3">
					
					#3
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_6" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:45:51+00:00">08 August 2012 - 06:45 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->at the bottom of <strong class="bbc">modgamelogic</strong> add<br><pre class="prettyprint"><span class="typ">Function</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Optional</span><span class="pln"> globalevent </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> n </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' Check for subscript out of range<br>&nbsp; &nbsp; If mapnum &lt;= 0 Or mapnum &gt; MAX_MAPS Or Dir &lt; DIR_UP Or Dir &gt; DIR_RIGHT Then<br>&nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; CanEventMove = True<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br><br>&nbsp; &nbsp; Select Case Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure </span><span class="kwd">not</span><span class="pln"> outside of boundries<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Tile</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="typ">Type</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that the tile is walkable<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If n &lt;&gt; TILE_TYPE_WALKABLE And n &lt;&gt; TILE_TYPE_ITEM And n &lt;&gt; TILE_TYPE_NPCSPAWN Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that there </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> a player </span><span class="kwd">in</span><span class="pln"> the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">IsPlaying</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mapnum</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that there is not another npc in the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To MAX_MAP_NPCS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (MapNpc(mapnum).Npc(i).x = x) And (MapNpc(mapnum).Npc(i).y = y - 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If TempEventMap(mapnum).EventCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To TempEventMap(mapnum).EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (z &lt;&gt; eventID) And (z &gt; 0) And (TempEventMap(mapnum).Events(z).x = x) And (TempEventMap(mapnum).Events(z).y = y - 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If TempPlayer(index).EventMap.CurrentEvents &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To TempPlayer(index).EventMap.CurrentEvents<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (TempPlayer(index).EventMap.EventPages(z).eventID &lt;&gt; eventID) And (eventID &gt; 0) And (TempPlayer(index).EventMap.EventPages(z).x = TempPlayer(index).EventMap.EventPages(eventID).x) And (TempPlayer(index).EventMap.EventPages(z).y = TempPlayer(index).EventMap.EventPages(eventID).y - 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Directional</span><span class="pln"> blocking<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> isDirBlocked</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Tile</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">).</span><span class="typ">DirBlock</span><span class="pun">,</span><span class="pln"> DIR_UP </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_DOWN<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure not outside of boundries<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y &lt; Map(mapnum).MaxY Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n = Map(mapnum).Tile(x, y + 1).Type<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If WalkThrough = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that the tile </span><span class="kwd">is</span><span class="pln"> walkable<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_WALKABLE </span><span class="typ">And</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_ITEM </span><span class="typ">And</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_NPCSPAWN </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that there is not a player in the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To Player_HighIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If IsPlaying(i) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (GetPlayerMap(i) = mapnum) And (GetPlayerX(i) = x) And (GetPlayerY(i) = y + 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that there </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> another npc </span><span class="kwd">in</span><span class="pln"> the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAP_NPCS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Npc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Npc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> globalevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z </span><span class="pun">&lt;&gt;</span><span class="pln"> eventID</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">eventID </span><span class="pun">&lt;&gt;</span><span class="pln"> eventID</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="pln">eventID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Directional blocking<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If isDirBlocked(Map(mapnum).Tile(x, y).DirBlock, DIR_DOWN + 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure </span><span class="kwd">not</span><span class="pln"> outside of boundries<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Tile</span><span class="pun">(</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">).</span><span class="typ">Type</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that the tile is walkable<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If n &lt;&gt; TILE_TYPE_WALKABLE And n &lt;&gt; TILE_TYPE_ITEM And n &lt;&gt; TILE_TYPE_NPCSPAWN Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that there </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> a player </span><span class="kwd">in</span><span class="pln"> the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">IsPlaying</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mapnum</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that there is not another npc in the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To MAX_MAP_NPCS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (MapNpc(mapnum).Npc(i).x = x - 1) And (MapNpc(mapnum).Npc(i).y = y) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If TempEventMap(mapnum).EventCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To TempEventMap(mapnum).EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (z &lt;&gt; eventID) And (z &gt; 0) And (TempEventMap(mapnum).Events(z).x = x - 1) And (TempEventMap(mapnum).Events(z).y = y) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If TempPlayer(index).EventMap.CurrentEvents &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To TempPlayer(index).EventMap.CurrentEvents<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (TempPlayer(index).EventMap.EventPages(z).eventID &lt;&gt; eventID) And (eventID &gt; 0) And (TempPlayer(index).EventMap.EventPages(z).x = TempPlayer(index).EventMap.EventPages(eventID).x - 1) And (TempPlayer(index).EventMap.EventPages(z).y = TempPlayer(index).EventMap.EventPages(eventID).y) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Directional</span><span class="pln"> blocking<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> isDirBlocked</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Tile</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">).</span><span class="typ">DirBlock</span><span class="pun">,</span><span class="pln"> DIR_LEFT </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_RIGHT<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure not outside of boundries<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x &lt; Map(mapnum).MaxX Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; n = Map(mapnum).Tile(x + 1, y).Type<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If WalkThrough = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that the tile </span><span class="kwd">is</span><span class="pln"> walkable<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_WALKABLE </span><span class="typ">And</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_ITEM </span><span class="typ">And</span><span class="pln"> n </span><span class="pun">&lt;&gt;</span><span class="pln"> TILE_TYPE_NPCSPAWN </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check to make sure that there is not a player in the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To Player_HighIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If IsPlaying(i) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (GetPlayerMap(i) = mapnum) And (GetPlayerX(i) = x + 1) And (GetPlayerY(i) = y) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> to make sure that there </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> another npc </span><span class="kwd">in</span><span class="pln"> the way<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAP_NPCS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Npc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Npc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> globalevent </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z </span><span class="pun">&lt;&gt;</span><span class="pln"> eventID</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="pln">z </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">eventID </span><span class="pun">&lt;&gt;</span><span class="pln"> eventID</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="pln">eventID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">z</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Directional blocking<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If isDirBlocked(Map(mapnum).Tile(x, y).DirBlock, DIR_RIGHT + 1) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMove = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; End Select<br><br>End Function<br><br>Sub EventDir(playerindex As Long, ByVal mapnum As Long, ByVal eventID As Long, ByVal Dir As Long, Optional globalevent As Boolean = False)<br>&nbsp; &nbsp; Dim buffer As clsBuffer<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> subscript </span><span class="kwd">out</span><span class="pln"> of range<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> mapnum </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> mapnum </span><span class="pun">&gt;</span><span class="pln"> MAX_MAPS </span><span class="typ">Or</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> DIR_UP </span><span class="typ">Or</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> DIR_RIGHT </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> globalevent </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">DirFix</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerindex</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">DirFix</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerindex</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">SEventDir</span><span class="pln"><br>&nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> eventID<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> globalevent </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerindex</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SendDataToMap</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EventMove</span><span class="pun">(</span><span class="pln">index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> movementspeed </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Optional</span><span class="pln"> globalevent </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> packet </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> buffer </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' Check for subscript out of range<br>&nbsp; &nbsp; If mapnum &lt;= 0 Or mapnum &gt; MAX_MAPS Or Dir &lt; DIR_UP Or Dir &gt; DIR_RIGHT Then<br>&nbsp; &nbsp; &nbsp; &nbsp; Exit Sub<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(eventID).Pages(1).DirFix = 0 Then TempEventMap(mapnum).Events(eventID).Dir = Dir<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(eventID).Pages(TempPlayer(index).EventMap.EventPages(eventID).pageID).DirFix = 0 Then TempPlayer(index).EventMap.EventPages(eventID).Dir = Dir<br>&nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; Select Case Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempEventMap(mapnum).Events(eventID).y = TempEventMap(mapnum).Events(eventID).y - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventMap.EventPages(eventID).y = TempPlayer(index).EventMap.EventPages(eventID).y - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempEventMap(mapnum).Events(eventID).y = TempEventMap(mapnum).Events(eventID).y + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventMap.EventPages(eventID).y = TempPlayer(index).EventMap.EventPages(eventID).y + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempEventMap(mapnum).Events(eventID).x = TempEventMap(mapnum).Events(eventID).x - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventMap.EventPages(eventID).x = TempPlayer(index).EventMap.EventPages(eventID).x - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempEventMap(mapnum).Events(eventID).x = TempEventMap(mapnum).Events(eventID).x + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempEventMap(mapnum).Events(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventMap.EventPages(eventID).x = TempPlayer(index).EventMap.EventPages(eventID).x + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong SEventMove<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong TempPlayer(index).EventMap.EventPages(eventID).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buffer.WriteLong movementspeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If globalevent Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataToMap mapnum, buffer.ToArray()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendDataTo index, buffer.ToArray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End Select<br><br>End Sub</span></pre><br>in modgeneral search for <strong class="bbc">Call SpawnAllMapNpcs</strong><br>then add just below it<br><pre class="prettyprint"><span class="typ">Call</span><span class="pln"> </span><span class="typ">SetStatus</span><span class="pun">(</span><span class="str">"Spawning global events..."</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SpawnAllMapGlobalEvents</span></pre><br>in modgeneral search for <strong class="bbc">Call LoadAnimations</strong><br>then add just below it<br><pre class="prettyprint"><span class="pln">call </span><span class="typ">SetStatus</span><span class="pun">(</span><span class="str">"Loading switches..."</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">LoadSwitches</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SetStatus</span><span class="pun">(</span><span class="str">"Loading variables..."</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">LoadVariables</span></pre><br>in modhandledata search for <strong class="bbc">HandleDataSub(CPartyLeave) = GetAddress(AddressOf HandlePartyLeave)</strong><br>then add below it<br><pre class="prettyprint"><span class="typ">HandleDataSub</span><span class="pun">(</span><span class="typ">CEventChatReply</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetAddress</span><span class="pun">(</span><span class="typ">AddressOf</span><span class="pln"> </span><span class="typ">HandleEventChatReply</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleDataSub</span><span class="pun">(</span><span class="typ">CEvent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetAddress</span><span class="pun">(</span><span class="typ">AddressOf</span><span class="pln"> </span><span class="typ">HandleEvent</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleDataSub</span><span class="pun">(</span><span class="typ">CRequestSwitchesAndVariables</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetAddress</span><span class="pun">(</span><span class="typ">AddressOf</span><span class="pln"> </span><span class="typ">HandleRequestSwitchesAndVariables</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleDataSub</span><span class="pun">(</span><span class="typ">CSwitchesAndVariables</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetAddress</span><span class="pun">(</span><span class="typ">AddressOf</span><span class="pln"> </span><span class="typ">HandleSwitchesAndVariables</span><span class="pun">)</span></pre><br>in modhandledata search for <strong class="bbc">Sub HandleMapData(ByVal index As Long, ByRef Data() As Byte, ByVal StartAddr As Long, ByVal ExtraVar As Long)</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre>then just below<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAP_NPCS<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Npc</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">ClearMapNpc</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre>add<br><pre class="prettyprint"><span class="str">'Event Data!<br>&nbsp; &nbsp; Map(mapnum).EventCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; If Map(mapnum).EventCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim Map(mapnum).Events(0 To Map(mapnum).EventCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To Map(mapnum).EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Name = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Global = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .x = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .y = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .PageCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).PageCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Map(mapnum).Events(i).Pages(0 To Map(mapnum).Events(i).PageCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For x = 1 To Map(mapnum).Events(i).PageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i).Pages(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .chkVariable = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .VariableIndex = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .VariableCondition = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .VariableCompare = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .chkSwitch = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .SwitchIndex = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .SwitchCompare = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .chkHasItem = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .HasItemIndex = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .chkSelfSwitch = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .SelfSwitchIndex = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .SelfSwitchCompare = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicType = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Graphic = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicX = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicY = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicX2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .GraphicY2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveType = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveSpeed = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveFreq = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRouteCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .IgnoreMoveRoute = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .RepeatMoveRoute = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Map(mapnum).Events(i).Pages(x).MoveRoute(0 To .MoveRouteCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).index = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).Data1 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).Data2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).Data3 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).data4 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).data5 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(y).data6 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .WalkAnim = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .DirFix = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .WalkThrough = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ShowName = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Trigger = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .CommandListCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Position = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(x).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Map(mapnum).Events(i).Pages(x).CommandList(0 To Map(mapnum).Events(i).Pages(x).CommandListCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To Map(mapnum).Events(i).Pages(x).CommandListCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map(mapnum).Events(i).Pages(x).CommandList(y).ParentList = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Map(mapnum).Events(i).Pages(x).CommandList(y).Commands(1 To Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To Map(mapnum).Events(i).Pages(x).CommandList(y).CommandCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map(mapnum).Events(i).Pages(x).CommandList(y).Commands(z)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .index = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Text1 = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Text2 = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Text3 = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Text4 = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Text5 = buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Data1 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Data2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Data3 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .data4 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .data5 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .data6 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.CommandList = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.Condition = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.Data1 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.Data2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.Data3 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ConditionalBranch.ElseCommandList = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRouteCount = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve .MoveRoute(.MoveRouteCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For w = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).index = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).Data1 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).Data2 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).Data3 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).data4 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).data5 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .MoveRoute(w).data6 = buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">End</span><span class="pln"> </span><span class="typ">Event</span><span class="pln"> </span><span class="typ">Data</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SendMapNpcsToMap</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SpawnMapNpcs</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">SpawnGlobalEvents</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Map</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mapnum </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpawnMapEventsFor</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> mapnum<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842335">
				<ul class="ipsList_inline">
					<li id="like_post_842335" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842335&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842335" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842335&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842335" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842335', { domLikeStripId: 'like_post_842335', app: 'forums', type: 'pid', typeid: '842335' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842335" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842335" class="_ips_trigger_quote ipsButton_secondary" pid="842335" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842335" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842335" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842335&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842335);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842335') )
	{
		$('multiq_842335').show();
	}
	
	if( $('toggle_post_842335') )
	{
		$('toggle_post_842335').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842335] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842338-->

<div class="post_block hentry clear clearfix " id="post_id_842338">
		<a id="entry842338"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842338" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #4">
					
					#4
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_7" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:55:18+00:00">08 August 2012 - 06:55 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->in modhandledata search for <strong class="bbc">Sub HandleNeedMap(ByVal index As Long, ByRef Data() As Byte, ByVal StartAddr As Long, ByVal ExtraVar As Long)</strong><br>below <br><pre class="prettyprint"><span class="typ">Call</span><span class="pln"> </span><span class="typ">SendMapNpcsTo</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">))</span></pre>add<br><pre class="prettyprint"><span class="typ">Call</span><span class="pln"> </span><span class="typ">SpawnMapEventsFor</span><span class="pun">(</span><span class="pln">index</span><span class="pun">,</span><span class="pln"> </span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">))</span></pre><br>in modhandle data find<strong class="bbc"> Sub HandleRequestEditMap(ByVal index As Long, ByRef Data() As Byte, ByVal StartAddr As Long, ByVal ExtraVar As Long</strong><br>after <br><pre class="prettyprint"><span class="pln">endif</span></pre> <br>add<br><pre class="prettyprint"><span class="typ">SendMapEventData</span><span class="pln"> </span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span></pre><br>at the bottom of <strong class="bbc">modhandledata</strong> add<br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventChatReply</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> buffer </span><span class="typ">As</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> pageID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> reply </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteBytes</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; eventID </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; pageID </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; reply </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID </span><span class="pun">=</span><span class="pln"> eventID </span><span class="typ">And</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageID </span><span class="pun">=</span><span class="pln"> pageID </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">WaitingForResponse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> reply </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="pln">index </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowText </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">WaitingForResponse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> reply </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="pln">index </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowChoices </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> reply<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ListLeftOff</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ListLeftOff</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ListLeftOff</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ListLeftOff</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurList</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">).</span><span class="pln">data4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">WaitingForResponse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEvent</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> n </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Damage</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">TempIndex</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> begineventprocessing </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> buffer </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' Check tradeskills<br>&nbsp; &nbsp; Select Case GetPlayerDir(index)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GetPlayerY(index) = 0 Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = GetPlayerX(index)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = GetPlayerY(index) - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_DOWN<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GetPlayerY(index) = Map(GetPlayerMap(index)).MaxY Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = GetPlayerX(index)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = GetPlayerY(index) + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GetPlayerX(index) = 0 Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = GetPlayerX(index) - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = GetPlayerY(index)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case DIR_RIGHT<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GetPlayerX(index) = Map(GetPlayerMap(index)).MaxX Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = GetPlayerX(index) + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = GetPlayerY(index)<br>&nbsp; &nbsp; End Select<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set buffer = New clsBuffer<br>&nbsp; &nbsp; buffer.WriteBytes Data<br>&nbsp; &nbsp; i = buffer.ReadLong<br>&nbsp; &nbsp; Set buffer = Nothing<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If TempPlayer(index).EventMap.CurrentEvents &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To TempPlayer(index).EventMap.CurrentEvents<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If TempPlayer(index).EventMap.EventPages(z).eventID = i Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i = z<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; begineventprocessing = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit For<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If begineventprocessing = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map(GetPlayerMap(index)).Events(TempPlayer(index).EventMap.EventPages(i).eventID).Pages(TempPlayer(index).EventMap.EventPages(i).pageID).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="typ">Process</span><span class="pln"> </span><span class="kwd">this</span><span class="pln"> </span><span class="kwd">event</span><span class="pun">,</span><span class="pln"> it </span><span class="kwd">is</span><span class="pln"> action button </span><span class="kwd">and</span><span class="pln"> everything checks </span><span class="kwd">out</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessing</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ActionTimer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetTickCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">CurList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">CurSlot</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">eventID </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">pageID </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">WaitingForResponse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="pun">.</span><span class="typ">ListLeftOff</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; begineventprocessing </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleRequestSwitchesAndVariables</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SendSwitchesAndVariables</span><span class="pln"> </span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleSwitchesAndVariables</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> buffer </span><span class="typ">As</span><span class="pln"> clsBuffer</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; buffer</span><span class="pun">.</span><span class="typ">WriteBytes</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">SaveSwitches</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SaveVariables</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> buffer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">SendSwitchesAndVariables</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in modtypes search for <strong class="bbc">Public Map(1 To MAX_MAPS) As MapRec</strong><br>just below add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">TempEventMap</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_MAPS</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">GlobalEventsRec</span></pre>and at bottom of list add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span></pre><br>then just below that add this<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data4 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data5 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data6 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">GlobalEventRec</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; active </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">WalkingAnim</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">FixedDir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Position</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">GraphicType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicNum</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicX</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicX2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicY</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicY2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Server Only Options<br>&nbsp; &nbsp; MoveType As Long<br>&nbsp; &nbsp; MoveSpeed As Long<br>&nbsp; &nbsp; MoveFreq As Long<br>&nbsp; &nbsp; MoveRouteCount As Long<br>&nbsp; &nbsp; MoveRoute() As MoveRouteRec<br>&nbsp; &nbsp; MoveRouteStep As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; RepeatMoveRoute As Long<br>&nbsp; &nbsp; IgnoreIfCannotMove As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; MoveTimer As Long<br>End Type<br><br>Public Type GlobalEventsRec<br>&nbsp; &nbsp; EventCount As Long<br>&nbsp; &nbsp; Events() As GlobalEventRec<br>End Type</span></pre><br>in modtypes search for <strong class="bbc">Private Type PlayerRec</strong><br>at the bottom add<br><pre class="prettyprint"><span class="typ">Switches</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Variables</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre><br>in modtypes search for <strong class="bbc">Public Type DoTRec</strong><br>just below that type add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">ConditionalBranchRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Condition</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseCommandList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventCommandRec</span><span class="pln"><br>&nbsp; &nbsp; index </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text4</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text5</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data4 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data5 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; data6 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ConditionalBranch</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">ConditionalBranchRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">CommandListRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ParentList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Commands</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventCommandRec</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventPageRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'These are condition variables that decide if the event even appears to the player.<br>&nbsp; &nbsp; chkVariable As Long<br>&nbsp; &nbsp; VariableIndex As Long<br>&nbsp; &nbsp; VariableCondition As Long<br>&nbsp; &nbsp; VariableCompare As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkSwitch As Long<br>&nbsp; &nbsp; SwitchIndex As Long<br>&nbsp; &nbsp; SwitchCompare As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkHasItem As Long<br>&nbsp; &nbsp; HasItemIndex As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkSelfSwitch As Long<br>&nbsp; &nbsp; SelfSwitchIndex As Long<br>&nbsp; &nbsp; SelfSwitchCompare As Long<br>&nbsp; &nbsp; '</span><span class="typ">End</span><span class="pln"> </span><span class="typ">Conditions</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Handles the Event Sprite<br>&nbsp; &nbsp; GraphicType As Byte<br>&nbsp; &nbsp; Graphic As Long<br>&nbsp; &nbsp; GraphicX As Long<br>&nbsp; &nbsp; GraphicY As Long<br>&nbsp; &nbsp; GraphicX2 As Long<br>&nbsp; &nbsp; GraphicY2 As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Handles</span><span class="pln"> </span><span class="typ">Movement</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">Move</span><span class="pln"> </span><span class="typ">Routes</span><span class="pln"> to come soon</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">IgnoreMoveRoute</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Guidelines for the event<br>&nbsp; &nbsp; WalkAnim As Long<br>&nbsp; &nbsp; DirFix As Long<br>&nbsp; &nbsp; WalkThrough As Long<br>&nbsp; &nbsp; ShowName As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Trigger</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> the </span><span class="kwd">event</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Trigger</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Commands for the event<br>&nbsp; &nbsp; CommandListCount As Long<br>&nbsp; &nbsp; CommandList() As CommandListRec<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Position As Byte<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">For</span><span class="pln"> </span><span class="typ">EventMap</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Name</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Global</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">PageCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Pages</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventPageRec</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'Self Switches re-set on restart.<br>&nbsp; &nbsp; SelfSwitches(0 To 4) As Long<br>End Type<br><br>Public Type GlobalMapEvents<br>&nbsp; &nbsp; eventID As Long<br>&nbsp; &nbsp; pageID As Long<br>&nbsp; &nbsp; x As Long<br>&nbsp; &nbsp; y As Long<br>End Type<br><br>Private Type MapEventRec<br>&nbsp; &nbsp; Dir As Long<br>&nbsp; &nbsp; x As Long<br>&nbsp; &nbsp; y As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; WalkingAnim As Long<br>&nbsp; &nbsp; FixedDir As Long<br>&nbsp; &nbsp; WalkThrough As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; GraphicType As Long<br>&nbsp; &nbsp; GraphicX As Long<br>&nbsp; &nbsp; GraphicY As Long<br>&nbsp; &nbsp; GraphicX2 As Long<br>&nbsp; &nbsp; GraphicY2 As Long<br>&nbsp; &nbsp; GraphicNum As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; movementspeed As Long<br>&nbsp; &nbsp; Position As Long<br>&nbsp; &nbsp; Visible As Long<br>&nbsp; &nbsp; eventID As Long<br>&nbsp; &nbsp; pageID As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Server</span><span class="pln"> </span><span class="typ">Only</span><span class="pln"> </span><span class="typ">Options</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteStep</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">IgnoreIfCannotMove</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">MoveTimer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SelfSwitches</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventMapRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">EventPages</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MapEventRec</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventProcessingRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CurList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CurSlot</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; pageID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WaitingForResponse</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ActionTimer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListLeftOff</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span></pre><br>in modtypes search for <strong class="bbc">Public Type TempPlayerRec</strong><br>at the bottom add<br><pre class="prettyprint"><span class="typ">EventMap</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventMapRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">EventProcessingCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">EventProcessing</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventProcessingRec</span></pre><br>in modtypes search for <strong class="bbc">Private Type MapRec</strong><br>at the bottom add<br><pre class="prettyprint"><span class="typ">EventCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Events</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventRec</span></pre><br>in modserverloop search for <strong class="bbc">frmServer.lblCPS.Caption = "CPS: " &amp; Format$(GameCPS, "#,###,###,###")</strong><br>just above that line and<strong class="bbc"> next </strong> add<br><pre class="prettyprint"><span class="typ">UpdateEventLogic</span></pre><br>at bottom of <strong class="bbc">modserverloop</strong> add<br><pre class="prettyprint"><span class="typ">Function</span><span class="pln"> </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pun">(</span><span class="pln">playerID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> didwalk </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'This does not work for global events so this MUST be a player one....<br>&nbsp; &nbsp; '</span><span class="typ">This</span><span class="pln"> </span><span class="typ">Event</span><span class="pln"> returns a direction</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> a valid direction so we assume fail </span><span class="kwd">unless</span><span class="pln"> otherwise told</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> playerID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> playerID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> mapnum </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> mapnum </span><span class="pun">&gt;</span><span class="pln"> MAX_MAPS </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> eventID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> eventID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x<br>&nbsp; &nbsp; y1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y<br>&nbsp; &nbsp; </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="pln">mapnum</span><span class="pun">).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">WalkThrough</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Int</span><span class="pun">(</span><span class="typ">Rnd</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">5</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' Lets move the event<br>&nbsp; &nbsp; Select Case i<br>&nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Up</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_UP</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Down<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &lt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_DOWN, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Left</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_LEFT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Right<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &lt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_RIGHT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Right</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_RIGHT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &gt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_LEFT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Down</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_DOWN</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Up<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &gt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_UP, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Down</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_DOWN</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Up<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &gt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_UP, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Right</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_RIGHT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &gt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_LEFT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case 3<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Left</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_LEFT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Right<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &lt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_RIGHT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Up</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_UP</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveTowardsPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Down<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &lt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_DOWN, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveTowardsPlayer = Random(0, 3)<br>End Function<br><br>Function CanEventMoveAwayFromPlayer(playerID As Long, mapnum As Long, eventID As Long) As Long<br>Dim i As Long, x As Long, y As Long, x1 As Long, y1 As Long, didwalk As Boolean, WalkThrough As Long<br>&nbsp; &nbsp; '</span><span class="typ">This</span><span class="pln"> does </span><span class="kwd">not</span><span class="pln"> work </span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">global</span><span class="pln"> events so </span><span class="kwd">this</span><span class="pln"> MUST be a player one</span><span class="pun">....</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'This Event returns a direction, 5 is not a valid direction so we assume fail unless otherwise told.<br>&nbsp; &nbsp; CanEventMoveAwayFromPlayer = 5<br>&nbsp; &nbsp; If playerID &lt;= 0 Or playerID &gt; Player_HighIndex Then Exit Function<br>&nbsp; &nbsp; If mapnum &lt;= 0 Or mapnum &gt; MAX_MAPS Then Exit Function<br>&nbsp; &nbsp; If eventID &lt;= 0 Or eventID &gt; TempPlayer(playerID).EventMap.CurrentEvents Then Exit Function<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; x = GetPlayerX(playerID)<br>&nbsp; &nbsp; y = GetPlayerY(playerID)<br>&nbsp; &nbsp; x1 = TempPlayer(playerID).EventMap.EventPages(eventID).x<br>&nbsp; &nbsp; y1 = TempPlayer(playerID).EventMap.EventPages(eventID).y<br>&nbsp; &nbsp; WalkThrough = Map(mapnum).Events(TempPlayer(playerID).EventMap.EventPages(eventID).eventID).Pages(TempPlayer(playerID).EventMap.EventPages(eventID).pageID).WalkThrough<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; i = Int(Rnd * 5)<br>&nbsp; &nbsp; didwalk = False<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Lets</span><span class="pln"> move the </span><span class="kwd">event</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Up<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &gt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_DOWN, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Down</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_UP</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &gt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_RIGHT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Right</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_LEFT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Right<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &lt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_LEFT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Left</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_RIGHT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Down<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &lt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_UP, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Up</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_DOWN</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Down<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &lt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_UP, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Up</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_DOWN</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Right<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &lt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_LEFT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Left</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_RIGHT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x1 &gt; x And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_RIGHT, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Right</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_LEFT</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Up<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If y1 &gt; y And Not didwalk Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If CanEventMove(playerID, mapnum, x1, y1, eventID, WalkThrough, DIR_DOWN, False) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanEventMoveAwayFromPlayer = DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Function<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Down</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> didwalk </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CanEventMove</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">,</span><span class="pln"> mapnum</span><span class="pun">,</span><span class="pln"> x1</span><span class="pun">,</span><span class="pln"> y1</span><span class="pun">,</span><span class="pln"> eventID</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pun">,</span><span class="pln"> DIR_UP</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; didwalk </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanEventMoveAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Random</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br><br></span><span class="typ">Function</span><span class="pln"> </span><span class="typ">GetDirToPlayer</span><span class="pun">(</span><span class="pln">playerID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> didwalk </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> distance </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'This does not work for global events so this MUST be a player one....<br>&nbsp; &nbsp; '</span><span class="typ">This</span><span class="pln"> </span><span class="typ">Event</span><span class="pln"> returns a direction</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> a valid direction so we assume fail </span><span class="kwd">unless</span><span class="pln"> otherwise told</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> playerID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> playerID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> mapnum </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> mapnum </span><span class="pun">&gt;</span><span class="pln"> MAX_MAPS </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> eventID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> eventID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x<br>&nbsp; &nbsp; y1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">((</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">GetDirToPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; <br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br><br></span><span class="typ">Function</span><span class="pln"> </span><span class="typ">GetDirAwayFromPlayer</span><span class="pun">(</span><span class="pln">playerID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> mapnum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> eventID </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y1 </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> didwalk </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pun">,</span><span class="pln"> </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> distance </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'This does not work for global events so this MUST be a player one....<br>&nbsp; &nbsp; '</span><span class="typ">This</span><span class="pln"> </span><span class="typ">Event</span><span class="pln"> returns a direction</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> a valid direction so we assume fail </span><span class="kwd">unless</span><span class="pln"> otherwise told</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> playerID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> playerID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Player_HighIndex</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> mapnum </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> mapnum </span><span class="pun">&gt;</span><span class="pln"> MAX_MAPS </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> eventID </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> eventID </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; x1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x<br>&nbsp; &nbsp; y1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">playerID</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> x1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> x1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> y1 </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">((</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> distance </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> y1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">GetDirAwayFromPlayer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span></pre><br>in modenumerations in<strong class="bbc"> Public Enum ServerPackets </strong> <br>add at bottom<br><pre class="prettyprint"><span class="typ">SSpawnEvent</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventMove</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventDir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventChat</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventStart</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventEnd</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SPlayBGM</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SPlaySound</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SFadeoutBGM</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SStopSound</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SSwitchesAndVariables</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SMapEventData</span></pre><br>in modenumerations in<strong class="bbc"> Public Enum ClientPackets</strong><br>add at bottom<br><pre class="prettyprint"><span class="typ">CEventChatReply</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CEvent</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CSwitchesAndVariables</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CRequestSwitchesAndVariables</span></pre><br>at bottom of <strong class="bbc">modenumerations</strong> add<br><pre class="prettyprint"><span class="str">' Event Types<br>Public Enum EventType<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Message</span><span class="pln"><br>&nbsp; &nbsp; evAddText </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; evShowText<br>&nbsp; &nbsp; evShowChoices<br>&nbsp; &nbsp; </span><span class="str">' Game Progression<br>&nbsp; &nbsp; evPlayerVar<br>&nbsp; &nbsp; evPlayerSwitch<br>&nbsp; &nbsp; evSelfSwitch<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Flow</span><span class="pln"> </span><span class="typ">Control</span><span class="pln"><br>&nbsp; &nbsp; evCondition<br>&nbsp; &nbsp; evExitProcess<br>&nbsp; &nbsp; </span><span class="str">' Player<br>&nbsp; &nbsp; evChangeItems<br>&nbsp; &nbsp; evRestoreHP<br>&nbsp; &nbsp; evRestoreMP<br>&nbsp; &nbsp; evLevelUp<br>&nbsp; &nbsp; evChangeLevel<br>&nbsp; &nbsp; evChangeSkills<br>&nbsp; &nbsp; evChangeClass<br>&nbsp; &nbsp; evChangeSprite<br>&nbsp; &nbsp; evChangeSex<br>&nbsp; &nbsp; evChangePK<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Movement</span><span class="pln"><br>&nbsp; &nbsp; evWarpPlayer<br>&nbsp; &nbsp; evSetMoveRoute<br>&nbsp; &nbsp; </span><span class="str">' Character<br>&nbsp; &nbsp; evPlayAnimation<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Music</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="typ">Sounds</span><span class="pln"><br>&nbsp; &nbsp; evPlayBGM<br>&nbsp; &nbsp; evFadeoutBGM<br>&nbsp; &nbsp; evPlaySound<br>&nbsp; &nbsp; evStopSound<br>&nbsp; &nbsp; </span><span class="str">'Etc...<br>&nbsp; &nbsp; evCustomScript<br>&nbsp; &nbsp; evSetAccess<br>&nbsp; &nbsp; '</span><span class="typ">Shop</span><span class="pun">/</span><span class="typ">Bank</span><span class="pln"><br>&nbsp; &nbsp; evOpenBank<br>&nbsp; &nbsp; evOpenShop<br>&nbsp; &nbsp; </span><span class="str">'New<br>&nbsp; &nbsp; evGiveExp<br>End Enum</span></pre><br>in modplayer find <strong class="bbc">Sub PlayerWarp(ByVal index As Long, ByVal mapnum As Long, ByVal x As Long, ByVal y As Long)</strong><br>just above<br><pre class="prettyprint"><span class="str">' clear target</span></pre>add<br><pre class="prettyprint"><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventProcessingCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></pre><br>in modplayer find <strong class="bbc">Sub PlayerMove(ByVal index As Long, ByVal Dir As Long, ByVal movement As Long, Optional ByVal sendToSelf As Boolean = False)</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> </span><span class="typ">TileType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">VitalType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Colour</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> amount </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> begineventprocessing </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span></pre>then after<br><pre class="prettyprint"><span class="str">' They tried to hack<br>&nbsp; &nbsp; If Moved = NO Then<br>&nbsp; &nbsp; &nbsp; &nbsp; PlayerWarp index, GetPlayerMap(index), GetPlayerX(index), GetPlayerY(index)<br>&nbsp; &nbsp; End If</span></pre>add<br><pre class="prettyprint"><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Moved</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> YES </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Global</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">Trigger</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> begineventprocessing </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">(</span><span class="typ">GetPlayerMap</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)).</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">eventID</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="typ">TempPlayer</span><span class="pun">(</span><span class="pln">index</span><span class="pun">).</span><span class="typ">EventMap</span><span class="pun">.</span><span class="typ">EventPages</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageID</span><span class="pun">).</span><span class="typ">Trigger</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> begineventprocessing </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> begineventprocessing </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">'Process this event, it is on-touch and everything checks out.<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map(GetPlayerMap(index)).Events(TempPlayer(index).EventMap.EventPages(i).eventID).Pages(TempPlayer(index).EventMap.EventPages(i).pageID).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessingCount = TempPlayer(index).EventProcessingCount + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).ActionTimer = GetTickCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).CurList = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).CurSlot = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).eventID = TempPlayer(index).EventMap.EventPages(i).eventID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).pageID = TempPlayer(index).EventMap.EventPages(i).pageID<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).WaitingForResponse = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim TempPlayer(index).EventProcessing(TempPlayer(index).EventProcessingCount).ListLeftOff(0 To Map(GetPlayerMap(index)).Events(TempPlayer(index).EventMap.EventPages(i).eventID).Pages(TempPlayer(index).EventMap.EventPages(i).pageID).CommandListCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; begineventprocessing = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End If</span></pre><br>in <strong class="bbc">frmmain</strong> add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">Command1_Click</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Player</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">Switches</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">Command2_Click</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Player</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">Switches</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in modplayer find <strong class="bbc">' Send some more little goodies, no need to explain these</strong><br>at the bottom of the list add<br><pre class="prettyprint"><span class="typ">Call</span><span class="pln"> </span><span class="typ">SendSwitchesAndVariables</span><span class="pun">(</span><span class="pln">index</span><span class="pun">)</span></pre><br>in modconstants find <strong class="bbc">Public Const MAX_PARTY_MEMBERS As Long = 4</strong><br>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Const</span><span class="pln"> MAX_SWITCHES </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Const</span><span class="pln"> MAX_VARIABLES </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span></pre><br><strong class="bbc">add modcustomscripts to your project<br>add modeventlogic to your project</strong><br><br><strong class="bbc">save first!!! native compile will crash vb<br>lastly
 when you compile you need to got project, server properties, compile 
tab, and select p-code.&nbsp; this wont compile as is in native.&nbsp; 
there are drawbacks to p-code in security so it may not be for everyone.</strong>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842338">
				<ul class="ipsList_inline">
					<li id="like_post_842338" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842338&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842338" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842338&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842338" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842338', { domLikeStripId: 'like_post_842338', app: 'forums', type: 'pid', typeid: '842338' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842338" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842338" class="_ips_trigger_quote ipsButton_secondary" pid="842338" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842338" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842338" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842338&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842338);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842338') )
	{
		$('multiq_842338').show();
	}
	
	if( $('toggle_post_842338') )
	{
		$('toggle_post_842338').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842338] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842339-->

<div class="post_block hentry clear clearfix " id="post_id_842339">
		<a id="entry842339"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842339" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #5">
					
					#5
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_8" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:57:09+00:00">08 August 2012 - 06:57 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000--><strong class="bbc"><span style="font-size: px;">Client Side</span></strong><br><br>in <strong class="bbc">frmmap editor</strong>create a option button named <strong class="bbc">optEvent</strong> with the caption <strong class="bbc">event</strong> it should go in the same frame as the layers atributes and block area.<br><br>in <strong class="bbc">frmmain</strong>copy and past the <strong class="bbc">entire event chat box from the 2.3 client source</strong>.&nbsp; its a box with some lables.<br><br>double click the big text area in that box. it should be <strong class="bbc">lblEventChat</strong>.<br>add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChat_MouseMove</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>double click any of the 4 choices<br>add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblChoices_Click</span><span class="pun">(</span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">CEventChatReply</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">EventReplyID</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">EventReplyPage</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"><br></span><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pln"><br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">ClearEventChat</span><span class="pln"><br></span><span class="typ">InEvent</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>double click <strong class="bbc">continue </strong> and add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChatContinue_Click</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">CEventChatReply</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">EventReplyID</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">EventReplyPage</span><span class="pln"><br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br></span><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pln"><br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">ClearEventChat</span><span class="pln"><br></span><span class="typ">InEvent</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>then just below that in frmmain add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChatContinue_MouseDown</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChatContinue_MouseMove</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChatContinue_MouseUp</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> lblEventChat_MouseMove</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> picEventChat_MouseMove</span><span class="pun">(</span><span class="typ">Button</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Shift</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Integer</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Single</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; lblEventChatContinue</span><span class="pun">.</span><span class="typ">FontBold</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in frmmain search for <strong class="bbc">Private Sub Form_KeyUp(KeyCode As Integer, Shift As Integer)</strong><br>then below<br><pre class="prettyprint"><span class="str">' hotbar<br>&nbsp; &nbsp; For i = 1 To MAX_HOTBAR<br>&nbsp; &nbsp; &nbsp; &nbsp; If KeyCode = 111 + i Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SendHotbarUse i<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; Next</span></pre>add<br><pre class="prettyprint"><span class="str">' handles delete events<br>&nbsp; &nbsp; If KeyCode = vbKeyDelete Then<br>&nbsp; &nbsp; &nbsp; &nbsp; If InMapEditor Then DeleteEvent CurX, CurY<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> handles copy </span><span class="pun">+</span><span class="pln"> pasting events<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">KeyCode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vbKeyC </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">ControlDown</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">InMapEditor</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CopyEvent_Map</span><span class="pln"> </span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">KeyCode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vbKeyV </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">ControlDown</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">InMapEditor</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">PasteEvent_Map</span><span class="pln"> </span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>in frmmain find <strong class="bbc">Private Sub picScreen_MouseDown(Button As Integer, Shift As Integer, x As Single, y As Single)</strong><br>at the bottom of the sub add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">SetFocus</span></pre><br>at the bottom of <strong class="bbc">modtext</strong> add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">DrawEventName</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">TextX</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">TextY</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> color </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Name</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; If InMapEditor Then Exit Sub<br><br>&nbsp; &nbsp; color = QBColor(White)<br><br>&nbsp; &nbsp; Name = Trim$(Map.MapEvents(Index).Name)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> calc pos<br>&nbsp; &nbsp; </span><span class="typ">TextX</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ConvertMapX</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="pln">x </span><span class="pun">*</span><span class="pln"> PIC_X</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">PIC_X </span><span class="pun">\</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> getWidth</span><span class="pun">(</span><span class="typ">TexthDC</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Name</span><span class="pun">)))</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">GraphicType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TextY</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ConvertMapY</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> PIC_Y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">16</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">GraphicType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">GraphicNum</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Or</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">GraphicNum</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">NumCharacters</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TextY</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ConvertMapY</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> PIC_Y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="typ">Index</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">16</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Determine location for text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TextY = ConvertMapY(Map.MapEvents(Index).y * PIC_Y) + Map.MapEvents(Index).YOffset - (DDSD_Character(Map.MapEvents(Index).GraphicNum).lHeight / 4) + 16<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; ElseIf Map.MapEvents(Index).GraphicType = 2 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(Index).GraphicY2 = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TextY = ConvertMapY(Map.MapEvents(Index).y * PIC_Y) + Map.MapEvents(Index).YOffset - ((Map.MapEvents(Index).GraphicY2 - Map.MapEvents(Index).GraphicY) * 32) + 16<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TextY = ConvertMapY(Map.MapEvents(Index).y * PIC_Y) + Map.MapEvents(Index).YOffset - 32 + 16<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Draw</span><span class="pln"> name<br>&nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">DrawText</span><span class="pun">(</span><span class="typ">TexthDC</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TextX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TextY</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Name</span><span class="pun">,</span><span class="pln"> color</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' Error handler<br>&nbsp; &nbsp; Exit Sub<br>errorhandler:<br>&nbsp; &nbsp; HandleError "DrawEventName", "modText", Err.Number, Err.Description, Err.Source, Err.HelpContext<br>&nbsp; &nbsp; Err.Clear<br>&nbsp; &nbsp; Exit Sub<br>End Sub</span></pre><br>in modtypes find <strong class="bbc">Private Type PlayerRec</strong><br>add at bottom<br><pre class="prettyprint"><span class="typ">EventTimer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre><br>in modtypes below <strong class="bbc">Private Type TileDataRec</strong><br>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">ConditionalBranchRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Condition</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseCommandList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data4</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data5</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data6</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventCommandRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text4</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Text5</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data3</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data4</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data5</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Data6</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ConditionalBranch</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">ConditionalBranchRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">CommandListRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ParentList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Commands</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventCommandRec</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventPageRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'These are condition variables that decide if the event even appears to the player.<br>&nbsp; &nbsp; chkVariable As Long<br>&nbsp; &nbsp; VariableIndex As Long<br>&nbsp; &nbsp; VariableCondition As Long<br>&nbsp; &nbsp; VariableCompare As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkSwitch As Long<br>&nbsp; &nbsp; SwitchIndex As Long<br>&nbsp; &nbsp; SwitchCompare As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkHasItem As Long<br>&nbsp; &nbsp; HasItemIndex As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; chkSelfSwitch As Long<br>&nbsp; &nbsp; SelfSwitchIndex As Long<br>&nbsp; &nbsp; SelfSwitchCompare As Long<br>&nbsp; &nbsp; '</span><span class="typ">End</span><span class="pln"> </span><span class="typ">Conditions</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Handles the Event Sprite<br>&nbsp; &nbsp; GraphicType As Byte<br>&nbsp; &nbsp; Graphic As Long<br>&nbsp; &nbsp; GraphicX As Long<br>&nbsp; &nbsp; GraphicY As Long<br>&nbsp; &nbsp; GraphicX2 As Long<br>&nbsp; &nbsp; GraphicY2 As Long<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Handles</span><span class="pln"> </span><span class="typ">Movement</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">Move</span><span class="pln"> </span><span class="typ">Routes</span><span class="pln"> to come soon</span><span class="pun">.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">IgnoreMoveRoute</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Guidelines for the event<br>&nbsp; &nbsp; WalkAnim As Byte<br>&nbsp; &nbsp; DirFix As Byte<br>&nbsp; &nbsp; WalkThrough As Byte<br>&nbsp; &nbsp; ShowName As Byte<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Trigger</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> the </span><span class="kwd">event</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Trigger</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Commands for the event<br>&nbsp; &nbsp; CommandListCount As Long<br>&nbsp; &nbsp; CommandList() As CommandListRec<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Position As Byte<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Client</span><span class="pln"> </span><span class="typ">Needed</span><span class="pln"> </span><span class="typ">Only</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Name</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Global</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; pageCount </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Pages</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventPageRec</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span></pre><br>in modtypes below <strong class="bbc">Public Type TileRec</strong><br>add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">MapEventRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Name</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicX</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicY</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicX2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicY2</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GraphicNum</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Moving</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Position</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">XOffset</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">YOffset</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Step</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Visible</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkAnim</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">DirFix</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ShowDir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ShowName</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span></pre><br>in modtypes find <strong class="bbc">Private Type MapRec</strong><br>at bottom add<br><pre class="prettyprint"><span class="typ">EventCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Events</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventRec</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'Client Side Only -- Temporary<br>&nbsp; &nbsp; CurrentEvents As Long<br>&nbsp; &nbsp; MapEvents() As MapEventRec</span></pre><br>at bottom of <strong class="bbc">modtypes</strong> add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Type</span><span class="pln"> </span><span class="typ">EventListRec</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandList</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CommandNum</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Type</span></pre><br>search for <strong class="bbc">Call CheckKeys ' Check to make sure they aren't trying to auto do anything</strong><br>then replace this line<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">GetForegroundWindow</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmMain</span><span class="pun">.</span><span class="pln">hWnd </span><span class="typ">Then</span></pre>with<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">GetForegroundWindow</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmMain</span><span class="pun">.</span><span class="pln">hWnd </span><span class="typ">Or</span><span class="pln"> </span><span class="typ">GetForegroundWindow</span><span class="pun">()</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">hWnd </span><span class="typ">Then</span></pre><br>in modgamelogic search for<strong class="bbc"> ' Process input before rendering, otherwise input will be behind by 1 frame</strong><br>then just above it add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Tick</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">EventChatTimer</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmMain</span><span class="pun">.</span><span class="pln">lblEventChat</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmMain</span><span class="pun">.</span><span class="pln">picEventChat</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">picEventChat</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>in modgamelogic search for <strong class="bbc">WalkTimer = Tick + 30 ' edit this value to change WalkTimer</strong><br>then just above it add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">ProcessEventMovement</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>in modgamelogic search for <strong class="bbc">Public Sub CheckAttack()</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> attackspeed </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre>then before the last endif in the sub add<br><pre class="prettyprint"><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerX</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPlayerY</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">GetTickCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">).</span><span class="typ">EventTimer</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">CEvent</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Player</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">).</span><span class="typ">EventTimer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetTickCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">200</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>in modgamelogic search for <strong class="bbc">Function CanMove() As Boolean</strong><br>below<br><pre class="prettyprint"><span class="str">' Make sure they aren'</span><span class="pln">t trying to move </span><span class="kwd">when</span><span class="pln"> they are already moving<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Player</span><span class="pun">(</span><span class="typ">MyIndex</span><span class="pun">).</span><span class="typ">Moving</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">InEvent</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CanMove</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>in modgamelogic search for <strong class="bbc">Function CheckDirection(ByVal Direction As Byte) As Boolean</strong><br>at bottom of the function add<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CheckDirection</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre><br>at the bottom of <strong class="bbc">modgamelogic</strong> add<br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">ProcessEventMovement</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> id </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Check</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> NPC </span><span class="kwd">is</span><span class="pln"> walking</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> so process moving them over<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">Moving</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">Dir</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">((</span><span class="typ">ElapsedTime</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> SIZE_X</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">((</span><span class="typ">ElapsedTime</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> SIZE_X</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">YOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">((</span><span class="typ">ElapsedTime</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> SIZE_X</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">((</span><span class="typ">ElapsedTime</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> SIZE_X</span><span class="pun">))</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">id</span><span class="pun">).</span><span class="typ">XOffset</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Check if completed walking over to the next tile<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Moving &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Dir = DIR_RIGHT Or Map.MapEvents(id).Dir = DIR_DOWN Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).XOffset &gt;= 0) And (Map.MapEvents(id).YOffset &gt;= 0) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Moving = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Step = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Step = 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Step = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).XOffset &lt;= 0) And (Map.MapEvents(id).YOffset &lt;= 0) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Moving = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Step = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Step = 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Map.MapEvents(id).Step = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"ProcessNpcMovement"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modGameLogic"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span><span class="typ">GetColorString</span><span class="pun">(</span><span class="pln">color </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> color<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Black"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Blue"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Green"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Cyan"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Red"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Magenta"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Brown"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">7</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Grey"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">8</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Dark Grey"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">9</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Bright Blue"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">10</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Bright Green"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">11</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Bright Cyan"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">12</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Bright Red"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">13</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Pink"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">14</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Yellow"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">15</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GetColorString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"White"</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">ClearEventChat</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">AnotherChat</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblChoices</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblEventChat</span><span class="pun">.</span><span class="typ">Caption</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblEventChatContinue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> </span><span class="typ">AnotherChat</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblChoices</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblEventChat</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">lblEventChatContinue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventChatTimer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetTickCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">100</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain</span><span class="pun">.</span><span class="pln">picEventChat</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>in modclienttcp search for <strong class="bbc">Public Sub SendMap()</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre>at the bottom before<br><pre class="prettyprint"><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span></pre>add<br><pre class="prettyprint"><span class="str">'Event Data<br>&nbsp; &nbsp; Buffer.WriteLong Map.EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; If Map.EventCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To Map.EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map.Events(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Name<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Global<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .pageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).pageCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For x = 1 To Map.Events(i).pageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map.Events(i).Pages(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .chkVariable<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .VariableIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .VariableCondition<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .VariableCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .chkSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .SwitchIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .SwitchCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .chkHasItem<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .HasItemIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .chkSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .SelfSwitchIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .SelfSwitchCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Graphic<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .GraphicX<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .GraphicY<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .GraphicX2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .GraphicY2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveSpeed<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveFreq<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .IgnoreMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .RepeatMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(y).Data6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .WalkAnim<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .DirFix<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .WalkThrough<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ShowName<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Trigger<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .CommandListCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Position<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).Pages(x).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = 1 To Map.Events(i).Pages(x).CommandListCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong Map.Events(i).Pages(x).CommandList(y).CommandCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong Map.Events(i).Pages(x).CommandList(y).ParentList<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).Pages(x).CommandList(y).CommandCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For z = 1 To Map.Events(i).Pages(x).CommandList(y).CommandCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With Map.Events(i).Pages(x).CommandList(y).Commands(z)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Text1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Text2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Text3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Text4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteString .Text5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .Data6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.CommandList<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.Condition<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.Data1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.Data2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.Data3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .ConditionalBranch.ElseCommandList<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If .MoveRouteCount &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For w = 1 To .MoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data5<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Buffer.WriteLong .MoveRoute(w).Data6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">End</span><span class="pln"> </span><span class="typ">Event</span><span class="pln"> </span><span class="typ">Data</span></pre><br>in moddatabase search for <strong class="bbc">Public Sub SaveMap(ByVal MapNum As Long)</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre><br>in moddatabase search for <strong class="bbc">Public Sub LoadMap(ByVal MapNum As Long)</strong><br>at the top add<br><pre class="prettyprint"><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> p </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span></pre><br>in modglobals search for <strong class="bbc">Public CurrencyMenu As Byte</strong><br>below it add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">InEvent</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span></pre><br>at bottom of <strong class="bbc">modglobals </strong> add<br><pre class="prettyprint"><span class="str">' Temp event storage<br>Public tmpEvent As EventRec<br>Public isEdit As Boolean<br><br>Public curPageNum As Long<br>Public curCommand As Long<br>Public GraphicSelX As Long<br>Public GraphicSelY As Long<br>Public GraphicSelX2 As Long<br>Public GraphicSelY2 As Long<br><br>Public EventTileX As Long<br>Public EventTileY As Long<br><br>Public EditorEvent As Long<br><br>Public GraphicSelType As Long '</span><span class="typ">Are</span><span class="pln"> we selecting a graphic </span><span class="kwd">for</span><span class="pln"> a move route</span><span class="pun">?</span><span class="pln"> A page sprite</span><span class="pun">?</span><span class="pln"> </span><span class="typ">What</span><span class="pun">???</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">TempMoveRouteCount</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">TempMoveRoute</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">MoveRouteRec</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">IsMoveRouteCommand</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">ListOfEvents</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">EventReplyID</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">EventReplyPage</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">RenameType</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">RenameIndex</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">EventChatTimer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">AnotherChat</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="str">'Determines if another showtext/showchoices is comming up, if so, dont close the event chatbox...</span></pre><br>at the top of <strong class="bbc">modgameeditors</strong> just below <br><pre class="prettyprint"><span class="typ">Option</span><span class="pln"> </span><span class="typ">Explicit</span><span class="pln"> </span></pre>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> cpEvent </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventRec</span><span class="pln"><br></span><span class="typ">Const</span><span class="pln"> LB_SETHORIZONTALEXTENT </span><span class="pun">=</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">H194<br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Declare</span><span class="pln"> </span><span class="typ">Function</span><span class="pln"> </span><span class="typ">SendMessageByNum</span><span class="pln"> </span><span class="typ">Lib</span><span class="pln"> </span><span class="str">"user32"</span><span class="pln"> </span><span class="typ">Alias</span><span class="pln"> </span><span class="str">"SendMessageA"</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> hWnd </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> wMsg </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> wParam </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> lParam </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">EventListRec</span></pre><br>search for <strong class="bbc">Public Sub MapEditorMouseDown(ByVal Button As Integer, ByVal x As Long, ByVal y As Long, Optional ByVal movedMouse As Boolean</strong><br>below<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Not</span><span class="pln"> isInBounds </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Button</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vbLeftButton </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Map</span><span class="pun">.</span><span class="pln">optLayers</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">EditorTileWidth</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> </span><span class="typ">EditorTileHeight</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="str">'single tile<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MapEditorSetTile CurX, CurY, CurLayer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else '</span><span class="pln"> multi tile</span><span class="pun">!</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">MapEditorSetTile</span><span class="pln"> </span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurLayer</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>add<br><pre class="prettyprint"><span class="typ">ElseIf</span><span class="pln"> frmEditor_Map</span><span class="pun">.</span><span class="pln">optEvent</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">AddEvent</span><span class="pln"> </span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>then below<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Button</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vbRightButton </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Map</span><span class="pun">.</span><span class="pln">optLayers</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Tile</span><span class="pun">(</span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' clear layer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Layer(CurLayer).x = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Layer(CurLayer).y = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Layer(CurLayer).Tileset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With</span></pre>add<br><pre class="prettyprint"><span class="typ">ElseIf</span><span class="pln"> frmEditor_Map</span><span class="pun">.</span><span class="pln">optEvent</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">DeleteEvent</span><span class="pun">(</span><span class="typ">CurX</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CurY</span><span class="pun">)</span></pre><br>at bottom of <strong class="bbc">modgameeditors</strong> add<br><pre class="prettyprint"><span class="str">'Event Editor Stuffz Also includes event functions from the map editor (copy/paste/delete)<br><br>Sub CopyEvent_Map(x As Long, y As Long)<br>Dim Count As Long, i As Long<br>&nbsp; &nbsp; Count = Map.EventCount<br>&nbsp; &nbsp; If Count = 0 Then Exit Sub<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 1 To Count<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).x = x And Map.Events(i).y = y Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> copy it<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">'CopyMemory ByVal VarPtr(cpEvent), ByVal VarPtr(Map.Events(i)), LenB(Map.Events(i))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cpEvent = Map.Events(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="kwd">exit</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">PasteEvent_Map</span><span class="pun">(</span><span class="pln">x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> eventNum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' already an event - paste over it<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eventNum = i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> couldn</span><span class="str">'t find one - create one<br>&nbsp; &nbsp; If eventNum = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> increment count<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">AddEvent</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; eventNum </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' copy it<br>&nbsp; &nbsp; '</span><span class="typ">CopyMemory</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">VarPtr</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventNum</span><span class="pun">)),</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">VarPtr</span><span class="pun">(</span><span class="pln">cpEvent</span><span class="pun">),</span><span class="pln"> </span><span class="typ">LenB</span><span class="pun">(</span><span class="pln">cpEvent</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">eventNum</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cpEvent<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' set position<br>&nbsp; &nbsp; Map.Events(eventNum).x = x<br>&nbsp; &nbsp; Map.Events(eventNum).y = y<br>End Sub<br><br>Sub DeleteEvent(x As Long, y As Long)<br>Dim Count As Long, i As Long, lowIndex As Long<br>&nbsp; &nbsp; If Not InMapEditor Then Exit Sub<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Count = Map.EventCount<br>&nbsp; &nbsp; For i = 1 To Count<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).x = x And Map.Events(i).y = y Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> </span><span class="kwd">delete</span><span class="pln"> it<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ClearEvent</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lowIndex </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">For</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' not found anything<br>&nbsp; &nbsp; If lowIndex = 0 Then Exit Sub<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="pln"> move everything down an index<br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> lowIndex </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CopyEvent</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> i<br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' delete the last index<br>&nbsp; &nbsp; ClearEvent Count<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="kwd">set</span><span class="pln"> the </span><span class="kwd">new</span><span class="pln"> count<br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">AddEvent</span><span class="pun">(</span><span class="pln">x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Optional</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> cancelLoad </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Boolean</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> pageCount </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' make sure there'</span><span class="pln">s </span><span class="kwd">not</span><span class="pln"> already an </span><span class="kwd">event</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' already an event - edit it<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Not cancelLoad Then EventEditorInit i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; '</span><span class="pln"> increment count<br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Count</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Count</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' set the new event<br>&nbsp; &nbsp; Map.Events(Count).x = x<br>&nbsp; &nbsp; Map.Events(Count).y = y<br>&nbsp; &nbsp; '</span><span class="pln"> give it a </span><span class="kwd">new</span><span class="pln"> page<br>&nbsp; &nbsp; pageCount </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">Count</span><span class="pun">).</span><span class="pln">pageCount </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">Count</span><span class="pun">).</span><span class="pln">pageCount </span><span class="pun">=</span><span class="pln"> pageCount<br>&nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">Count</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">pageCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' load the editor<br>&nbsp; &nbsp; If Not cancelLoad Then EventEditorInit Count<br>End Sub<br><br>Sub ClearEvent(eventNum As Long)<br>&nbsp; &nbsp; Call ZeroMemory(ByVal VarPtr(Map.Events(eventNum)), LenB(Map.Events(eventNum)))<br>End Sub<br><br>Sub CopyEvent(original As Long, newone As Long)<br>&nbsp; &nbsp; CopyMemory ByVal VarPtr(Map.Events(newone)), ByVal VarPtr(Map.Events(original)), LenB(Map.Events(original))<br>End Sub<br><br>Sub EventEditorInit(eventNum As Long)<br>Dim i As Long<br>&nbsp; &nbsp; EditorEvent = eventNum<br>&nbsp; &nbsp; '</span><span class="pln"> copy the </span><span class="kwd">event</span><span class="pln"> data to the temp </span><span class="kwd">event</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">'CopyMemory ByVal VarPtr(tmpEvent), ByVal VarPtr(Map.Events(eventNum)), LenB(Map.Events(eventNum))<br>&nbsp; &nbsp; tmpEvent = Map.Events(eventNum)<br>&nbsp; &nbsp; '</span><span class="pln"> populate form<br>&nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> frmEditor_Events<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' set the tabs<br>&nbsp; &nbsp; &nbsp; &nbsp; .tabPages.Tabs.Clear<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To tmpEvent.pageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .tabPages.Tabs.Add , , str(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> items<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbHasItem</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbHasItem</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"None"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_ITEMS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbHasItem</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Item</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' variables<br>&nbsp; &nbsp; &nbsp; &nbsp; .cmbPlayerVar.Clear<br>&nbsp; &nbsp; &nbsp; &nbsp; .cmbPlayerVar.AddItem "None"<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To MAX_VARIABLES<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .cmbPlayerVar.AddItem i &amp; ". " &amp; Variables(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> variables<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbPlayerSwitch</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbPlayerSwitch</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"None"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmbPlayerSwitch</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' name<br>&nbsp; &nbsp; &nbsp; &nbsp; .txtName.text = tmpEvent.Name<br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> enable </span><span class="kwd">delete</span><span class="pln"> button<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="pln">pageCount </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmdDeletePage</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmdDeletePage</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">cmdPastePage</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' Load page 1 to start off with<br>&nbsp; &nbsp; &nbsp; &nbsp; curPageNum = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; EventEditorLoadPage curPageNum<br>&nbsp; &nbsp; End With<br>&nbsp; &nbsp; '</span><span class="pln"> show the editor<br>&nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="typ">Show</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EventEditorLoadPage</span><span class="pun">(</span><span class="pln">pageNum </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' populate form<br>&nbsp; &nbsp; With tmpEvent.Pages(pageNum)<br>&nbsp; &nbsp; &nbsp; &nbsp; GraphicSelX = .GraphicX<br>&nbsp; &nbsp; &nbsp; &nbsp; GraphicSelY = .GraphicY<br>&nbsp; &nbsp; &nbsp; &nbsp; GraphicSelX2 = .GraphicX2<br>&nbsp; &nbsp; &nbsp; &nbsp; GraphicSelY2 = .GraphicY2<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbGraphic.ListIndex = .GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbHasItem.ListIndex = .HasItemIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbMoveFreq.ListIndex = .MoveFreq<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbMoveSpeed.ListIndex = .MoveSpeed<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbMoveType.ListIndex = .MoveType<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVar.ListIndex = .VariableIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitch.ListIndex = .SwitchIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitch.ListIndex = .SelfSwitchIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitchCompare.ListIndex = .SelfSwitchCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitchCompare.ListIndex = .SwitchCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVarCompare.ListIndex = .VariableCompare<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkGlobal.Value = tmpEvent.Global<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbTrigger.ListIndex = .Trigger<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkDirFix.Value = .DirFix<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkHasItem.Value = .chkHasItem<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkPlayerVar.Value = .chkVariable<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkPlayerSwitch.Value = .chkSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkSelfSwitch.Value = .chkSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkWalkAnim.Value = .WalkAnim<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkWalkThrough.Value = .WalkThrough<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.chkShowName.Value = .ShowName<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.txtPlayerVariable = .VariableCondition<br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.scrlGraphic.Value = .Graphic<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; If .chkHasItem = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbHasItem.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbHasItem.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; If .chkSelfSwitch = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitch.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitchCompare.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitch.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbSelfSwitchCompare.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; If .chkSwitch = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitch.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitchCompare.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitch.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerSwitchCompare.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; If .chkVariable = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVar.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.txtPlayerVariable.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVarCompare.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVar.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.txtPlayerVariable.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPlayerVarCompare.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.cmbMoveType.ListIndex = 2 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmdMoveRoute.Enabled = True<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmdMoveRoute.Enabled = False<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.cmbPositioning.ListIndex = .Position<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> show the commands<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventListCommands</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842339">
				<ul class="ipsList_inline">
					<li id="like_post_842339" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842339&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842339" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842339&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842339" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842339', { domLikeStripId: 'like_post_842339', app: 'forums', type: 'pid', typeid: '842339' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842339" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842339" class="_ips_trigger_quote ipsButton_secondary" pid="842339" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842339" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842339" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842339&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842339);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842339') )
	{
		$('multiq_842339').show();
	}
	
	if( $('toggle_post_842339') )
	{
		$('toggle_post_842339').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842339] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842340-->

<div class="post_block hentry clear clearfix " id="post_id_842340">
		<a id="entry842340"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842340" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #6">
					
					#6
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_9" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T18:57:55+00:00">08 August 2012 - 06:57 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->add also the the bottom of <strong class="bbc">modgameeditors</strong><br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EventEditorOK</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' copy the event data from the temp event<br>&nbsp; &nbsp; '</span><span class="typ">CopyMemory</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">VarPtr</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">EditorEvent</span><span class="pun">)),</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">VarPtr</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">),</span><span class="pln"> </span><span class="typ">LenB</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="typ">EditorEvent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent<br>&nbsp; &nbsp; </span><span class="str">' unload the form<br>&nbsp; &nbsp; Unload frmEditor_Events<br>End Sub<br><br>Public Sub EventListCommands()<br>Dim i As Long, curlist As Long, oldI As Long, x As Long, indent As String, listleftoff() As Long, conditionalstage() As Long<br>&nbsp; &nbsp; frmEditor_Events.lstCommands.Clear<br>&nbsp; &nbsp; If tmpEvent.Pages(curPageNum).CommandListCount &gt; 0 Then<br>&nbsp; &nbsp; ReDim listleftoff(1 To tmpEvent.Pages(curPageNum).CommandListCount)<br>&nbsp; &nbsp; ReDim conditionalstage(1 To tmpEvent.Pages(curPageNum).CommandListCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="typ">Start</span><span class="pln"> </span><span class="typ">Up</span><span class="pln"> at </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"><br>newlist</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCondition </span><span class="typ">Or</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowChoices</span><span class="pun">)</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> i </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCondition </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] &gt;= "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] &lt;= "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] &gt; "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] &lt; "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] != "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Switch ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Switch ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Has Item ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Item</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Class Is ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Class</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player Knows Skill ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Spell</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is &gt;= "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is &lt;= "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is &gt; "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is &lt; "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Player's Level is NOT "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [A] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [B] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [C] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [D] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [A] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [B] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [C] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Conditional Branch: Self Switch [D] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indent </span><span class="pun">=</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" &nbsp; &nbsp; &nbsp; "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">CommandList</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Else"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">ElseCommandList</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"End Branch"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indent </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowChoices </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Show Choices - Prompt: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"..."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indent </span><span class="pun">=</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" &nbsp; &nbsp; &nbsp; "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"When ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"When ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"When ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="str">""</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"When ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text5</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GoTo</span><span class="pln"> newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" : "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Branch End"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; indent </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Len</span><span class="pun">(</span><span class="pln">indent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listleftoff</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; conditionalstage</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evAddText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Add Text - "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"... - Color: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">GetColorString</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" - Chat Type: Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Add Text - "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"... - Color: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">GetColorString</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" - Chat Type: Map"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Add Text - "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"... - Color: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">GetColorString</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" - Chat Type: Global"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Show Text - "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Mid</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"..."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerVar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Variable ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Switch ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == True"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Switch ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] == False"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [A] to ON"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [A] to OFF"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [B] to ON"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [B] to OFF"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [C] to ON"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [C] to OFF"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [D] to ON"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Self Switch [D] to OFF"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evExitProcess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Exit Event Processing"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeItems<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Item Amount of ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Item</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"] to "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Give Player "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Item</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"(s)"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Take "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Item</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"(s) from Player."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evRestoreHP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Restore Player HP"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evRestoreMP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Restore Player MP"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evLevelUp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Level Up Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeLevel<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Level to "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSkills<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Teach Player Skill ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Spell</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Remove Player Skill ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Spell</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeClass<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Class to "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Class</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSprite<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Sprite to "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Sex to Male."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Sex to Female."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangePK<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player PK to No."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player PK to Yes."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evWarpPlayer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Warp Player To Map: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">") while retaining direction."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Warp Player To Map: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">") facing upward."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Warp Player To Map: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">") facing downward."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Warp Player To Map: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">") facing left."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Warp Player To Map: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">") facing right."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Move Route for Event #"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Move Route for COULD NOT FIND EVENT!"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayAnimation<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Play Animation "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Animation</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" on Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Play Animation "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Animation</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" on Event #"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Play Animation "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Animation</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" on Tile("</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">")"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCustomScript<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Execute Custom Script Case: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Play BGM ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evFadeoutBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Fadeout BGM"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlaySound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842340">
				<ul class="ipsList_inline">
					<li id="like_post_842340" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842340&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842340" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842340&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842340" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842340', { domLikeStripId: 'like_post_842340', app: 'forums', type: 'pid', typeid: '842340' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842340" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842340" class="_ips_trigger_quote ipsButton_secondary" pid="842340" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842340" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842340" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842340&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842340);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842340') )
	{
		$('multiq_842340').show();
	}
	
	if( $('toggle_post_842340') )
	{
		$('toggle_post_842340').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842340] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842349-->

<div class="post_block hentry clear clearfix " id="post_id_842349">
		<a id="entry842349"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842349" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #7">
					
					#7
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_10" hovercard-ref="member" hovercard-id="47221" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/47221-vus/" title=""><span itemprop="name">Vus</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">Vus</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Anixia Online owner</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/47221-vus/" title="View Profile: Vus" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-47221.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#b27d60">Advanced Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member3.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			569 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">Czech Republic</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T20:06:08+00:00">08 August 2012 - 08:06 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->This can be nice thing for people using 2.0. Good job :)
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842349">
				<ul class="ipsList_inline">
					<li id="like_post_842349" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842349&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842349" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842349&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842349" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842349', { domLikeStripId: 'like_post_842349', app: 'forums', type: 'pid', typeid: '842349' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="47221">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 14:45:51 +0000--><a href="http://www.touchofdeathforums.com/smf2/index.php/topic,70408.0.html" class="bbc_url" title=""><img src="Event%20System%202.3%20into%202.0.php_files/anixialogo1.png" alt="Posted Image" class="bbc_img"></a>
</div>
				
				
				
			
				<ul id="postControlsNormal_842349" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842349" class="_ips_trigger_quote ipsButton_secondary" pid="842349" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842349" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842349" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842349&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842349);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842349') )
	{
		$('multiq_842349').show();
	}
	
	if( $('toggle_post_842349') )
	{
		$('toggle_post_842349').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842349] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842366-->

<div class="post_block hentry clear clearfix " id="post_id_842366">
		<a id="entry842366"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842366" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #8">
					
					#8
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_11" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:04:18+00:00">08 August 2012 - 09:04 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000--><strong class="bbc">add directly to the end of the other post so it should still be the end of modgameeditors</strong><br><pre class="prettyprint"><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Play Sound ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Text1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evStopSound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Stop Sound"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evOpenBank<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Open Bank"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evOpenShop<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Open Shop ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">CStr</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Shop</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetAccess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Set Player Access ["</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetAccess</span><span class="pun">.</span><span class="typ">List</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"]"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evGiveExp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> indent </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"@&gt;"</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"Give Player "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" Experience."</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">'Ghost<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = x - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If x = -1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim EventList(0)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve EventList(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; If curlist &gt; 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = x + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve EventList(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EventList(x).CommandList = curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EventList(x).CommandNum = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.lstCommands.AddItem indent &amp; "@&gt; "<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curlist = tmpEvent.Pages(curPageNum).CommandList(curlist).ParentList<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoTo newlist<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; frmEditor_Events.lstCommands.AddItem indent &amp; "@&gt; "<br>End Sub<br><br>Sub ListCommandAdd(s As String)<br>Static x As Long<br>&nbsp; &nbsp; frmEditor_Events.lstCommands.AddItem s<br>&nbsp; &nbsp; '</span><span class="pln"> scrollbar<br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">TextWidth</span><span class="pun">(</span><span class="pln">s </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" &nbsp;"</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp;x </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">TextWidth</span><span class="pun">(</span><span class="pln">s </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">" &nbsp;"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">ScaleMode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vbTwips </span><span class="typ">Then</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">/</span><span class="pln"> </span><span class="typ">Screen</span><span class="pun">.</span><span class="typ">TwipsPerPixelX</span><span class="pln"> </span><span class="str">' if twips change to pixels<br>&nbsp; &nbsp; &nbsp; SendMessageByNum frmEditor_Events.lstCommands.hWnd, LB_SETHORIZONTALEXTENT, x, 0<br>&nbsp; &nbsp; End If<br>End Sub<br><br>Sub AddCommand(Index As Long)<br>&nbsp; &nbsp; Dim curlist As Long, i As Long, x As Long, curslot As Long, p As Long, oldCommandList As CommandListRec<br>&nbsp; &nbsp; If tmpEvent.Pages(curPageNum).CommandListCount = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandListCount = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim tmpEvent.Pages(curPageNum).CommandList(1)<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If frmEditor_Events.lstCommands.ListIndex = frmEditor_Events.lstCommands.ListCount - 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; curlist = 1<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; curlist = EventList(frmEditor_Events.lstCommands.ListIndex).CommandList<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; If tmpEvent.Pages(curPageNum).CommandListCount = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandListCount = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim tmpEvent.Pages(curPageNum).CommandList(curlist)<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; oldCommandList = tmpEvent.Pages(curPageNum).CommandList(curlist)<br>&nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount + 1<br>&nbsp; &nbsp; p = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount<br>&nbsp; &nbsp; If p &lt;= 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(0)<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(1 To p)<br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).ParentList = oldCommandList.ParentList<br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount = p<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To p - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(i) = oldCommandList.Commands(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If frmEditor_Events.lstCommands.ListIndex = frmEditor_Events.lstCommands.ListCount - 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; curslot = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; i = EventList(frmEditor_Events.lstCommands.ListIndex).CommandNum<br>&nbsp; &nbsp; &nbsp; &nbsp; If i &lt; tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For x = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount - 1 To i Step -1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(x + 1) = tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curslot = EventList(frmEditor_Events.lstCommands.ListIndex).CommandNum<br>&nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curslot = tmpEvent.Pages(curPageNum).CommandList(curlist).CommandCount<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Select Case Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evAddText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text1 = frmEditor_Events.txtAddText_Text.text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlAddText_Colour.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optAddText_Map.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optAddText_Global.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optAddText_Player.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evCondition<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="typ">This</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> the part </span><span class="kwd">where</span><span class="pln"> the whole entire source goes to hell </span><span class="pun">:</span><span class="pln">D<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">ElseCommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">CommandList</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">ElseCommandList</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="str">'Player Var<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Condition = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data1 = frmEditor_Events.cmbCondition_PlayerVarIndex.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data2 = frmEditor_Events.cmbCondition_PlayerVarCompare.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data3 = Val(frmEditor_Events.txtCondition_PlayerVarCondition.text)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 1 '</span><span class="typ">Player</span><span class="pln"> </span><span class="typ">Switch</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondtion_PlayerSwitchCondition</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="str">'Has Item<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Condition = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data1 = frmEditor_Events.cmbCondition_HasItem.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 3 '</span><span class="typ">Class</span><span class="pln"> </span><span class="typ">Is</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_ClassIs</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="str">'Learnt Skill<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Condition = 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data1 = frmEditor_Events.cmbCondition_LearntSkill.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 5 '</span><span class="typ">Level</span><span class="pln"> </span><span class="typ">Is</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_LevelAmount</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LevelCompare</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="str">'Self Switch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Condition = 6<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data1 = frmEditor_Events.cmbCondition_SelfSwitch.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).ConditionalBranch.Data2 = frmEditor_Events.cmbCondition_SelfSwitchCondition.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evShowText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text1 = frmEditor_Events.txtShowText.text<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evShowChoices<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text1 = frmEditor_Events.txtChoicePrompt.text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text2 = frmEditor_Events.txtChoices(1).text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text3 = frmEditor_Events.txtChoices(2).text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text4 = frmEditor_Events.txtChoices(3).text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text5 = frmEditor_Events.txtChoices(4).text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandListCount = tmpEvent.Pages(curPageNum).CommandListCount + 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve tmpEvent.Pages(curPageNum).CommandList(tmpEvent.Pages(curPageNum).CommandListCount)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = tmpEvent.Pages(curPageNum).CommandListCount - 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = tmpEvent.Pages(curPageNum).CommandListCount - 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = tmpEvent.Pages(curPageNum).CommandListCount - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data4 = tmpEvent.Pages(curPageNum).CommandListCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(tmpEvent.Pages(curPageNum).CommandListCount - 3).ParentList = curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(tmpEvent.Pages(curPageNum).CommandListCount - 2).ParentList = curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(tmpEvent.Pages(curPageNum).CommandListCount - 1).ParentList = curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(tmpEvent.Pages(curPageNum).CommandListCount).ParentList = curlist<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evPlayerVar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbVariable.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = Val(frmEditor_Events.txtVariable.text)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evPlayerSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbSwitch.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = frmEditor_Events.cmbPlayerSwitchSet.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbSetSelfSwitch.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = frmEditor_Events.cmbSetSelfSwitchTo.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evExitProcess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeItems<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbChangeItemIndex.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optChangeItemSet.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optChangeItemAdd.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optChangeItemRemove.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = Val(frmEditor_Events.txtChangeItemsAmount.text)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evRestoreHP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evRestoreMP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evLevelUp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeLevel<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlChangeLevel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeSkills<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbChangeSkills.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optChangeSkillsAdd.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optChangeSkillsRemove.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeClass<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbChangeClass.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeSprite<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlChangeSprite.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangeSex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optChangeSexMale.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optChangeSexFemale.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evChangePK<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optChangePKYes.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optChangePKNo.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evWarpPlayer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlWPMap.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = frmEditor_Events.scrlWPX.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = frmEditor_Events.scrlWPY.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data4 = frmEditor_Events.cmbWarpPlayerDir.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evSetMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = ListOfEvents(frmEditor_Events.cmbEvent.ListIndex)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = frmEditor_Events.chkIgnoreMove.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = frmEditor_Events.chkRepeatRoute.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).MoveRouteCount = TempMoveRouteCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).MoveRoute = TempMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evPlayAnimation<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbPlayAnim.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.optPlayAnimPlayer.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optPlayAnimEvent.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = frmEditor_Events.cmbPlayAnimEvent.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf frmEditor_Events.optPlayAnimTile.Value = True Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data2 = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data3 = frmEditor_Events.scrlPlayAnimTileX.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data4 = frmEditor_Events.scrlPlayAnimTileY.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evCustomScript<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlCustomScript.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evPlayBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text1 = musicCache(frmEditor_Events.cmbPlayBGM.ListIndex + 1)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evFadeoutBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evPlaySound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Text1 = soundCache(frmEditor_Events.cmbPlaySound.ListIndex + 1)<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evStopSound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evOpenBank<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evOpenShop<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbOpenShop.ListIndex + 1<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evSetAccess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.cmbSetAccess.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; Case EventType.evGiveExp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Index = Index<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent.Pages(curPageNum).CommandList(curlist).Commands(curslot).Data1 = frmEditor_Events.scrlGiveExp.Value<br>&nbsp; &nbsp; End Select<br>&nbsp; &nbsp; EventListCommands<br>End Sub</span></pre><br>and more for the bottom of modgameeditors<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EditEventCommand</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curlist </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curslot </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">UBound</span><span class="pun">(</span><span class="typ">EventList</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br>&nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"><br>&nbsp; &nbsp; curslot </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evAddText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtAddText_Text</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlAddText_Colour</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Player</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Map</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Global</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraAddText</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCondition<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraConditionalBranch</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="typ">ClearConditionFrame</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="pln">tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarIndex</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarCompare</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_PlayerVarCondition</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarIndex</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarCompare</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_PlayerVarCondition</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerSwitch</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondtion_PlayerSwitchCondition</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondtion_PlayerSwitchCondition</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_HasItem</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_HasItem</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_ClassIs</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_ClassIs</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LearntSkill</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LearntSkill</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LevelCompare</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_LevelAmount</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_LevelAmount</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LevelCompare</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitch</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitchCondition</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitchCondition</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtShowText</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraShowText</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowChoices<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoicePrompt</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">2</span><span class="pun">).</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">3</span><span class="pun">).</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">4</span><span class="pun">).</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraShowChoices</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerVar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbVariable</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtVariable</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraPlayerVar</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayerSwitchSet</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraPlayerSwitch</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetSelfSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetSelfSwitchTo</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraSelfSwitch</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeItems<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeItemIndex</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemSet</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemAdd</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemRemove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842366">
				<ul class="ipsList_inline">
					<li id="like_post_842366" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842366&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842366" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842366&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842366" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842366', { domLikeStripId: 'like_post_842366', app: 'forums', type: 'pid', typeid: '842366' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842366" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842366" class="_ips_trigger_quote ipsButton_secondary" pid="842366" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842366" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842366" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842366&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842366);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842366') )
	{
		$('multiq_842366').show();
	}
	
	if( $('toggle_post_842366') )
	{
		$('toggle_post_842366').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842366] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842368-->

<div class="post_block hentry clear clearfix " id="post_id_842368">
		<a id="entry842368"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842368" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #9">
					
					#9
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_12" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:06:47+00:00">08 August 2012 - 09:06 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000--><strong class="bbc">and even more for modgameeditors at the end.</strong><br><pre class="prettyprint"><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChangeItemsAmount</span><span class="pun">.</span><span class="pln">text </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeItems</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeLevel<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlChangeLevel</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeLevel</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSkills<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeSkills</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSkillsAdd</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSkillsRemove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeSkills</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeClass<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeClass</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeClass</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSprite<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlChangeSprite</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeSprite</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSexMale</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSexFemale</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangeSex</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangePK<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangePKYes</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangePKNo</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraChangePK</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evWarpPlayer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPMap</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPX</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPY</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbWarpPlayerDir</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraWarpPlayer</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraMoveRoute</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">ListOfEvents</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ListOfEvents</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EditorEvent</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"This Event"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">Enabled</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="typ">EditorEvent</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ListOfEvents</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">IsMoveRouteCommand</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">chkIgnoreMove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">chkRepeatRoute</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempMoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">TempMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">TempMoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">TempMoveRoute</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Up"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Down"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Left"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Right"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Randomly"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Towards Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">7</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Move Away From Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">8</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Step Forward"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">9</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Step Back"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">10</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Wait 100ms"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">11</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Wait 500ms"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">12</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Wait 1000ms"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">13</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Up"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">14</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Down"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">15</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Left"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">16</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Right"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">17</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn 90 Degrees To the Right"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">18</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn 90 Degrees To the Left"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">19</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Around 180 Degrees"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">20</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Randomly"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">21</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Towards Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">22</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Away from Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">23</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed 8x Slower"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">24</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed 4x Slower"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">25</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed 2x Slower"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">26</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed to Normal"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">27</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed 2x Faster"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">28</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Speed 4x Faster"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">29</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Frequency Lowest"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">30</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Frequency Lower"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">31</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Frequency Normal"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">32</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Frequency Higher"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">33</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Frequency Highest"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">34</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn On Walking Animation"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">35</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Off Walking Animation"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">36</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn On Fixed Direction"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">37</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Off Fixed Direction"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">38</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn On Walk Through"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">39</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Turn Off Walk Through"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">40</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Position Below Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">41</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Position at Player Level"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">42</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Position Above Player"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">43</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lstMoveRoute</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> </span><span class="str">"Set Graphic"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraMoveRoute</span><span class="pun">.</span><span class="pln">width </span><span class="pun">=</span><span class="pln"> </span><span class="lit">841</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraMoveRoute</span><span class="pun">.</span><span class="pln">height </span><span class="pun">=</span><span class="pln"> </span><span class="lit">609</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraMoveRoute</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayAnimation<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lblPlayAnimX</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lblPlayAnimY</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileX</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileY</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnim</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">AddItem</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">". "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">Trim$</span><span class="pun">(</span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Name</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimPlayer</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimEvent</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimTile</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileX</span><span class="pun">.</span><span class="typ">Max</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MaxX</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileY</span><span class="pun">.</span><span class="typ">Max</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MaxY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileX</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileY</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraPlayAnimation</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCustomScript<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlCustomScript</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCustomScript</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">UBound</span><span class="pun">(</span><span class="pln">musicCache</span><span class="pun">())</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> musicCache</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayBGM</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraPlayBGM</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlaySound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">UBound</span><span class="pun">(</span><span class="pln">soundCache</span><span class="pun">())</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> soundCache</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlaySound</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraPlaySound</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evOpenShop<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbOpenShop</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraOpenShop</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetAccess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetAccess</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraSetAccess</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evGiveExp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isEdit </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGiveExp</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">lblGiveExp</span><span class="pun">.</span><span class="typ">Caption</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Give Exp: "</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraDialogue</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraGiveExp</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">fraCommands</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; <br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">DeleteEventCommand</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curlist </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curslot </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> p </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> oldCommandList </span><span class="typ">As</span><span class="pln"> </span><span class="typ">CommandListRec</span><span class="pln"><br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"><br>&nbsp; &nbsp; curslot </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; p </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> p </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oldCommandList </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> oldCommandList</span><span class="pun">.</span><span class="typ">ParentList</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&lt;&gt;</span><span class="pln"> curslot </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> oldCommandList</span><span class="pun">.</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; p </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; oldCommandList </span><span class="pun">=</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> p </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> oldCommandList</span><span class="pun">.</span><span class="typ">ParentList</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> p </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&lt;&gt;</span><span class="pln"> curslot </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> oldCommandList</span><span class="pun">.</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">EventListCommands</span><span class="pln"><br>&nbsp; &nbsp; <br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">ClearEventCommands</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">EventListCommands</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EditCommand</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curlist </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> curslot </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; i </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">lstCommands</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">UBound</span><span class="pun">(</span><span class="typ">EventList</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br>&nbsp; &nbsp; curlist </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pln"><br>&nbsp; &nbsp; curslot </span><span class="pun">=</span><span class="pln"> </span><span class="typ">EventList</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">CommandNum</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curlist </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> curslot </span><span class="pun">&gt;</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">Select</span><span class="pln"> </span><span class="typ">Case</span><span class="pln"> tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evAddText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtAddText_Text</span><span class="pun">.</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlAddText_Colour</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Player</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Map</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optAddText_Global</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCondition<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">0</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarIndex</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerVarCompare</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_PlayerVarCondition</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_PlayerSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondtion_PlayerSwitchCondition</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">2</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_HasItem</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">3</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_ClassIs</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">4</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LearntSkill</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">5</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">txtCondition_LevelAmount</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_LevelCompare</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optCondition_Index</span><span class="pun">(</span><span class="lit">6</span><span class="pun">).</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">6</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbCondition_SelfSwitchCondition</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowText<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtShowText</span><span class="pun">.</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evShowChoices<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoicePrompt</span><span class="pun">.</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">1</span><span class="pun">).</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">2</span><span class="pun">).</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">3</span><span class="pun">).</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChoices</span><span class="pun">(</span><span class="lit">4</span><span class="pun">).</span><span class="pln">text<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerVar<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbVariable</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">txtVariable</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayerSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayerSwitchSet</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetSelfSwitch</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetSelfSwitchTo</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeItems<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeItemIndex</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemSet</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemAdd</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeItemRemove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Val</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">txtChangeItemsAmount</span><span class="pun">.</span><span class="pln">text</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSelfSwitch<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlChangeLevel</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSkills<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeSkills</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSkillsAdd</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSkillsRemove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeClass<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbChangeClass</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSprite<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlChangeSprite</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangeSex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSexMale</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangeSexFemale</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evChangePK<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangePKYes</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optChangePKNo</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evWarpPlayer<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPMap</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPX</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlWPY</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbWarpPlayerDir</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetMoveRoute<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ListOfEvents</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">chkIgnoreMove</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">chkRepeatRoute</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempMoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">TempMoveRoute</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayAnimation<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnim</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimPlayer</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimEvent</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayAnimEvent</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ElseIf</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">optPlayAnimTile</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileX</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlPlayAnimTileY</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evCustomScript<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlCustomScript</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlayBGM<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> musicCache</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlayBGM</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evPlaySound<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> soundCache</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbPlaySound</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evOpenShop<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbOpenShop</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evSetAccess<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">cmbSetAccess</span><span class="pun">.</span><span class="typ">ListIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="typ">EventType</span><span class="pun">.</span><span class="pln">evGiveExp<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmpEvent</span><span class="pun">.</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">curPageNum</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">curlist</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">curslot</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGiveExp</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">Select</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">EventListCommands</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br><strong class="bbc">and more</strong><br><pre class="prettyprint"><span class="typ">Sub</span><span class="pln"> </span><span class="typ">RequestSwitchesAndVariables</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br></span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">CRequestSwitchesAndVariables</span><span class="pln"><br></span><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pln"><br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">SendSwitchesAndVariables</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; </span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">New</span><span class="pln"> clsBuffer<br>&nbsp; &nbsp; </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteLong</span><span class="pln"> </span><span class="typ">CSwitchesAndVariables</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_SWITCHES<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteString</span><span class="pln"> </span><span class="typ">Switches</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_VARIABLES<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">WriteString</span><span class="pln"> </span><span class="typ">Variables</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SendData</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ToArray</span><span class="pln"><br></span><span class="typ">Set</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842368">
				<ul class="ipsList_inline">
					<li id="like_post_842368" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842368&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842368" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842368&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842368" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842368', { domLikeStripId: 'like_post_842368', app: 'forums', type: 'pid', typeid: '842368' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842368" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842368" class="_ips_trigger_quote ipsButton_secondary" pid="842368" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842368" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842368" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842368&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842368);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842368') )
	{
		$('multiq_842368').show();
	}
	
	if( $('toggle_post_842368') )
	{
		$('toggle_post_842368').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842368] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842371-->

<div class="post_block hentry clear clearfix " id="post_id_842371">
		<a id="entry842371"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842371" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #10">
					
					#10
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_13" hovercard-ref="member" hovercard-id="76523" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/76523-%e2%98%ad-general-pony-%e2%98%ad/" title=""><span itemprop="name">☭ General Pony ☭</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">☭ General Pony ☭</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Freaking Pony Fool!</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/76523-%e2%98%ad-general-pony-%e2%98%ad/" title="View Profile: ☭ General Pony ☭" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-76523.png" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color: orange;">Donator</span>
		</li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/donator.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			909 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:07:52+00:00">08 August 2012 - 09:07 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->You probably should of used spoilers.
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842371">
				<ul class="ipsList_inline">
					<li id="like_post_842371" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842371&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842371" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842371&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842371" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842371', { domLikeStripId: 'like_post_842371', app: 'forums', type: 'pid', typeid: '842371' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="76523">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 14:19:31 +0000--><del class="bbc"><strong class="bbc">Need programming work done in your project? Check out my service thread <a href="http://www.touchofdeathforums.com/community/index.php?/topic/128492-decent-programmer-looking-for-work/" class="bbc_url" title="">Here</a>.</strong></del><br>
<br>
<strong class="bbc">Closed, i really don't have the time with school starting back up. If i was going to work on something for you i apologize.</strong>
</div>
				
				
				
			
				<ul id="postControlsNormal_842371" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842371" class="_ips_trigger_quote ipsButton_secondary" pid="842371" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842371" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842371" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842371&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842371);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842371') )
	{
		$('multiq_842371').show();
	}
	
	if( $('toggle_post_842371') )
	{
		$('toggle_post_842371').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842371] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842374-->

<div class="post_block hentry clear clearfix " id="post_id_842374">
		<a id="entry842374"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842374" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #11">
					
					#11
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_14" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:12:32+00:00">08 August 2012 - 09:12 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->in moddirectdraw7 search for <strong class="bbc">Public DDS_Bars As DirectDrawSurface7</strong><br>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> DDS_Event </span><span class="typ">As</span><span class="pln"> </span><span class="typ">DirectDrawSurface7</span></pre><br>search for <strong class="bbc">Public DDSD_Bars As DDSURFACEDESC2</strong><br>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> DDSD_Event </span><span class="typ">As</span><span class="pln"> DDSURFACEDESC2</span></pre><br>search for <strong class="bbc">If FileExist(App.Path &amp; "\data files\graphics\bars.bmp", True) Then Call InitDDSurf("bars", DDSD_Bars, DDS_Bars)</strong><br>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">FileExist</span><span class="pun">(</span><span class="typ">App</span><span class="pun">.</span><span class="typ">Path</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">"\data files\graphics\event.bmp"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">InitDDSurf</span><span class="pun">(</span><span class="str">"event"</span><span class="pun">,</span><span class="pln"> DDSD_Event</span><span class="pun">,</span><span class="pln"> DDS_Event</span><span class="pun">)</span></pre><br>search for <strong class="bbc">Public Sub Render_Graphics()</strong><br>then below<br><pre class="prettyprint"><span class="str">' Blit out the items<br>&nbsp; &nbsp; If NumItems &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To MAX_MAP_ITEMS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If MapItem(i).num &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call BltItem(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If</span></pre>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Position</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BltEvent</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre><br>search for <strong class="bbc">' Y-based render. Renders Players, Npcs and Resources based on Y-axis.</strong><br>below<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MaxY</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">NumCharacters</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span></pre>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Position</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BltEvent</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>then below<br><pre class="prettyprint"><span class="str">' blit out upper tiles<br>&nbsp; &nbsp; If NumTileSets &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; For x = TileView.Left To TileView.Right<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; For y = TileView.top To TileView.Bottom<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If IsValidMapPoint(x, y) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call BltMapFringeTile(x, y)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If</span></pre>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Position</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BltEvent</span><span class="pln"> i<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>then just below<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Npc_HighIndex</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">num </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">CurX</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="typ">And</span><span class="pln"> </span><span class="typ">CurY</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">MapNpc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> myTargetType </span><span class="pun">=</span><span class="pln"> TARGET_TYPE_NPC </span><span class="typ">And</span><span class="pln"> myTarget </span><span class="pun">=</span><span class="pln"> i </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">' dont render lol<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BltHover TARGET_TYPE_NPC, i, (MapNpc(i).x * 32) + MapNpc(i).XOffset, (MapNpc(i).y * 32) + MapNpc(i).YOffset<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; Next</span></pre>add<br><pre class="prettyprint"><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="typ">Visible</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">EditorEvent_BltGraphic</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br></span><span class="typ">If</span><span class="pln"> </span><span class="typ">InMapEditor</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Map</span><span class="pun">.</span><span class="pln">optEvent</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BltEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span></pre>then below<br><pre class="prettyprint"><span class="str">' draw player names<br>&nbsp; &nbsp; For i = 1 To Player_HighIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; If IsPlaying(i) And GetPlayerMap(i) = GetPlayerMap(MyIndex) Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call DrawPlayerName(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; Next</span></pre>add<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Visible</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">ShowName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">DrawEventName</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre><br>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842374">
				<ul class="ipsList_inline">
					<li id="like_post_842374" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842374&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842374" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842374&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842374" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842374', { domLikeStripId: 'like_post_842374', app: 'forums', type: 'pid', typeid: '842374' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842374" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842374" class="_ips_trigger_quote ipsButton_secondary" pid="842374" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842374" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842374" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842374&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842374);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842374') )
	{
		$('multiq_842374').show();
	}
	
	if( $('toggle_post_842374') )
	{
		$('toggle_post_842374').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842374] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842375-->

<div class="post_block hentry clear clearfix " id="post_id_842375">
		<a id="entry842375"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842375" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #12">
					
					#12
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_15" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:12:58+00:00">08 August 2012 - 09:12 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->at the bottom of <strong class="bbc">moddirectdraw7</strong> add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">BltEvents</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> sRECT </span><span class="typ">As</span><span class="pln"> </span><span class="typ">DxVBLib</span><span class="pun">.</span><span class="pln">RECT<br></span><span class="typ">Dim</span><span class="pln"> width </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> height </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If Map.EventCount &lt;= 0 Then Exit Sub<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 1 To Map.EventCount<br>&nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).pageCount &lt;= 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GoTo nextevent<br>&nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; width = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; height = 32<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; x = Map.Events(i).x * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; y = Map.Events(i).y * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; x = ConvertMapX(x)<br>&nbsp; &nbsp; &nbsp; &nbsp; y = ConvertMapY(y)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="pln"> clipping<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> sRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">top </span><span class="pun">=</span><span class="pln"> </span><span class="pun">.</span><span class="pln">top </span><span class="pun">-</span><span class="pln"> y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> sRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Left</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">.</span><span class="typ">Left</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> height </span><span class="pun">&gt;</span><span class="pln"> DDSD_BackBuffer</span><span class="pun">.</span><span class="pln">lHeight </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT</span><span class="pun">.</span><span class="typ">Bottom</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sRECT</span><span class="pun">.</span><span class="typ">Bottom</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> height </span><span class="pun">-</span><span class="pln"> DDSD_BackBuffer</span><span class="pun">.</span><span class="pln">lHeight</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> width </span><span class="pun">&gt;</span><span class="pln"> DDSD_BackBuffer</span><span class="pun">.</span><span class="pln">lWidth </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT</span><span class="pun">.</span><span class="typ">Right</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sRECT</span><span class="pun">.</span><span class="typ">Right</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> width </span><span class="pun">-</span><span class="pln"> DDSD_BackBuffer</span><span class="pun">.</span><span class="pln">lWidth</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageCount </span><span class="typ">Then</span><span class="pln"> </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">' /clipping<br>&nbsp; &nbsp; &nbsp; &nbsp; Select Case Map.Events(i).Pages(1).GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).Pages(1).Graphic &gt; 0 And Map.Events(i).Pages(1).Graphic &lt;= NumCharacters Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CharacterTimer(Map.Events(i).Pages(1).Graphic) = GetTickCount + SurfaceTimerMax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Character(Map.Events(i).Pages(1).Graphic) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("Characters\" &amp; Map.Events(i).Pages(1).Graphic, DDSD_Character(Map.Events(i).Pages(1).Graphic), DDS_Character(Map.Events(i).Pages(1).Graphic))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = (Map.Events(i).Pages(1).GraphicY * (DDSD_Character(Map.Events(i).Pages(1).Graphic).lHeight / 4))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = (Map.Events(i).Pages(1).GraphicX * (DDSD_Character(Map.Events(i).Pages(1).Graphic).lWidth / 4))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Character(Map.Events(i).Pages(1).Graphic), sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.Events(i).Pages(1).Graphic &gt; 0 And Map.Events(i).Pages(1).Graphic &lt; NumTileSets Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = Map.Events(i).Pages(1).GraphicY * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = Map.Events(i).Pages(1).GraphicX * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Tileset(Map.Events(i).Pages(1).Graphic), sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(x, y, DDS_Event, sRECT, DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; End Select<br>nextevent:<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"BltHover"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modDirectDraw7"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">EditorEvent_BltGraphic</span><span class="pun">()</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> sRECT </span><span class="typ">As</span><span class="pln"> </span><span class="typ">DxVBLib</span><span class="pun">.</span><span class="pln">RECT<br></span><span class="typ">Dim</span><span class="pln"> dRECT </span><span class="typ">As</span><span class="pln"> </span><span class="typ">DxVBLib</span><span class="pun">.</span><span class="pln">RECT<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br><br>&nbsp; &nbsp; If frmEditor_Events.picGraphicSel.Visible Then<br>&nbsp; &nbsp; &nbsp; &nbsp; Select Case frmEditor_Events.cmbGraphic.ListIndex<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '</span><span class="kwd">None</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events</span><span class="pun">.</span><span class="pln">picGraphicSel</span><span class="pun">.</span><span class="typ">Cls</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Case</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGraphic</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">And</span><span class="pln"> frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGraphic</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="typ">NumCharacters</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CharacterTimer</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGraphic</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetTickCount</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">SurfaceTimerMax</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> DDS_Character</span><span class="pun">(</span><span class="pln">frmEditor_Events</span><span class="pun">.</span><span class="pln">scrlGraphic</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Is</span><span class="pln"> </span><span class="typ">Nothing</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Call</span><span class="pln"> </span><span class="typ">InitDDSurf</span><span class="pun">(</span><span class="str">"Characters\" &amp; frmEditor_Events.scrlGraphic.Value, DDSD_Character(frmEditor_Events.scrlGraphic.Value), DDS_Character(frmEditor_Events.scrlGraphic.Value))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDSD_Character(frmEditor_Events.scrlGraphic.Value).lWidth &gt; 800 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = frmEditor_Events.hScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lWidth - sRECT.Left)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = DDSD_Character(frmEditor_Events.scrlGraphic.Value).lWidth<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDSD_Character(frmEditor_Events.scrlGraphic.Value).lHeight &gt; 512 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = frmEditor_Events.hScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lHeight - sRECT.top)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = DDSD_Character(frmEditor_Events.scrlGraphic.Value).lHeight<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With dRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Bottom = sRECT.Bottom - sRECT.top<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Right = sRECT.Right - sRECT.Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltToDC(DDS_Character(frmEditor_Events.scrlGraphic.Value), sRECT, dRECT, frmEditor_Events.picGraphicSel)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GraphicSelX &lt;= 3 And GraphicSelY &lt;= 3 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.Left = GraphicSelX * (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lWidth / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.width = (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lWidth / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.top = GraphicSelY * (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lHeight / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.height = (DDSD_Character(frmEditor_Events.scrlGraphic.Value).lHeight / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GraphicSelX = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GraphicSelY = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.picGraphicSel.Cls<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If frmEditor_Events.scrlGraphic.Value &gt; 0 And frmEditor_Events.scrlGraphic.Value &lt;= NumTileSets Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Tileset(frmEditor_Events.scrlGraphic.Value) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="typ">Tilesets</span><span class="pun">\</span><span class="str">" &amp; frmEditor_Events.scrlGraphic.Value, DDSD_Tileset(frmEditor_Events.scrlGraphic.Value), DDS_Tileset(frmEditor_Events.scrlGraphic.Value))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDSD_Tileset(frmEditor_Events.scrlGraphic.Value).lWidth &gt; 800 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = frmEditor_Events.hScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + 800<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = DDSD_Tileset(frmEditor_Events.scrlGraphic.Value).lWidth<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = frmEditor_Events.hScrlGraphicSel.Value = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDSD_Tileset(frmEditor_Events.scrlGraphic.Value).lHeight &gt; 512 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = frmEditor_Events.vScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + 512<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = DDSD_Tileset(frmEditor_Events.scrlGraphic.Value).lHeight<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.vScrlGraphicSel.Value = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With dRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .top = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Bottom = sRECT.Bottom - sRECT.top<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Left = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Right = sRECT.Right - sRECT.Left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltToDC(DDS_Tileset(frmEditor_Events.scrlGraphic.Value), sRECT, dRECT, frmEditor_Events.picGraphicSel)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Now we draw the selection square.. tad bit harder....<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Stretched or not....<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If GraphicSelX2 &gt; 0 Or GraphicSelY2 &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.top = (GraphicSelY * 32) - frmEditor_Events.vScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.Left = (GraphicSelX * 32) - frmEditor_Events.hScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.width = (GraphicSelX2 - GraphicSelX) * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.height = (GraphicSelY2 - GraphicSelY) * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.top = (GraphicSelY * 32) - frmEditor_Events.vScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.Left = (GraphicSelX * 32) - frmEditor_Events.hScrlGraphicSel.Value<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.width = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.shpLoc.height = 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.picGraphicSel.Cls<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; Select Case tmpEvent.Pages(curPageNum).GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmEditor_Events.picGraphic.Cls<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If tmpEvent.Pages(curPageNum).Graphic &gt; 0 And tmpEvent.Pages(curPageNum).Graphic &lt;= NumCharacters Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = tmpEvent.Pages(curPageNum).GraphicY * (DDSD_Character(tmpEvent.Pages(curPageNum).Graphic).lHeight / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = tmpEvent.Pages(curPageNum).GraphicX * (DDSD_Character(tmpEvent.Pages(curPageNum).Graphic).lWidth / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + (DDSD_Character(tmpEvent.Pages(curPageNum).Graphic).lHeight / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + (DDSD_Character(tmpEvent.Pages(curPageNum).Graphic).lWidth / 4)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With dRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.top = (193 / 2) - ((sRECT.Bottom - sRECT.top) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Bottom = dRECT.top + (sRECT.Bottom - sRECT.top)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Left = (121 / 2) - ((sRECT.Right - sRECT.Left) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Right = dRECT.Left + (sRECT.Right - sRECT.Left)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Character(frmEditor_Events.scrlGraphic.Value) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="typ">Characters</span><span class="pun">\</span><span class="str">" &amp; frmEditor_Events.scrlGraphic.Value, DDSD_Character(frmEditor_Events.scrlGraphic.Value), DDS_Character(frmEditor_Events.scrlGraphic.Value))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltToDC(DDS_Character(frmEditor_Events.scrlGraphic.Value), sRECT, dRECT, frmEditor_Events.picGraphic)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If tmpEvent.Pages(curPageNum).Graphic &gt; 0 And tmpEvent.Pages(curPageNum).Graphic &lt;= NumTileSets Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If tmpEvent.Pages(curPageNum).GraphicX2 = 0 Or tmpEvent.Pages(curPageNum).GraphicY2 = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = tmpEvent.Pages(curPageNum).GraphicY * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = tmpEvent.Pages(curPageNum).GraphicX * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With dRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.top = (193 / 2) - ((sRECT.Bottom - sRECT.top) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Bottom = dRECT.top + (sRECT.Bottom - sRECT.top)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Left = (120 / 2) - ((sRECT.Right - sRECT.Left) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Right = dRECT.Left + (sRECT.Right - sRECT.Left)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Tileset(frmEditor_Events.scrlGraphic.Value) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="typ">Tilesets</span><span class="pun">\</span><span class="str">" &amp; frmEditor_Events.scrlGraphic.Value, DDSD_Tileset(frmEditor_Events.scrlGraphic.Value), DDS_Tileset(frmEditor_Events.scrlGraphic.Value))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltToDC(DDS_Tileset(frmEditor_Events.scrlGraphic.Value), sRECT, dRECT, frmEditor_Events.picGraphic)<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.top = tmpEvent.Pages(curPageNum).GraphicY * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Left = tmpEvent.Pages(curPageNum).GraphicX * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Bottom = sRECT.top + ((tmpEvent.Pages(curPageNum).GraphicY2 - tmpEvent.Pages(curPageNum).GraphicY) * 32)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sRECT.Right = sRECT.Left + ((tmpEvent.Pages(curPageNum).GraphicX2 - tmpEvent.Pages(curPageNum).GraphicX) * 32)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With dRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.top = (193 / 2) - ((sRECT.Bottom - sRECT.top) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Bottom = dRECT.top + (sRECT.Bottom - sRECT.top)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Left = (120 / 2) - ((sRECT.Right - sRECT.Left) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dRECT.Right = dRECT.Left + (sRECT.Right - sRECT.Left)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Tileset(frmEditor_Events.scrlGraphic.Value) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="typ">Tilesets</span><span class="pun">\</span><span class="str">" &amp; frmEditor_Events.scrlGraphic.Value, DDSD_Tileset(frmEditor_Events.scrlGraphic.Value), DDS_Tileset(frmEditor_Events.scrlGraphic.Value))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltToDC(DDS_Tileset(frmEditor_Events.scrlGraphic.Value), sRECT, dRECT, frmEditor_Events.picGraphic)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; ' Error handler<br>&nbsp; &nbsp; Exit Sub<br>errorhandler:<br>&nbsp; &nbsp; HandleError "</span><span class="typ">EditorMap_BltKey</span><span class="str">", "</span><span class="pln">modDirectDraw7</span><span class="str">", Err.Number, Err.Description, Err.Source, Err.HelpContext<br>&nbsp; &nbsp; Err.Clear<br>&nbsp; &nbsp; Exit Sub<br>End Sub<br><br>Public Sub BltEvent(id As Long)<br>&nbsp; &nbsp; Dim x As Long, y As Long, width As Long, height As Long, sRECT As DxVBLib.RECT, dRECT As DxVBLib.RECT, anim As Long, spritetop As Long<br>&nbsp; &nbsp; If Map.MapEvents(id).Visible = 0 Then Exit Sub<br>&nbsp; &nbsp; If InMapEditor Then Exit Sub<br>&nbsp; &nbsp; Select Case Map.MapEvents(id).GraphicType<br>&nbsp; &nbsp; &nbsp; &nbsp; Case 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).GraphicNum &lt;= 0 Or Map.MapEvents(id).GraphicNum &gt; NumCharacters Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CharacterTimer(Map.MapEvents(id).GraphicNum) = GetTickCount + SurfaceTimerMax<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Character(Map.MapEvents(id).GraphicNum) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="pln">characters</span><span class="pun">\</span><span class="str">" &amp; Map.MapEvents(id).GraphicNum, DDSD_Character(Map.MapEvents(id).GraphicNum), DDS_Character(Map.MapEvents(id).GraphicNum))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width = DDSD_Character(Map.MapEvents(id).GraphicNum).lWidth / 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height = DDSD_Character(Map.MapEvents(id).GraphicNum).lHeight / 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Reset frame<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Step = 3 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; anim = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ElseIf Map.MapEvents(id).Step = 1 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; anim = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Select Case Map.MapEvents(id).Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).YOffset &gt; 8) Then anim = Map.MapEvents(id).Step<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).YOffset &lt; -8) Then anim = Map.MapEvents(id).Step<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).XOffset &gt; 8) Then anim = Map.MapEvents(id).Step<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (Map.MapEvents(id).XOffset &lt; -8) Then anim = Map.MapEvents(id).Step<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Set the left<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Select Case Map.MapEvents(id).ShowDir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spritetop = 3<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spritetop = 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spritetop = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; spritetop = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Select<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).WalkAnim = 1 Then anim = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).Moving = 0 Then anim = Map.MapEvents(id).GraphicX<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With sRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .top = spritetop * height<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Bottom = .top + height<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Left = anim * width<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Right = .Left + width<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Calculate the X<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = Map.MapEvents(id).x * PIC_X + Map.MapEvents(id).XOffset - ((width - 32) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Is the player's height more than 32..?<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If (height * 4) &gt; 32 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Create a 32 pixel offset for larger sprites<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = Map.MapEvents(id).y * PIC_Y + Map.MapEvents(id).YOffset - ((height) - 32)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' Proceed as normal<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = Map.MapEvents(id).y * PIC_Y + Map.MapEvents(id).YOffset<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ' render the actual sprite<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call BltSprite(Map.MapEvents(id).GraphicNum, x, y, sRECT)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; Case 2<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).GraphicNum &lt; 1 Or Map.MapEvents(id).GraphicNum &gt; NumTileSets Then Exit Sub<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).GraphicY2 &gt; 0 Or Map.MapEvents(id).GraphicX2 &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With sRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .top = Map.MapEvents(id).GraphicY * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Bottom = .top + ((Map.MapEvents(id).GraphicY2 - Map.MapEvents(id).GraphicY) * 32)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Left = Map.MapEvents(id).GraphicX * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Right = .Left + ((Map.MapEvents(id).GraphicX2 - Map.MapEvents(id).GraphicX) * 32)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; With sRECT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .top = Map.MapEvents(id).GraphicY * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Bottom = .top + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Left = Map.MapEvents(id).GraphicX * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .Right = .Left + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End With<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = Map.MapEvents(id).x * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = Map.MapEvents(id).y * 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = x - ((sRECT.Right - sRECT.Left) / 2)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = y - (sRECT.Bottom - sRECT.top) + 32<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If DDS_Tileset(Map.MapEvents(id).GraphicNum) Is Nothing Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call InitDDSurf("</span><span class="pln">tilesets</span><span class="pun">\</span><span class="str">" &amp; Map.MapEvents(id).GraphicNum, DDSD_Tileset(Map.MapEvents(id).GraphicNum), DDS_Tileset(Map.MapEvents(id).GraphicNum))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If Map.MapEvents(id).GraphicY2 &gt; 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(ConvertMapX(Map.MapEvents(id).x * 32), ConvertMapY((Map.MapEvents(id).y - ((Map.MapEvents(id).GraphicY2 - Map.MapEvents(id).GraphicY) - 1)) * 32), DDS_Tileset(Map.MapEvents(id).GraphicNum), sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call Engine_BltFast(ConvertMapX(Map.MapEvents(id).x * 32), ConvertMapY(Map.MapEvents(id).y * 32), DDS_Tileset(Map.MapEvents(id).GraphicNum), sRECT, DDBLTFAST_WAIT Or DDBLTFAST_SRCCOLORKEY)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If<br>&nbsp; &nbsp; End Select<br>End Sub</span></pre><br>in <strong class="bbc">modenumerations</strong> add<br><pre class="prettyprint"><span class="typ">SSpawnEvent</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventMove</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventDir</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventChat</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventStart</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SEventEnd</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SPlayBGM</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SPlaySound</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SFadeoutBGM</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SStopSound</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SSwitchesAndVariables</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SMapEventData</span></pre><br>and in the c section<br><br><pre class="prettyprint"><span class="typ">CEventChatReply</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CEvent</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CSwitchesAndVariables</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CRequestSwitchesAndVariables</span></pre><br>at the bottom of modenumerations add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Enum</span><span class="pln"> </span><span class="typ">MoveRouteOpts</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveUp</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveDown</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveLeft</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRight</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveRandom</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveTowardsPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">MoveAwayFromPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">StepForward</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">StepBack</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Wait100ms</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Wait500ms</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Wait1000ms</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnUp</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnDown</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnLeft</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnRight</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Turn90Right</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Turn90Left</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Turn180</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnRandom</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnTowardPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">TurnAwayFromPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeed8xSlower</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeed4xSlower</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeed2xSlower</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeedNormal</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeed2xFaster</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetSpeed4xFaster</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetFreqLowest</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetFreqLower</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetFreqNormal</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetFreqHigher</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SetFreqHighest</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkingAnimOn</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkingAnimOff</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">DirFixOn</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">DirFixOff</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkThroughOn</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WalkThroughOff</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">PositionBelowPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">PositionWithPlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">PositionAbovePlayer</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ChangeGraphic</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Enum</span><span class="pln"><br><br></span><span class="str">' Event Types<br>Public Enum EventType<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Message</span><span class="pln"><br>&nbsp; &nbsp; evAddText </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"><br>&nbsp; &nbsp; evShowText<br>&nbsp; &nbsp; evShowChoices<br>&nbsp; &nbsp; </span><span class="str">' Game Progression<br>&nbsp; &nbsp; evPlayerVar<br>&nbsp; &nbsp; evPlayerSwitch<br>&nbsp; &nbsp; evSelfSwitch<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Flow</span><span class="pln"> </span><span class="typ">Control</span><span class="pln"><br>&nbsp; &nbsp; evCondition<br>&nbsp; &nbsp; evExitProcess<br>&nbsp; &nbsp; </span><span class="str">' Player<br>&nbsp; &nbsp; evChangeItems<br>&nbsp; &nbsp; evRestoreHP<br>&nbsp; &nbsp; evRestoreMP<br>&nbsp; &nbsp; evLevelUp<br>&nbsp; &nbsp; evChangeLevel<br>&nbsp; &nbsp; evChangeSkills<br>&nbsp; &nbsp; evChangeClass<br>&nbsp; &nbsp; evChangeSprite<br>&nbsp; &nbsp; evChangeSex<br>&nbsp; &nbsp; evChangePK<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Movement</span><span class="pln"><br>&nbsp; &nbsp; evWarpPlayer<br>&nbsp; &nbsp; evSetMoveRoute<br>&nbsp; &nbsp; </span><span class="str">' Character<br>&nbsp; &nbsp; evPlayAnimation<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Music</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="typ">Sounds</span><span class="pln"><br>&nbsp; &nbsp; evPlayBGM<br>&nbsp; &nbsp; evFadeoutBGM<br>&nbsp; &nbsp; evPlaySound<br>&nbsp; &nbsp; evStopSound<br>&nbsp; &nbsp; </span><span class="str">'Etc...<br>&nbsp; &nbsp; evCustomScript<br>&nbsp; &nbsp; evSetAccess<br>&nbsp; &nbsp; '</span><span class="typ">Shop</span><span class="pun">/</span><span class="typ">Bank</span><span class="pln"><br>&nbsp; &nbsp; evOpenBank<br>&nbsp; &nbsp; evOpenShop<br>&nbsp; &nbsp; </span><span class="str">'New<br>&nbsp; &nbsp; evGiveExp<br>End Enum</span></pre><br>search for <strong class="bbc">HandleDataSub(SPartyVitals) = GetAddress(AddressOf HandlePartyVitals)</strong><br>below it add<br><pre class="prettyprint"><span class="str">'Events<br>&nbsp; &nbsp; HandleDataSub(SSpawnEvent) = GetAddress(AddressOf HandleSpawnEventPage)<br>&nbsp; &nbsp; HandleDataSub(SEventMove) = GetAddress(AddressOf HandleEventMove)<br>&nbsp; &nbsp; HandleDataSub(SEventDir) = GetAddress(AddressOf HandleEventDir)<br>&nbsp; &nbsp; HandleDataSub(SEventChat) = GetAddress(AddressOf HandleEventChat)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; HandleDataSub(SEventStart) = GetAddress(AddressOf HandleEventStart)<br>&nbsp; &nbsp; HandleDataSub(SEventEnd) = GetAddress(AddressOf HandleEventEnd)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; HandleDataSub(SPlayBGM) = GetAddress(AddressOf HandlePlayBGM)<br>&nbsp; &nbsp; HandleDataSub(SPlaySound) = GetAddress(AddressOf HandlePlaySound)<br>&nbsp; &nbsp; HandleDataSub(SFadeoutBGM) = GetAddress(AddressOf HandleFadeoutBGM)<br>&nbsp; &nbsp; HandleDataSub(SStopSound) = GetAddress(AddressOf HandleStopSound)<br>&nbsp; &nbsp; HandleDataSub(SSwitchesAndVariables) = GetAddress(AddressOf HandleSwitchesAndVariables)<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; HandleDataSub(SMapEventData) = GetAddress(AddressOf HandleMapEventData)</span></pre><br>search for<strong class="bbc"> ' clear the blood</strong><br>below<br><pre class="prettyprint"><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> MAX_BYTE<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Blood</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Blood</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Blood</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Sprite</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Blood</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Timer</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Next</span></pre>add<br><pre class="prettyprint"><span class="typ">Map</span><span class="pun">.</span><span class="typ">CurrentEvents</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">MapEvents</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span></pre><br>at the bottom of <strong class="bbc">modhandledata</strong> add<br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleSpawnEventPage</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> id </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; id = Buffer.ReadLong<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If id &gt; Map.CurrentEvents Then<br>&nbsp; &nbsp; &nbsp; &nbsp; Map.CurrentEvents = id<br>&nbsp; &nbsp; &nbsp; &nbsp; ReDim Preserve Map.MapEvents(Map.CurrentEvents)<br>&nbsp; &nbsp; End If<br><br>&nbsp; &nbsp; With Map.MapEvents(id)<br>&nbsp; &nbsp; &nbsp; &nbsp; .Name = Buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; .Dir = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .ShowDir = .Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicNum = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicType = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicX = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicX2 = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicY = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .GraphicY2 = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .MovementSpeed = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .Moving = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .x = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .y = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .XOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .YOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .Position = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .Visible = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .WalkAnim = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .DirFix = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .WalkThrough = Buffer.ReadLong<br>&nbsp; &nbsp; &nbsp; &nbsp; .ShowName = Buffer.ReadLong<br>&nbsp; &nbsp; End With<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleSpawnEventPage"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventMove</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> id </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ShowDir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Movement</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MovementSpeed</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; id = Buffer.ReadLong<br>&nbsp; &nbsp; x = Buffer.ReadLong<br>&nbsp; &nbsp; y = Buffer.ReadLong<br>&nbsp; &nbsp; Dir = Buffer.ReadLong<br>&nbsp; &nbsp; ShowDir = Buffer.ReadLong<br>&nbsp; &nbsp; MovementSpeed = Buffer.ReadLong<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If id &gt; Map.CurrentEvents Then Exit Sub<br><br>&nbsp; &nbsp; With Map.MapEvents(id)<br>&nbsp; &nbsp; &nbsp; &nbsp; .x = x<br>&nbsp; &nbsp; &nbsp; &nbsp; .y = y<br>&nbsp; &nbsp; &nbsp; &nbsp; .Dir = Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; .XOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .YOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .Moving = 1<br>&nbsp; &nbsp; &nbsp; &nbsp; .ShowDir = ShowDir<br>&nbsp; &nbsp; &nbsp; &nbsp; .MovementSpeed = MovementSpeed<br>&nbsp; &nbsp; &nbsp; &nbsp; <br><br>&nbsp; &nbsp; &nbsp; &nbsp; Select Case Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_UP<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .YOffset = PIC_Y<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_DOWN<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .YOffset = PIC_Y * -1<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_LEFT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .XOffset = PIC_X<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case DIR_RIGHT<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .XOffset = PIC_X * -1<br>&nbsp; &nbsp; &nbsp; &nbsp; End Select<br><br>&nbsp; &nbsp; End With<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleEventMove"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventDir</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; i = Buffer.ReadLong<br>&nbsp; &nbsp; Dir = Buffer.ReadLong<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If i &gt; Map.CurrentEvents Then Exit Sub<br><br>&nbsp; &nbsp; With Map.MapEvents(i)<br>&nbsp; &nbsp; &nbsp; &nbsp; .Dir = Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; .ShowDir = Dir<br>&nbsp; &nbsp; &nbsp; &nbsp; .XOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .YOffset = 0<br>&nbsp; &nbsp; &nbsp; &nbsp; .Moving = 0<br>&nbsp; &nbsp; End With<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleEventDir"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventChat</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Dir</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> choices </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; frmMain.picEventChat.Visible = True<br>&nbsp; &nbsp; EventReplyID = Buffer.ReadLong<br>&nbsp; &nbsp; EventReplyPage = Buffer.ReadLong<br>&nbsp; &nbsp; frmMain.lblEventChat.Caption = Buffer.ReadString<br>&nbsp; &nbsp; frmMain.lblEventChat.Caption = Replace(frmMain.lblEventChat.Caption, "/p", Trim$(Player(MyIndex).Name))<br>&nbsp; &nbsp; frmMain.picEventChat.Visible = True<br>&nbsp; &nbsp; frmMain.lblEventChat.Visible = True<br>&nbsp; &nbsp; choices = Buffer.ReadLong<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; InEvent = True<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 1 To 4<br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain.lblChoices(i).Visible = False<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; frmMain.lblEventChatContinue.Visible = False<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; If choices = 0 Then<br>&nbsp; &nbsp; &nbsp; &nbsp; frmMain.lblEventChatContinue.Visible = True<br>&nbsp; &nbsp; Else<br>&nbsp; &nbsp; &nbsp; &nbsp; For i = 1 To choices<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmMain.lblChoices(i).Visible = True<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; frmMain.lblChoices(i).Caption = Buffer.ReadString<br>&nbsp; &nbsp; &nbsp; &nbsp; Next<br>&nbsp; &nbsp; End If<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; AnotherChat = Buffer.ReadLong<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleEventChat"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventStart</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; InEvent = True<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleEventStart"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleEventEnd</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; InEvent = False<br><br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleEventEnd"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandlePlayBGM</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; str = Buffer.ReadString<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; StopMidi<br>&nbsp; &nbsp; PlayMidi str<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandlePlayBGM"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandlePlaySound</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; str = Buffer.ReadString<br><br>&nbsp; &nbsp; PlaySound str<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandlePlaySound"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleFadeoutBGM</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; '</span><span class="typ">Need</span><span class="pln"> to learn how to fadeout </span><span class="pun">:</span><span class="pln">P<br>&nbsp; &nbsp; </span><span class="str">'do later... way later.. like, after release, maybe never<br>&nbsp; &nbsp; StopMidi<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleFadeoutBGM"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleStopSound</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 0 To UBound(Sound()) - 1<br>&nbsp; &nbsp; &nbsp; &nbsp; SoundStop (i)<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleFadeoutBGM"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br><br></span><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleSwitchesAndVariables</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 1 To MAX_SWITCHES<br>&nbsp; &nbsp; &nbsp; &nbsp; Switches(i) = Buffer.ReadString<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; For i = 1 To MAX_VARIABLES<br>&nbsp; &nbsp; &nbsp; &nbsp; Variables(i) = Buffer.ReadString<br>&nbsp; &nbsp; Next<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleSwitchesAndVariables"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span></pre>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842375">
				<ul class="ipsList_inline">
					<li id="like_post_842375" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842375&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842375" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842375&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842375" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842375', { domLikeStripId: 'like_post_842375', app: 'forums', type: 'pid', typeid: '842375' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842375" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842375" class="_ips_trigger_quote ipsButton_secondary" pid="842375" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842375" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842375" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842375&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842375);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842375') )
	{
		$('multiq_842375').show();
	}
	
	if( $('toggle_post_842375') )
	{
		$('toggle_post_842375').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842375] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842376-->

<div class="post_block hentry clear clearfix " id="post_id_842376">
		<a id="entry842376"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842376" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #13">
					
					#13
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_16" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-08T21:19:43+00:00">08 August 2012 - 09:19 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->the rest for the bottom of <strong class="bbc">modhandledata</strong><br><pre class="prettyprint"><span class="typ">Private</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"> </span><span class="typ">HandleMapEventData</span><span class="pun">(</span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">Index</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByRef</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">()</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Byte</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">StartAddr</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ByVal</span><span class="pln"> </span><span class="typ">ExtraVar</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Dim</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pln"> </span><span class="typ">As</span><span class="pln"> clsBuffer<br></span><span class="typ">Dim</span><span class="pln"> str </span><span class="typ">As</span><span class="pln"> </span><span class="typ">String</span><span class="pun">,</span><span class="pln"> i </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> x </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> y </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> z </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pun">,</span><span class="pln"> w </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="str">' If debug mode, handle error then exit out<br>&nbsp; &nbsp; If Options.Debug = 1 Then On Error GoTo errorhandler<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = New clsBuffer<br>&nbsp; &nbsp; Buffer.WriteBytes Data()<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; '</span><span class="typ">Event</span><span class="pln"> </span><span class="typ">Data</span><span class="pun">!</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">EventCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Name</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Global</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">pageCount </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageCount </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="pln">pageCount<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkVariable </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableCondition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">VariableCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SwitchIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SwitchCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkHasItem </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">HasItemIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="pln">chkSelfSwitch </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SelfSwitchIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">SelfSwitchCompare</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Graphic</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicX</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicY</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicX2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">GraphicY2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveType</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveSpeed</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveFreq</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">IgnoreMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">RepeatMoveRoute</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Data6</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">WalkAnim</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">DirFix</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">WalkThrough</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ShowName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Trigger</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Position</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="lit">0</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandListCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">ParentList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">CommandCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">With</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">.</span><span class="typ">Events</span><span class="pun">(</span><span class="pln">i</span><span class="pun">).</span><span class="typ">Pages</span><span class="pun">(</span><span class="pln">x</span><span class="pun">).</span><span class="typ">CommandList</span><span class="pun">(</span><span class="pln">y</span><span class="pun">).</span><span class="typ">Commands</span><span class="pun">(</span><span class="pln">z</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Text5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadString</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">Data6</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">CommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Condition</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">ConditionalBranch</span><span class="pun">.</span><span class="typ">ElseCommandList</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">If</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="typ">Then</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">ReDim</span><span class="pln"> </span><span class="typ">Preserve</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(.</span><span class="typ">MoveRouteCount</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">For</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="typ">To</span><span class="pln"> </span><span class="pun">.</span><span class="typ">MoveRouteCount</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Index</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data4</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data5</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">.</span><span class="typ">MoveRoute</span><span class="pun">(</span><span class="pln">w</span><span class="pun">).</span><span class="typ">Data6</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Buffer</span><span class="pun">.</span><span class="typ">ReadLong</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">With</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Next</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">End</span><span class="pln"> </span><span class="typ">If</span><span class="pln"><br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="str">'End Event Data<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; Set Buffer = Nothing<br>&nbsp; &nbsp; '</span><span class="pln"> </span><span class="typ">Error</span><span class="pln"> handler<br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br>errorhandler</span><span class="pun">:</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">HandleError</span><span class="pln"> </span><span class="str">"HandleMapEventData"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"modHandleData"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Number</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Description</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Source</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">HelpContext</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Err</span><span class="pun">.</span><span class="typ">Clear</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Exit</span><span class="pln"> </span><span class="typ">Sub</span><span class="pln"><br></span><span class="typ">End</span><span class="pln"> </span><span class="typ">Sub</span></pre><br><br>in modconstants search for <strong class="bbc">Public Const MAX_PARTY_MEMBERS As Long = 4</strong><br>add<br><pre class="prettyprint"><span class="typ">Public</span><span class="pln"> </span><span class="typ">Const</span><span class="pln"> MAX_SWITCHES </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span><span class="pln"><br></span><span class="typ">Public</span><span class="pln"> </span><span class="typ">Const</span><span class="pln"> MAX_VARIABLES </span><span class="typ">As</span><span class="pln"> </span><span class="typ">Long</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span></pre><br><br>add frmeidtor_events to project from 2.3 event system download.<br>add modsound to project from 2.3 event system download.<br><br>you can compile this one in native or p-code. doesnt matter.&nbsp; 
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842376">
				<ul class="ipsList_inline">
					<li id="like_post_842376" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842376&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842376" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842376&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842376" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842376', { domLikeStripId: 'like_post_842376', app: 'forums', type: 'pid', typeid: '842376' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842376" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842376" class="_ips_trigger_quote ipsButton_secondary" pid="842376" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842376" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842376" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842376&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842376);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842376') )
	{
		$('multiq_842376').show();
	}
	
	if( $('toggle_post_842376') )
	{
		$('toggle_post_842376').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842376] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842473-->

<div class="post_block hentry clear clearfix " id="post_id_842473">
		<a id="entry842473"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842473" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #14">
					
					#14
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_17" hovercard-ref="member" hovercard-id="65994" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65994-goldside/" title=""><span itemprop="name">GoldSide</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">GoldSide</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65994-goldside/" title="View Profile: GoldSide" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65994.gif" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			296 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">bandung</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T07:57:28+00:00">09 August 2012 - 07:57 AM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->must deleted all maps ?<br>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842473">
				<ul class="ipsList_inline">
					<li id="like_post_842473" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842473&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842473" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842473&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842473" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842473', { domLikeStripId: 'like_post_842473', app: 'forums', type: 'pid', typeid: '842473' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="65994">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Thu, 23 Aug 2012 23:45:05 +0000--><span rel="lightbox"><img src="Event%20System%202.3%20into%202.0.php_files/4b15aedd42aea12a955dc78f7aadf47f.png" alt="Posted Image" class="bbc_img"></span><br><span style="color: red"><strong class="bbc">Resource : </strong></span>[move]<br><a href="http://www.touchofdeathforums.com/smf2/index.php/topic,75259.0.html" class="bbc_url" title="">Animations Eclipse</a> <strong class="bbc">|</strong> <a href="http://www.touchofdeathforums.com/smf2/index.php/topic,75262.0.html" class="bbc_url" title="">Paperdoll Armor</a> <strong class="bbc">|</strong> <a href="http://www.touchofdeathforums.com/smf2/index.php/topic,75278.msg806385.html" class="bbc_url" title="">Paperdolls Devil Wings</a>[/move]<br><br><span style="color: red"><strong class="bbc">Tutorials : </strong></span>[move]<a href="http://www.touchofdeathforums.com/smf2/index.php/topic,75323.0.html" class="bbc_url" title="">[EO 2.0]Add clock in the game</a> <strong class="bbc">|</strong><a href="http://www.touchofdeathforums.com/smf2/index.php/topic,78011.0.html" class="bbc_url" title="">[EO2.0]Adding Email in frmMenu</a><span style="color: purple"><strong class="bbc">*</strong></span><strong class="bbc">|</strong><a href="http://www.touchofdeathforums.com/smf2/index.php/topic,79465.0.html" class="bbc_url" title="">[EO 2.0]Serial Number, Redeem Item or etc</a>[/move]<br><br><span style="color: red">Note : </span><br><span style="color: purple"><strong class="bbc">*</strong></span> : The topic has been modified or update<br><span style="color: red"><strong class="bbc">*</strong></span> : The topic has been fixed<br><a href="http://www.freemmorpgmaker.com/files/imagehost/pics/dc1d26c79c4cad8059353440ba02cce2.swf" class="bbc_url" title="External link" rel="nofollow external">Into The Lost History</a>
</div>
				
				
				
			
				<ul id="postControlsNormal_842473" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842473" class="_ips_trigger_quote ipsButton_secondary" pid="842473" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842473" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842473" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842473&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842473);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842473') )
	{
		$('multiq_842473').show();
	}
	
	if( $('toggle_post_842473') )
	{
		$('toggle_post_842473').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842473] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842475-->

<div class="post_block hentry clear clearfix " id="post_id_842475">
		<a id="entry842475"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842475" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #15">
					
					#15
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_18" hovercard-ref="member" hovercard-id="54531" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/54531-deathbeam/" title=""><span itemprop="name">Deathbeam</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">Deathbeam</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Prospekt Online and Eclipse Advanced creator</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/54531-deathbeam/" title="View Profile: Deathbeam" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-54531.gif" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#b27d60">Advanced Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member3.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			714 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">Slovakia</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T08:01:53+00:00">09 August 2012 - 08:01 AM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->Nice bro i will add this to CS:DE :P
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842475">
				<ul class="ipsList_inline">
					<li id="like_post_842475" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842475&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842475" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842475&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842475" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842475', { domLikeStripId: 'like_post_842475', app: 'forums', type: 'pid', typeid: '842475' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="54531">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 12:48:19 +0000--><em class="bbc">Only health and love cannot be bought</em><br>
<p class="bbc_center"><span rel="lightbox"><img src="Event%20System%202.3%20into%202.0.php_files/Dpvlq.png" alt="Posted Image" class="bbc_img"></span></p>
<br>
Prospekt Server Status:<a href="http://freemmorpgmaker.com/status/status.php?ip=213.93.133.254&amp;port=25565" class="bbc_url" title="External link" rel="nofollow external">http://freemmorpgmak....254&amp;port=25565</a><br>
Prospekt Online website: <a href="http://prospektonline.tk/" class="bbc_url" title="External link" rel="nofollow external">http://prospektonline.tk/</a><br>
Prospekt Online development thread: <a href="http://www.touchofdeathforums.com/smf2/index.php/topic,79302.0.html" class="bbc_url" title="">http://www.touchofde...ic,79302.0.html</a>
</div>
				
				
				
			
				<ul id="postControlsNormal_842475" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842475" class="_ips_trigger_quote ipsButton_secondary" pid="842475" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842475" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842475" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842475&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842475);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842475') )
	{
		$('multiq_842475').show();
	}
	
	if( $('toggle_post_842475') )
	{
		$('toggle_post_842475').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842475] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842481-->

<div class="post_block hentry clear clearfix " id="post_id_842481">
		<a id="entry842481"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842481" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #16">
					
					#16
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_19" hovercard-ref="member" hovercard-id="69819" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/69819-wacko/" title=""><span itemprop="name">Wacko</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">Wacko</span>
	<ul class="basic_info">
		
			<p class="desc member_title">PRO Co-Owner</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/69819-wacko/" title="View Profile: Wacko" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-69819.png" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:green">Newb
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			29 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">Tasmania, Australia</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T08:28:29+00:00">09 August 2012 - 08:28 AM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->Woah! Nice job converting it from DX8! :O
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842481">
				<ul class="ipsList_inline">
					<li id="like_post_842481" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842481&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842481" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842481&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842481" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842481', { domLikeStripId: 'like_post_842481', app: 'forums', type: 'pid', typeid: '842481' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="69819">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 10:31:59 +0000-->Wacko,<br>
Pokemon Rumble Online Co-Owner.<br>
<span rel="lightbox"><img src="Event%20System%202.3%20into%202.0.php_files/OouLD.png" alt="Posted Image" class="bbc_img"></span><br>
<div class="bbc_spoiler">
	<span class="spoiler_title">Spoiler </span> <input class="bbc_spoiler_show" value="Show" type="button">
	<div class="bbc_spoiler_wrapper"><div class="bbc_spoiler_content" style="display:none;"><a href="http://www.pokemonrumbleonline.freeforums.org/" class="bbc_url" title="External link" rel="nofollow external"><img src="Event%20System%202.3%20into%202.0.php_files/hTCt4.png" alt="Posted Image" class="bbc_img"></a></div></div>
</div>
</div>
				
				
				
			
				<ul id="postControlsNormal_842481" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842481" class="_ips_trigger_quote ipsButton_secondary" pid="842481" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842481" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842481" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842481&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842481);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842481') )
	{
		$('multiq_842481').show();
	}
	
	if( $('toggle_post_842481') )
	{
		$('toggle_post_842481').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842481] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842482-->

<div class="post_block hentry clear clearfix " id="post_id_842482">
		<a id="entry842482"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842482" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #17">
					
					#17
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_20" hovercard-ref="member" hovercard-id="52081" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/52081-fernz/" title=""><span itemprop="name">Fernz</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">Fernz</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/52081-fernz/" title="View Profile: Fernz" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-52081.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			189 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T08:31:21+00:00">09 August 2012 - 08:31 AM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->Sweet. No need to convert it myself now.
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842482">
				<ul class="ipsList_inline">
					<li id="like_post_842482" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842482&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842482" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842482&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842482" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842482', { domLikeStripId: 'like_post_842482', app: 'forums', type: 'pid', typeid: '842482' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="52081">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 08:45:31 +0000-->Fernz,<br>Pokemon Rumble Online Co-Owner.<br>[spoiler]<br>[quote author=Fernz link=topic=73993.msg851355#msg851355 date=1334406482]<br>[quote author=Wacko link=topic=73993.msg851346#msg851346 date=1334405613]<br>these are nice! :D<br>[quote author=Fernz link=topic=73993.msg851355#msg851355 date=1334406482]<br><!--NoParse2--><br>Wacko, the file is invalid or has been deleted. you're just trying to get to junior member :)<br>[/quote]<br>[/spoiler]
</div>
				
				
				
			
				<ul id="postControlsNormal_842482" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842482" class="_ips_trigger_quote ipsButton_secondary" pid="842482" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842482" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842482" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842482&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842482);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842482') )
	{
		$('multiq_842482').show();
	}
	
	if( $('toggle_post_842482') )
	{
		$('toggle_post_842482').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842482] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842484-->

<div class="post_block hentry clear clearfix " id="post_id_842484">
		<a id="entry842484"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842484" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #18">
					
					#18
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_21" hovercard-ref="member" hovercard-id="54531" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/54531-deathbeam/" title=""><span itemprop="name">Deathbeam</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">Deathbeam</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Prospekt Online and Eclipse Advanced creator</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/54531-deathbeam/" title="View Profile: Deathbeam" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-54531.gif" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#b27d60">Advanced Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member3.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			714 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">Slovakia</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T08:40:08+00:00">09 August 2012 - 08:40 AM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000--><p class="citation">Quote</p><div class="blockquote"><div class="quote">Woah! Nice job converting it from DX8! :O<br></div></div><p class="citation">Quote</p><div class="blockquote"><div class="quote">there are a few things that you need to be aware of before you begin.&nbsp; <br>1.this is from the 2.3 download avalible on this website.<br>2.this is the dx7 version.<br></div></div>
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842484">
				<ul class="ipsList_inline">
					<li id="like_post_842484" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842484&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842484" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842484&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842484" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842484', { domLikeStripId: 'like_post_842484', app: 'forums', type: 'pid', typeid: '842484' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="54531">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 12:48:19 +0000--><em class="bbc">Only health and love cannot be bought</em><br>
<p class="bbc_center"><span rel="lightbox"><img src="Event%20System%202.3%20into%202.0.php_files/Dpvlq.png" alt="Posted Image" class="bbc_img"></span></p>
<br>
Prospekt Server Status:<a href="http://freemmorpgmaker.com/status/status.php?ip=213.93.133.254&amp;port=25565" class="bbc_url" title="External link" rel="nofollow external">http://freemmorpgmak....254&amp;port=25565</a><br>
Prospekt Online website: <a href="http://prospektonline.tk/" class="bbc_url" title="External link" rel="nofollow external">http://prospektonline.tk/</a><br>
Prospekt Online development thread: <a href="http://www.touchofdeathforums.com/smf2/index.php/topic,79302.0.html" class="bbc_url" title="">http://www.touchofde...ic,79302.0.html</a>
</div>
				
				
				
			
				<ul id="postControlsNormal_842484" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842484" class="_ips_trigger_quote ipsButton_secondary" pid="842484" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842484" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842484" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842484&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842484);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842484') )
	{
		$('multiq_842484').show();
	}
	
	if( $('toggle_post_842484') )
	{
		$('toggle_post_842484').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842484] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842592-->

<div class="post_block hentry clear clearfix " id="post_id_842592">
		<a id="entry842592"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842592" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #19">
					
					#19
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_22" hovercard-ref="member" hovercard-id="65943" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title=""><span itemprop="name">sotvotkong</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">sotvotkong</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Advanced Member</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/65943-sotvotkong/" title="View Profile: sotvotkong" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-thumb-65943.jpg" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color:#8080C0">Junior Member
		</span></li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/member2.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			177 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
						<li>
							<span class="ft">Location</span><span class="fc">utah</span>
						</li>
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T16:19:28+00:00">09 August 2012 - 04:19 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->i duno if you have to 
delete maps or not... i didnt have to, but i didnt have much of anything
 anyways, just 1 map with some ground texture.&nbsp; i would convert or 
delet your maps to be safe.
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842592">
				<ul class="ipsList_inline">
					<li id="like_post_842592" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842592&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842592" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842592&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842592" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842592', { domLikeStripId: 'like_post_842592', app: 'forums', type: 'pid', typeid: '842592' }, parseInt('0') );
</script>
				
								
				
				
				
			
				<ul id="postControlsNormal_842592" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842592" class="_ips_trigger_quote ipsButton_secondary" pid="842592" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842592" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842592" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842592&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842592);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842592') )
	{
		$('multiq_842592').show();
	}
	
	if( $('toggle_post_842592') )
	{
		$('toggle_post_842592').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842592] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			

				<!--post:842596-->

<div class="post_block hentry clear clearfix " id="post_id_842596">
		<a id="entry842596"></a>
		
	
		
		<div class="post_wrap">
			
				<h3 class="row2">
			
				
				<span class="post_id right ipsType_small desc blend_links">
					
						<a itemprop="replyToUrl" href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/#entry842596" rel="bookmark" title="Adding Event System 2.3 into 2.0: post #20">
					
					#20
					</a>
				</span>
				
					<span itemprop="creator name" class="author vcard"><a id="anonymous_element_23" hovercard-ref="member" hovercard-id="76523" class="url fn name  ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/76523-%e2%98%ad-general-pony-%e2%98%ad/" title=""><span itemprop="name">☭ General Pony ☭</span></a></span>
				
			
				
			</h3>
			<div class="author_info">
				<div itemscope="" itemtype="http://schema.org/Person" class="user_details">
	<span class="hide" itemprop="name">☭ General Pony ☭</span>
	<ul class="basic_info">
		
			<p class="desc member_title">Freaking Pony Fool!</p>
		
		<li class="avatar">
				
				<a itemprop="url" href="http://www.touchofdeathforums.com/community/index.php?/user/76523-%e2%98%ad-general-pony-%e2%98%ad/" title="View Profile: ☭ General Pony ☭" class="ipsUserPhotoLink">
				
				
					<img itemprop="image" src="Event%20System%202.3%20into%202.0.php_files/photo-76523.png" class="ipsUserPhoto ipsUserPhoto_large">
				
				
				</a>
				
			</li>
		<li class="group_title">
			<span style="color: orange;">Donator</span>
		</li>
		<li class="group_icon">
			
				<img src="Event%20System%202.3%20into%202.0.php_files/donator.png" alt="">
			
			</li>
		
		<li class="post_count desc lighter">
			909 posts
		</li>
		
		
	</ul>
	
	
		<ul class="custom_fields">
			
				
					
				
			
		</ul>
	
	
</div>
			</div>
			<div class="post_body">
				<p class="posted_info desc lighter ipsType_small">
					Posted <abbr class="published" itemprop="commentTime" title="2012-08-09T16:40:29+00:00">09 August 2012 - 04:40 PM</abbr>
				</p>
				
				<div itemprop="commentText" class="post entry-content ">
					<!--cached-Tue, 28 Aug 2012 05:05:08 +0000-->For the love of god use spoilers.
					
					<br>
					
				</div>
				
				
				<div class="ipsLikeBar right clearfix" id="rep_post_842596">
				<ul class="ipsList_inline">
					<li id="like_post_842596" class="ipsLikeBar_info" style="display:none">
							
						</li>
					<li>
							<a class="ipsLikeButton ipsLikeButton_enabled rep_up" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842596&amp;rating=1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842596" title="Like this item">Like This</a>
						</li>
						<li style="display:none">
							<a class="ipsLikeButton ipsLikeButton_disabled rep_down" href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=global&amp;section=reputation&amp;do=add_rating&amp;app_rate=forums&amp;type=pid&amp;type_id=842596&amp;rating=-1&amp;secure_key=bebd230150525e2b52ebad4aacd61915&amp;post_return=842596" title="Remove like for this item">Unlike</a>
						</li>
				</ul>
			</div>
<script type="text/javascript">
	ipb.global.registerReputation( 'rep_post_842596', { domLikeStripId: 'like_post_842596', app: 'forums', type: 'pid', typeid: '842596' }, parseInt('0') );
</script>
				
								
				
					<div class="signature" data-memberid="76523">
	<a href="#" class="hide_signature"></a>
	<!--signature-cached-Tue, 28 Aug 2012 14:19:31 +0000--><del class="bbc"><strong class="bbc">Need programming work done in your project? Check out my service thread <a href="http://www.touchofdeathforums.com/community/index.php?/topic/128492-decent-programmer-looking-for-work/" class="bbc_url" title="">Here</a>.</strong></del><br>
<br>
<strong class="bbc">Closed, i really don't have the time with school starting back up. If i was going to work on something for you i apologize.</strong>
</div>
				
				
				
			
				<ul id="postControlsNormal_842596" class="post_controls clear clearfix">
					<li class="top hide"><a href="#ipboard_body" class="top" title="Back to top">Back to top</a></li>
					<li><a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842596" class="_ips_trigger_quote ipsButton_secondary" pid="842596" title="Reply directly to this post">Quote</a></li>
							
								<li class="multiquote" id="multiq_842596" style="">
							
								<a href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=post&amp;section=post&amp;do=reply_post&amp;f=76&amp;t=128599&amp;qpid=842596" title="MultiQuote allows you to select multiple posts across multiple topics, then reply to them all at once" class="ipsButton_secondary">MultiQuote</a>
							</li>
					
					
					
					
					<li class="report">
							<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=reports&amp;rcom=post&amp;tid=128599&amp;pid=842596&amp;st=">Report</a>
						</li>
						
				</ul>
					
			</div>
		</div>
	</div>
		
		
		<hr>
		
		
<script type="text/javascript">
var pid = parseInt(842596);
if ( pid > ipb.topic.topPid ){
	ipb.topic.topPid = pid;
}

	// Show multiquote for JS browsers
	if ( $('multiq_842596') )
	{
		$('multiq_842596').show();
	}
	
	if( $('toggle_post_842596') )
	{
		$('toggle_post_842596').show();
	}
	
	// Add perm data
	ipb.topic.deletePerms[842596] = { 'canDelete' : 0, 'canSoftDelete' : 0 };

</script>
			
		</div>
	</div>

<hr>
<div class="topic_controls clear ipsPad_top_bottom_half">
	
		<div class="left"><div class="pagination clearfix left ">
		<ul class="ipsList_inline back left">
			
			
		</ul>
		<ul class="ipsList_inline left pages">
			<li id="anonymous_element_2" class="pagejump clickable pj0737678001">
					<a href="#">Page 1 of 2 <!--<img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/dropdown.png' alt='+' />--></a>
					<script type="text/javascript">
						ipb.global.registerPageJump( '0737678001', { url: "http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/", stKey: 'st', perPage: 20, totalPages: 2, anchor: '' } );
					</script>
				</li>
			
				
					
						<li class="page active">1</li>
					
				

					<li class="page"><a href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20" title="Adding Event System 2.3 into 2.0 - Page 2">2</a></li>
				
			
		</ul>
		<ul class="ipsList_inline forward left">
			
				<li class="next"><a href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/page__st__20" title="Adding Event System 2.3 into 2.0 - Next page" rel="next">Next</a></li>
			
			
		</ul>
	</div></div>
	
	<div class="ipsPad_top_slimmer right">
		
		<a href="http://www.touchofdeathforums.com/community/index.php?/forum/76-source/" class="ipsType_small desc">Back to Source</a>
		
			· <a href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/nextunread/" class="ipsType_small desc">Next Unread Topic →</a>
		
	</div>	
</div>
<hr>
<div class="ipsBox" id="fast_reply_wrapper">
	<div class="ipsBox_container ipsPad">
		<h1 class="ipsType_subtitle">Reply to this topic</h1>
		
		<br>
		
			<a href="http://www.touchofdeathforums.com/community/index.php?/user/56158-vakarieser/" title="Your Profile" class="ipsUserPhotoLink left"><img src="Event%20System%202.3%20into%202.0.php_files/dd945e8ab186f3fa04a312fb8ad4b5fa.png" alt="vakarieser's Photo" class="ipsUserPhoto ipsUserPhoto_medium"></a>
		
		<div class="ipsBox_withphoto clearfix">
			<form action="http://www.touchofdeathforums.com/community/index.php?" method="post" id="ips_fastReplyForm">
				<input name="app" value="forums" type="hidden">
				<input name="module" value="post" type="hidden">
				<input name="section" value="post" type="hidden">
				<input name="do" value="reply_post_do" type="hidden">
				<input name="f" value="76" type="hidden">
				<input name="t" value="128599" type="hidden">
				<input name="st" value="" type="hidden">
				<input name="auth_key" value="bebd230150525e2b52ebad4aacd61915" type="hidden">
				<input name="fast_reply_used" value="1" type="hidden">
				<input name="enableemo" value="yes" type="hidden">
				<input name="enablesig" value="yes" type="hidden">
				
		
		
		<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/ckeditor.js"></script>
	
	<script type="text/javascript">
		/* Dynamic items */
		CKEDITOR.config.IPS_BBCODE          = {"acronym":{"id":"8","title":"Acronym","desc":"Allows you to make an acronym that will display a description when moused over","tag":"acronym","useoption":"1","example":"[acronym='Laugh Out Loud']lol[/acronym]","switch_option":"0","menu_option_text":"Enter the description for this acronym (EG: Laugh Out Loud)","menu_content_text":"Enter the acronym (EG: lol)","single_tag":"0","optional_option":"0","image":""},"background":{"id":"27","title":"Background-color","desc":"Adds a background color behind the text","tag":"background","useoption":"1","example":"[background=red]Red background behind this text[/background]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"code":{"id":"13","title":"Code","desc":"Allows you to enter general code","tag":"code","useoption":"0","example":"[code]$text = 'Some long code here';[/code]","switch_option":"0","menu_option_text":"","menu_content_text":"Code","single_tag":"0","optional_option":"0","image":""},"hr":{"id":"12","title":"Horizontal Rule","desc":"Adds a horizontal rule to separate text","tag":"hr","useoption":"0","example":"[hr]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"html":{"id":"15","title":"HTML Code","desc":"Allows you to enter formatted/syntax-highlighted HTML code","tag":"html","useoption":"0","example":"[html]<div class='outer'>\n  <p>Hello World</p>\n </div>[/html]","switch_option":"0","menu_option_text":"","menu_content_text":"HTML Code","single_tag":"0","optional_option":"0","image":""},"media":{"id":"32","title":"Media","desc":"Allows a user to post media content from certain common media sites","tag":"media","useoption":"1","example":"[media]http://www.youtube.com/watch?v=YqqLx-2vUr0[/media]","switch_option":"0","menu_option_text":"Dimensions (Flash Only)","menu_content_text":"Media URL","single_tag":"0","optional_option":"1","image":""},"member":{"id":"31","title":"Member","desc":"Given a member name, a link is automatically generated to the member's profile","tag":"member","useoption":"1","example":"[member=admin] runs this site.","switch_option":"0","menu_option_text":"Member Name","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"move":{"id":"43","title":"Move","desc":"Allows movement of text via the non-standard tag marquee. This is added for compatibility with the SMF system, it may be removed in the near future.","tag":"move","useoption":"0","example":"[move]Moving text[/move]","switch_option":"0","menu_option_text":"","menu_content_text":"Moving text.","single_tag":"0","optional_option":"0","image":""},"page":{"id":"36","title":"Multi-Page Articles","desc":"This tag can be used to create multi-page articles.  Page links are automatically added based on the number of times this tag is used, and the content is hidden until you reach the specified \"page\".","tag":"page","useoption":"0","example":"Content 1\n[page]\nContent 2\n[page]\nContent 3","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"php":{"id":"14","title":"PHP Code","desc":"Allows you to enter PHP code into a formatted/highlighted syntax box","tag":"php","useoption":"0","example":"[php]$variable = true;\n\nprint_r($variable);[/php]","switch_option":"0","menu_option_text":"","menu_content_text":"PHP Code","single_tag":"0","optional_option":"0","image":""},"post":{"id":"6","title":"Post Link","desc":"This tag provides an easy way to link to a post.","tag":"post","useoption":"1","example":"[post=1]Click me![/post]","switch_option":"0","menu_option_text":"Enter the Post ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"spoiler":{"id":"7","title":"Spoiler","desc":"Spoiler tag","tag":"spoiler","useoption":"1","example":"[spoiler=Teaser]Some hidden text[/spoiler]","switch_option":"0","menu_option_text":"Enter the teaser (title)","menu_content_text":"Enter the text to be masked","single_tag":"0","optional_option":"1","image":""},"sql":{"id":"16","title":"SQL Code","desc":"Allows you to enter formatted/syntax-highlighted SQL code","tag":"sql","useoption":"0","example":"[sql]SELECT p.*, t.* FROM posts p LEFT JOIN topics t ON t.tid=p.topic_id WHERE t.tid=7[/sql]","switch_option":"0","menu_option_text":"","menu_content_text":"SQL Commands","single_tag":"0","optional_option":"0","image":""},"table":{"id":"37","title":"Table start","desc":"This defines the start of an table.","tag":"table","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"td":{"id":"38","title":"Td start","desc":"","tag":"td","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"topic":{"id":"5","title":"Topic Link","desc":"This tag provides an easy way to link to a topic","tag":"topic","useoption":"1","example":"[topic=1]Click me![/topic]","switch_option":"0","menu_option_text":"Enter the topic ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"tr":{"id":"39","title":"Tr start","desc":"","tag":"tr","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"twitter":{"id":"33","title":"Twitter","desc":"A tag to link to a user's twitter account","tag":"twitter","useoption":"0","example":"[twitter]userName[/twitter]","switch_option":"0","menu_option_text":"","menu_content_text":"Twitter Username","single_tag":"0","optional_option":"0","image":"twitter.png"},"vb":{"id":"42","title":"vb","desc":"Vb Code","tag":"vb","useoption":"0","example":"[vb]code[/vb]","switch_option":"0","menu_option_text":"a","menu_content_text":"a","single_tag":"0","optional_option":"0","image":"a"},"xml":{"id":"17","title":"XML Code","desc":"Allows you to enter formatted/syntax-highlighted XML code","tag":"xml","useoption":"0","example":"[xml]<outer>\n <inner>\n  <tag param='1'>Test</tag>\n </inner>\n</outer>[/xml]","switch_option":"0","menu_option_text":"","menu_content_text":"XML Code","single_tag":"0","optional_option":"0","image":""}};
		CKEDITOR.config.IPS_BBCODE_IMG_URL  = "http://www.touchofdeathforums.com/community/public/style_extra/bbcode_icons";
		CKEDITOR.config.IPS_BBCODE_BUTTONS  = [];
		
		/* Has to go before config load */
		var IPS_smiley_path			= "http://www.touchofdeathforums.com/community/public/style_emoticons/default/";
		var IPS_smiles       		= {"total":20,"count":20,"emoticons":[{"src":"smile.png","text":":)"},{"src":"wink.png","text":";)"},{"src":"tongue.png","text":":P"},{"src":"biggrin.png","text":":D"},{"src":"laugh.png","text":":lol:"},{"src":"sad.png","text":":("},{"src":"angry.png","text":":angry:"},{"src":"mellow.png","text":":mellow:"},{"src":"huh.png","text":":huh:"},{"src":"happy.png","text":"^_^"},{"src":"ohmy.png","text":":o"},{"src":"cool.png","text":"B)"},{"src":"rolleyes.gif","text":":rolleyes:"},{"src":"sleep.png","text":"-_-"},{"src":"dry.png","text":"&lt;_&lt;"},{"src":"wub.png","text":":wub:"},{"src":"unsure.png","text":":unsure:"},{"src":"wacko.png","text":":wacko:"},{"src":"blink.png","text":":blink:"},{"src":"ph34r.png","text":":ph34r:"}]};
		var IPS_remove_plugins      = [];
		var IPS_hide_contextMenu    = 0;
		var IPS_rclick_contextMenu  = 0;
		
		/* Load our configuration */
		CKEDITOR.config.customConfig  = 'http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/ips_config.js';
	</script>

	
	<input name="isRte" id="isRte_editor_503cdc38e13a2" value="1" type="hidden">
	<input name="noSmilies" id="noSmilies_editor_503cdc38e13a2" value="0" type="hidden">
	<textarea style="visibility: hidden; display: none;" id="editor_503cdc38e13a2" name="Post" class="ipsEditor_textarea input_text"></textarea><span id="cke_editor_503cdc38e13a2" class="cke_skin_ips cke_1 cke_editor_editor_503cdc38e13a2" dir="ltr" title=" " role="application" aria-labelledby="cke_editor_503cdc38e13a2_arialbl" lang="ipb"><span id="cke_editor_503cdc38e13a2_arialbl" class="cke_voice_label">Rich Text Editor</span><span class="cke_browser_gecko" role="presentation"><span class="cke_wrapper cke_ltr minimized" role="presentation"><table class="cke_editor" role="presentation" border="0" cellpadding="0" cellspacing="0"><tbody><tr style="-moz-user-select: none;" role="presentation"><td style="" id="cke_top_editor_503cdc38e13a2" class="cke_top" role="presentation"><div class="cke_toolbox" role="group" aria-labelledby="cke_4" onmousedown="return false;" style="display:none"><span id="cke_4" class="cke_voice_label"></span><span id="cke_5" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_6" class="cke_off cke_button_ipsswitch" title="Toggle editing mode" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_6_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(1, event);" onfocus="return CKEDITOR.tools.callFunction(2, event);" onclick="CKEDITOR.tools.callFunction(3, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipsswitch/images/switch.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_6_label" class="cke_label">Toggle editing mode</span></a></span><span class="cke_button"><a id="cke_7" class="cke_off cke_button_removeFormat" title="Remove Format" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_7_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(4, event);" onfocus="return CKEDITOR.tools.callFunction(5, event);" onclick="CKEDITOR.tools.callFunction(6, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_7_label" class="cke_label">Remove Format</span></a></span><span class="cke_button"><a id="cke_8" class="cke_off cke_button_ipsbbcode" title="Special BBCode" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_8_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(7, event);" onfocus="return CKEDITOR.tools.callFunction(8, event);" onclick="CKEDITOR.tools.callFunction(9, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipsbbcode/images/ips_bbcode.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_8_label" class="cke_label">Special BBCode</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_9" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_separator" role="separator"></span><span class="cke_rcombo" role="presentation"><span id="cke_10" class="cke_font cke_off" role="presentation"><span id="cke_10_label" class="cke_label">Font</span><a hidefocus="true" title="Font Name" tabindex="-1" role="button" aria-labelledby="cke_10_label" aria-describedby="cke_10_text" aria-haspopup="true" onblur="this.style.cssText = this.style.cssText;" onkeydown="CKEDITOR.tools.callFunction( 11, event, this );" onfocus="return CKEDITOR.tools.callFunction(12, event);" onclick="CKEDITOR.tools.callFunction(10, this); return false;"><span><span id="cke_10_text" class="cke_text cke_inline_label">Font</span></span><span class="cke_openbutton"><span class="cke_icon"></span></span></a></span></span><span class="cke_rcombo" role="presentation"><span id="cke_11" class="cke_fontSize cke_off" role="presentation"><span id="cke_11_label" class="cke_label">Size</span><a hidefocus="true" title="Font Size" tabindex="-1" role="button" aria-labelledby="cke_11_label" aria-describedby="cke_11_text" aria-haspopup="true" onblur="this.style.cssText = this.style.cssText;" onkeydown="CKEDITOR.tools.callFunction( 14, event, this );" onfocus="return CKEDITOR.tools.callFunction(15, event);" onclick="CKEDITOR.tools.callFunction(13, this); return false;"><span><span id="cke_11_text" class="cke_text cke_inline_label">Size</span></span><span class="cke_openbutton"><span class="cke_icon"></span></span></a></span></span></span><span class="cke_toolbar_end"></span></span><span id="cke_12" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_separator" role="separator"></span><span class="cke_button"><a id="cke_13" class="cke_off cke_button_textcolor" title="Text Color" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_13_label" aria-haspopup="true" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(16, event);" onfocus="return CKEDITOR.tools.callFunction(17, event);" onclick="CKEDITOR.tools.callFunction(18, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_13_label" class="cke_label">Text Color</span><span class="cke_buttonarrow">&nbsp;</span></a></span><span class="cke_button"><a id="cke_14" class="cke_off cke_button_ipsemoticon" title="Smiley" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_14_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(19, event);" onfocus="return CKEDITOR.tools.callFunction(20, event);" onclick="CKEDITOR.tools.callFunction(21, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipsemoticon/images/ips_emoticon.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_14_label" class="cke_label">Smiley</span></a></span><span class="cke_button"><a id="cke_15" class="cke_off cke_button_ipsmedia" title="My Media" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_15_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(22, event);" onfocus="return CKEDITOR.tools.callFunction(23, event);" onclick="CKEDITOR.tools.callFunction(24, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipsmedia/images/mymedia.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_15_label" class="cke_label">My Media</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_16" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_separator" role="separator"></span><span class="cke_button"><a id="cke_17" class="cke_off cke_button_find" title="Find" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_17_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(25, event);" onfocus="return CKEDITOR.tools.callFunction(26, event);" onclick="CKEDITOR.tools.callFunction(27, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_17_label" class="cke_label">Find</span></a></span><span class="cke_button"><a id="cke_18" class="cke_off cke_button_replace" title="Replace" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_18_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(28, event);" onfocus="return CKEDITOR.tools.callFunction(29, event);" onclick="CKEDITOR.tools.callFunction(30, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_18_label" class="cke_label">Replace</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_19" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_separator" role="separator"></span></span><span class="cke_toolbar_end"></span></span><span id="cke_20" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a aria-disabled="true" id="cke_21" class="cke_button_undo cke_disabled" title="Undo" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_21_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(31, event);" onfocus="return CKEDITOR.tools.callFunction(32, event);" onclick="CKEDITOR.tools.callFunction(33, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_21_label" class="cke_label">Undo</span></a></span><span class="cke_button"><a aria-disabled="true" id="cke_22" class="cke_button_redo cke_disabled" title="Redo" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_22_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(34, event);" onfocus="return CKEDITOR.tools.callFunction(35, event);" onclick="CKEDITOR.tools.callFunction(36, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_22_label" class="cke_label">Redo</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_23" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_separator" role="separator"></span></span><span class="cke_toolbar_end"></span></span><span id="cke_24" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a aria-disabled="true" id="cke_25" class="cke_button_copy cke_disabled" title="Copy" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_25_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(37, event);" onfocus="return CKEDITOR.tools.callFunction(38, event);" onclick="CKEDITOR.tools.callFunction(39, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_25_label" class="cke_label">Copy</span></a></span><span class="cke_button"><a id="cke_26" class="cke_off cke_button_paste" title="Paste" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_26_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(40, event);" onfocus="return CKEDITOR.tools.callFunction(41, event);" onclick="CKEDITOR.tools.callFunction(42, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_26_label" class="cke_label">Paste</span></a></span><span class="cke_button"><a id="cke_27" class="cke_off cke_button_pastetext" title="Paste as Plain Text" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_27_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(43, event);" onfocus="return CKEDITOR.tools.callFunction(44, event);" onclick="CKEDITOR.tools.callFunction(45, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_27_label" class="cke_label">Paste as Plain Text</span></a></span><span class="cke_button"><a id="cke_28" class="cke_off cke_button_pastefromword" title="Paste from Word" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_28_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(46, event);" onfocus="return CKEDITOR.tools.callFunction(47, event);" onclick="CKEDITOR.tools.callFunction(48, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_28_label" class="cke_label">Paste from Word</span></a></span></span><span class="cke_toolbar_end"></span></span><div class="cke_break"></div><span id="cke_29" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_30" class="cke_off cke_button_bold" title="Bold" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_30_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(49, event);" onfocus="return CKEDITOR.tools.callFunction(50, event);" onclick="CKEDITOR.tools.callFunction(51, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_30_label" class="cke_label">Bold</span></a></span><span class="cke_button"><a id="cke_31" class="cke_off cke_button_italic" title="Italic" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_31_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(52, event);" onfocus="return CKEDITOR.tools.callFunction(53, event);" onclick="CKEDITOR.tools.callFunction(54, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_31_label" class="cke_label">Italic</span></a></span><span class="cke_button"><a id="cke_32" class="cke_off cke_button_underline" title="Underline" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_32_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(55, event);" onfocus="return CKEDITOR.tools.callFunction(56, event);" onclick="CKEDITOR.tools.callFunction(57, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_32_label" class="cke_label">Underline</span></a></span><span class="cke_button"><a id="cke_33" class="cke_off cke_button_strike" title="Strike Through" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_33_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(58, event);" onfocus="return CKEDITOR.tools.callFunction(59, event);" onclick="CKEDITOR.tools.callFunction(60, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_33_label" class="cke_label">Strike Through</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_34" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_35" class="cke_off cke_button_subscript" title="Subscript" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_35_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(61, event);" onfocus="return CKEDITOR.tools.callFunction(62, event);" onclick="CKEDITOR.tools.callFunction(63, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_35_label" class="cke_label">Subscript</span></a></span><span class="cke_button"><a id="cke_36" class="cke_off cke_button_superscript" title="Superscript" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_36_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(64, event);" onfocus="return CKEDITOR.tools.callFunction(65, event);" onclick="CKEDITOR.tools.callFunction(66, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_36_label" class="cke_label">Superscript</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_37" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_38" class="cke_off cke_button_bulletedlist" title="Insert/Remove Bulleted List" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_38_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(67, event);" onfocus="return CKEDITOR.tools.callFunction(68, event);" onclick="CKEDITOR.tools.callFunction(69, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_38_label" class="cke_label">Insert/Remove Bulleted List</span></a></span><span class="cke_button"><a id="cke_39" class="cke_off cke_button_numberedlist" title="Insert/Remove Numbered List" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_39_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(70, event);" onfocus="return CKEDITOR.tools.callFunction(71, event);" onclick="CKEDITOR.tools.callFunction(72, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_39_label" class="cke_label">Insert/Remove Numbered List</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_40" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_41" class="cke_off cke_button_link" title="Link" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_41_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(73, event);" onfocus="return CKEDITOR.tools.callFunction(74, event);" onclick="CKEDITOR.tools.callFunction(75, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_41_label" class="cke_label">Link</span></a></span><span class="cke_button"><a aria-disabled="true" id="cke_42" class="cke_button_unlink cke_disabled" title="Unlink" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_42_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(76, event);" onfocus="return CKEDITOR.tools.callFunction(77, event);" onclick="CKEDITOR.tools.callFunction(78, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_42_label" class="cke_label">Unlink</span></a></span><span class="cke_button"><a id="cke_43" class="cke_off cke_button_image" title="Image" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_43_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(79, event);" onfocus="return CKEDITOR.tools.callFunction(80, event);" onclick="CKEDITOR.tools.callFunction(81, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_43_label" class="cke_label">Image</span></a></span><span class="cke_button"><a id="cke_44" class="cke_off cke_button_ipscode" title="Code" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_44_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(82, event);" onfocus="return CKEDITOR.tools.callFunction(83, event);" onclick="CKEDITOR.tools.callFunction(84, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipscode/images/code.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_44_label" class="cke_label">Code</span></a></span><span class="cke_button"><a id="cke_45" class="cke_off cke_button_ipsquote" title="Quote" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_45_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(85, event);" onfocus="return CKEDITOR.tools.callFunction(86, event);" onclick="CKEDITOR.tools.callFunction(87, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/js/3rd_party/ckeditor/plugins/ipsquote/images/quote.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_45_label" class="cke_label">Quote</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_46" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a id="cke_47" class="cke_off cke_button_ipsbbcode_twitter" title="Twitter" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_47_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(88, event);" onfocus="return CKEDITOR.tools.callFunction(89, event);" onclick="CKEDITOR.tools.callFunction(90, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/style_extra/bbcode_icons/twitter.png?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_47_label" class="cke_label">Twitter</span></a></span><span class="cke_button cke_noalphafix"><a id="cke_48" class="cke_off cke_button_ipsbbcode_vb" title="vb" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_48_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(91, event);" onfocus="return CKEDITOR.tools.callFunction(92, event);" onclick="CKEDITOR.tools.callFunction(93, this); return false;"><span class="cke_icon" style="background-image:url(http://www.touchofdeathforums.com/community/public/style_extra/bbcode_icons/a?t=B8DJ5M3);background-position:0 0px;">&nbsp;</span><span id="cke_48_label" class="cke_label">vb</span></a></span></span><span class="cke_toolbar_end"></span></span><span id="cke_49" class="cke_toolbar" role="toolbar"><span class="cke_toolbar_start"></span><span class="cke_toolgroup" role="presentation"><span class="cke_button"><a aria-disabled="true" id="cke_50" class="cke_button_outdent cke_disabled" title="Decrease Indent" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_50_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(94, event);" onfocus="return CKEDITOR.tools.callFunction(95, event);" onclick="CKEDITOR.tools.callFunction(96, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_50_label" class="cke_label">Decrease Indent</span></a></span><span class="cke_button"><a id="cke_51" class="cke_off cke_button_indent" title="Increase Indent" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_51_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(97, event);" onfocus="return CKEDITOR.tools.callFunction(98, event);" onclick="CKEDITOR.tools.callFunction(99, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_51_label" class="cke_label">Increase Indent</span></a></span><span class="cke_button"><a id="cke_52" class="cke_off cke_button_justifyleft" title="Align Left" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_52_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(100, event);" onfocus="return CKEDITOR.tools.callFunction(101, event);" onclick="CKEDITOR.tools.callFunction(102, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_52_label" class="cke_label">Align Left</span></a></span><span class="cke_button"><a id="cke_53" class="cke_off cke_button_justifycenter" title="Center" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_53_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(103, event);" onfocus="return CKEDITOR.tools.callFunction(104, event);" onclick="CKEDITOR.tools.callFunction(105, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_53_label" class="cke_label">Center</span></a></span><span class="cke_button"><a id="cke_54" class="cke_off cke_button_justifyright" title="Align Right" tabindex="-1" hidefocus="true" role="button" aria-labelledby="cke_54_label" onblur="this.style.cssText = this.style.cssText;" onkeydown="return CKEDITOR.tools.callFunction(106, event);" onfocus="return CKEDITOR.tools.callFunction(107, event);" onclick="CKEDITOR.tools.callFunction(108, this); return false;"><span class="cke_icon">&nbsp;</span><span id="cke_54_label" class="cke_label">Align Right</span></a></span></span><span class="cke_toolbar_end"></span></span></div><a style="display: none;" title="Expand Toolbar" id="cke_55" tabindex="-1" class="cke_toolbox_collapser cke_toolbox_collapser_min" onclick="CKEDITOR.tools.callFunction(109)"><span>▲</span></a></td></tr><tr role="presentation"><td id="cke_contents_editor_503cdc38e13a2" class="cke_contents" style="height: 180px; padding: 0px ! important;" role="presentation"><iframe style="width:100%;height:100%" title="Rich text editor, editor_503cdc38e13a2, press ALT 0 for help." src="" tabindex="2" allowtransparency="true" frameborder="0"></iframe></td></tr><tr style="-moz-user-select: none;" role="presentation"><td style="display: none; background: none repeat scroll 0% 0% transparent ! important; padding: 0px ! important;" id="cke_bottom_editor_503cdc38e13a2" class="cke_bottom" role="presentation"><div class="cke_resizer cke_resizer_ltr" title="Drag to resize" onmousedown="CKEDITOR.tools.callFunction(0, event)"></div></td></tr></tbody></table><style>.cke_skin_ips{visibility:hidden;}</style></span></span><span tabindex="-1" style="position:absolute;" role="presentation"></span></span>
	<p class="desc ipsPad" style="display: none" id="editor_html_message_editor_503cdc38e13a2">HTML
 mode is enabled. The rich text editor is not available while HTML is 
enabled. You may lose some formatting when you deselect HTML mode and 
switch back to the rich text editor.</p>
	<script type="text/javascript">
		ipb.textEditor.initialize('editor_503cdc38e13a2', { type: 'full',
																height: 180,
																minimize: '1',
																bypassCKEditor: 0,
																delayInit: 0,
																isHtml: 0,
																isRte: 1,
																noSmilies: 0,
																isTypingCallBack: ipb.topic.isTypingCallBack,
																ips_AutoSaveKey: 'c3168000742d32c4faa51da94e423feb',
												                ips_AutoSaveData: [] } );
	</script>
				<br>
				
				<fieldset class="right" id="fast_reply_controls">
					<input name="submit" class="input_submit" value="Post" tabindex="3" accesskey="s" id="submit_post" type="submit">&nbsp;&nbsp;<input name="preview" class="input_submit alt" value="More Reply Options" tabindex="0" id="full_compose" type="submit">			
				</fieldset>
			</form>
		</div>
		<div id="ips_HasReplies"></div>
	</div>
</div>
<script type="text/javascript">
	ipb.topic.fastReplyId	= 'editor_503cdc38e13a2';
</script>
<!-- Close topic -->
</div>
<!-- BOTTOM BUTTONS -->

	<br>
	<div class="clear clearfix left">
		

	<ul class="topic_share left shareButtons ipsList_inline">
	
		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=twitter;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via Twitter" class="_slink" id="slink_twitter"><img src="Event%20System%202.3%20into%202.0.php_files/twitter.png"></a></li>
	

		
				<li class="fbLike"><div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" data-href="http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/" data-send="false" data-layout="button_count" data-width="150" data-show-faces="false" data-action="like"><span style="height: 20px; width: 71px;"><iframe src="Event%20System%202.3%20into%202.0.php_files/like.htm" class="fb_ltr " title="Like this content on Facebook." style="border: medium none; overflow: hidden; height: 20px; width: 71px;" name="f1f9feee5d3ac0e" id="f1f63a3884c08f2" scrolling="no"></iframe></span></div><div class=" fb_reset" id="fb-root"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="Event%20System%202.3%20into%202.0.php_files/xd_arbiter.htm" name="fb_xdm_frame_http" id="fb_xdm_frame_http"></iframe><iframe src="Event%20System%202.3%20into%202.0.php_files/xd_arbiter_002.htm" name="fb_xdm_frame_https" id="fb_xdm_frame_https"></iframe></div><div></div></div></div></li>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
			
	

		
				<script gapi_processed="true" type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/plusone.js">
	
		{lang: 'en-GB'}
	
</script>
<li><div class="googlePlusOne"><div id="___plusone_0" style="height: 15px; width: 24px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background: none repeat scroll 0% 0% transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline;"><iframe title="+1" src="Event%20System%202.3%20into%202.0.php_files/fastbutton.htm" name="I0_1346165921879" id="I0_1346165921879" vspace="0" tabindex="0" style="position: static; top: 0px; width: 24px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 15px;" marginwidth="0" marginheight="0" hspace="0" allowtransparency="true" frameborder="0" scrolling="no" width="100%"></iframe></div></div></li>
			
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=digg;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via Digg" class="_slink" id="slink_digg"><img src="Event%20System%202.3%20into%202.0.php_files/digg.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=delicious;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via Del.icio.us" class="_slink" id="slink_delicious"><img src="Event%20System%202.3%20into%202.0.php_files/delicious.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=reddit;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via Reddit" class="_slink" id="slink_reddit"><img src="Event%20System%202.3%20into%202.0.php_files/reddit.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=stumble;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via StumbleUpon" class="_slink" id="slink_stumble"><img src="Event%20System%202.3%20into%202.0.php_files/stumble.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=email;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Share this link via Email" class="_slink" id="slink_email"><img src="Event%20System%202.3%20into%202.0.php_files/email.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=print;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Print" class="_slink" id="slink_print"><img src="Event%20System%202.3%20into%202.0.php_files/print.png"></a></li>
	

		<li><a href="http://www.touchofdeathforums.com/community/index.php?sharelink=download;aHR0cDovL3d3dy50b3VjaG9mZGVhdGhmb3J1bXMuY29tL2NvbW11bml0eS9pbmRleC5waHA_L3RvcGljLzEyODU5OS1hZGRpbmctZXZlbnQtc3lzdGVtLTIzLWludG8tMjAv;QWRkaW5nIEV2ZW50IFN5c3RlbSAyLjMgaW50byAyLjA," rel="nofollow" target="_blank" title="Download" class="_slink" id="slink_download"><img src="Event%20System%202.3%20into%202.0.php_files/download.png"></a></li>
	
	</ul>
	<script type="text/javascript">
		ipb.sharelinks.url   = "http://www.touchofdeathforums.com/community/index.php?/topic/128599-adding-event-system-23-into-20/";
		ipb.sharelinks.title = "Adding Event System 2.3 into 2.0";
		ipb.sharelinks.bname = "Eclipse Community";
	</script>

	</div>
	<br>

<!-- SAME TAGGED -->

<!-- ACTIVE USERS -->
<div id="topic_stats" class="statistics clear clearfix">
		<div id="topic_active_users" class="active_users">
			<h4 class="statistics_head">1 user(s) are reading this topic</h4>
			<p class="statistics_brief desc">1 members, 0 guests, 0 anonymous users</p>
			
				<br>
				<ul class="ipsList_inline">
					<a id="anonymous_element_24" hovercard-ref="member" hovercard-id="56158" class="url fn name   ___hover___member _hoversetup" href="http://www.touchofdeathforums.com/community/index.php?/user/56158-vakarieser/" title=""><span itemprop="name"><span style="color:green">vakarieser</span></span></a>
				</ul>
			
		</div>
	</div>


	<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/prettify.js"></script>
	<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/lang-sql.js"></script>
	<!-- By default we load generic code, php, css, sql and xml/html; load others here if desired -->
	<script type="text/javascript">
	//<![CDATA[
		Event.observe( window, 'load', function(e){ prettyPrint() });
	//]]>
	</script>
<div id="multiQuoteInsert" style="display: none;" class="ipsFloatingAction">
	<span class="ipsButton no_width" id="mqbutton">Reply to quoted posts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#" id="multiQuoteClear" class="ipsType_smaller desc" title="Clear the posts you have selected with MultiQuote">Clear</a> &nbsp;&nbsp;&nbsp;
</div>
<form id="modform" method="post" action="http://www.touchofdeathforums.com/community/index.php?">
	<input name="app" value="forums" type="hidden">
	<input name="module" value="moderate" type="hidden">
	<input name="section" value="moderate" type="hidden">
	<input name="do" value="postchoice" type="hidden">
	<input name="f" value="76" type="hidden">
	<input name="t" value="128599" type="hidden">
	<input name="auth_key" value="bebd230150525e2b52ebad4aacd61915" type="hidden">
	<input name="st" value="" type="hidden">
	<input value="" name="selectedpidsJS" id="selectedpidsJS" type="hidden">
	<input name="tact" id="tact" value="" type="hidden">
</form>
				
					<div class="ipsAd"><center><iframe src="Event%20System%202.3%20into%202.0.php_files/affiliation.htm" frameborder="0" height="181" width="740"></iframe></center></div>
				
				<ol class="breadcrumb bottom ipsList_inline left clearfix clear">
Theme Designed by: Glenn van Cauter (Socuine), Coded by: Elliott Brown (Aero/EBrown)<br>
											<li><a href="http://www.touchofdeathforums.com/community/">Eclipse Community</a></li>
							
						
							<li><span class="nav_sep">→</span> <a href="http://www.touchofdeathforums.com/community/index.php?/forum/6-development/" title="Return to Development">Development</a></li>
							
						

							<li><span class="nav_sep">→</span> <a href="http://www.touchofdeathforums.com/community/index.php?/forum/17-tutorials/" title="Return to Tutorials">Tutorials</a></li>
							
						

							<li><span class="nav_sep">→</span> <a href="http://www.touchofdeathforums.com/community/index.php?/forum/76-source/" title="Return to Source">Source</a></li>
							
						

					
					<li class="right ipsType_smaller">
						<a rel="nofollow" href="http://www.touchofdeathforums.com/community/index.php?/privacypolicy/">Privacy Policy</a>
					</li>
					
						
				</ol>
			</div>
			<!-- ::: FOOTER (Change skin, language, mark as read, etc) ::: -->
			<div id="footer_utilities" class="main_width clearfix clear">
				<a rel="nofollow" href="#top" id="backtotop" title="Go to top"><img src="Event%20System%202.3%20into%202.0.php_files/top.png" alt=""></a>
				<ul class="ipsList_inline left">
					<li>
						<img src="Event%20System%202.3%20into%202.0.php_files/feed.png" alt="RSS Feed" id="rss_feed" class="clickable"><ul style="position: absolute; display: none; z-index: 9999;" id="rss_menu" class="ipbmenu_content"><li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4-gallery/" title="Gallery">Gallery</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3-wiki/" title="Wiki">Wiki</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c1-articles/" title="Articles: Articles">Articles: Articles</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c4-pages/" title="Articles: Pages">Articles: Pages</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c5-miscellaneous/" title="Articles: Miscellaneous">Articles: Miscellaneous</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c2-forum-integration/" title="Articles: Forum Integration">Articles: Forum Integration</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c3-frontpage/" title="Articles: Frontpage">Articles: Frontpage</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c6-databases/" title="Articles: Databases">Articles: Databases</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c7-templates/" title="Articles: Templates">Articles: Templates</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/1c8-media/" title="Articles: Media">Articles: Media</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c26-sprites/" title="Gallery: Sprites">Gallery: Sprites</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c30-tiles/" title="Gallery: Tiles">Gallery: Tiles</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c31-gui/" title="Gallery: GUI">Gallery: GUI</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c32-music/" title="Gallery: Music">Gallery: Music</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c33-items/" title="Gallery: Items">Gallery: Items</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c34-spells/" title="Gallery: Spells">Gallery: Spells</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c35-other/" title="Gallery: Other">Gallery: Other</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/4c36-tools/" title="Gallery: Tools">Gallery: Tools</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c10-sprites/" title="Media Demo: Sprites">Media Demo: Sprites</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c27-tiles/" title="Media Demo: Tiles">Media Demo: Tiles</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c28-gui/" title="Media Demo: GUI">Media Demo: GUI</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/2c29-music/" title="Media Demo: Music">Media Demo: Music</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c15-eclipse-nightly/" title="Wiki: Eclipse Nightly">Wiki: Eclipse Nightly</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c13-event-system/" title="Wiki: Event System">Wiki: Event System</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c16-eclipse-origins/" title="Wiki: Eclipse Origins">Wiki: Eclipse Origins</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c17-visual-basic-6/" title="Wiki: Visual Basic 6">Wiki: Visual Basic 6</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c23-c/" title="Wiki: C++">Wiki: C++</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c37-eclipsenet/" title="Wiki: Eclipse.net">Wiki: Eclipse.net</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c40-website/" title="Wiki: Website">Wiki: Website</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c19-tutorials/" title="Wiki: Tutorials">Wiki: Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c20-source-tutorials/" title="Wiki: Source Tutorials">Wiki: Source Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c21-tutorials/" title="Wiki: Tutorials">Wiki: Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c22-source-tutorials/" title="Wiki: Source Tutorials">Wiki: Source Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c18-source-tutorials/" title="Wiki: Source Tutorials">Wiki: Source Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c24-tutorials/" title="Wiki: Tutorials">Wiki: Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c25-codebase/" title="Wiki: Codebase">Wiki: Codebase</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c38-tutorials/" title="Wiki: Tutorials">Wiki: Tutorials</a></li>
<li style="z-index: 10000;"><a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?/rss/ccs/3c39-source-tutorials/" title="Wiki: Source Tutorials">Wiki: Source Tutorials</a></li></ul>
					</li>
					
							
								<li>
									<a class="" rel="nofollow" id="new_skin" href="#">Change Theme</a>			
									<ul id="new_skin_menucontent" class="ipbmenu_content with_checks" style="display: none; position: absolute; z-index: 9999;">
										
											<li style="z-index: 10000;" class="selected">
												<a style="z-index: 10000;" href="#" data-clicklaunch="changeSkin" data-skinid="4">Eclipse 3.1 (Import)</a>
											</li>
										

											<li style="z-index: 10000;">
												<a style="z-index: 10000;" href="#" data-clicklaunch="changeSkin" data-skinid="5">MLP Renewed</a>
											</li>
										

											<li style="z-index: 10000;">
												<a style="z-index: 10000;" href="#" data-clicklaunch="changeSkin" data-skinid="6">MLP2</a>
											</li>
										
									</ul>
								</li>
							
					
					
						<li>
							<a class="" rel="nofollow" id="mark_all_read" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=all&amp;k=bebd230150525e2b52ebad4aacd61915" title="Mark all as read">Mark Community Read</a>
							<ul id="mark_all_read_menucontent" class="ipbmenu_content" style="display: none; position: absolute; z-index: 9999;">
								
									<li style="z-index: 10000;">
										
									</li>
								

									<li style="z-index: 10000;">
										<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=app&amp;markApp=ccs&amp;k=bebd230150525e2b52ebad4aacd61915">Home</a>
									</li>
								

									<li style="z-index: 10000;">
										<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=app&amp;markApp=forums&amp;k=bebd230150525e2b52ebad4aacd61915">Forums</a>
									</li>
								

									<li style="z-index: 10000;">
										<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=app&amp;markApp=members&amp;k=bebd230150525e2b52ebad4aacd61915">Members</a>
									</li>
								

									<li style="z-index: 10000;">
										<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=app&amp;markApp=tracker&amp;k=bebd230150525e2b52ebad4aacd61915">Bug Tracker</a>
									</li>
								
								<li style="z-index: 10000;">
									<a style="z-index: 10000;" href="http://www.touchofdeathforums.com/community/index.php?app=forums&amp;module=forums&amp;section=markasread&amp;marktype=all&amp;k=bebd230150525e2b52ebad4aacd61915"><strong style="z-index: 10000;">Mark all as read</strong></a>
								</li>
							</ul>
						</li>
					
					<li>
						<a href="http://www.touchofdeathforums.com/community/index.php?app=core&amp;module=help" title="View help" rel="help" accesskey="6">Help</a>
					</li>	
				</ul>
				<!-- Copyright Information -->
        				  <p id="copyright">
        				  	<a href="http://www.invisionpower.com/products/board/" title="Community Forum Software by Invision Power Services">Community Forum Software by IP.Board</a><br>Licensed to: Eclipse</p>
		<!-- / Copyright -->
			</div>
			
			
			
				<script type="text/javascript" src="Event%20System%202.3%20into%202.0.php_files/lightbox.js"></script>
<script type="text/javascript">
//<![CDATA[
	// Lightbox Configuration
	LightboxOptions = Object.extend({
	    fileLoadingImage:        'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/lightbox/loading.gif',     
	    fileBottomNavCloseImage: 'http://www.touchofdeathforums.com/community/public/style_images/eclipse31/lightbox/closelabel.gif',
	    overlayOpacity: 0.8,   // controls transparency of shadow overlay
	    animate: true,         // toggles resizing animations
	    resizeSpeed: 7,        // controls the speed of the image resizing animations (1=slowest and 10=fastest)
	    borderSize: 10,         //if you adjust the padding in the CSS, you will need to update this variable
		// When grouping images this is used to write: Image # of #.
		// Change it for non-english localization
		labelImage: "Image",
		labelOf: "of"
	}, window.LightboxOptions || {});
/* Watch for a lightbox image and set up our downloadbutton watcher */
document.observe('click', (function(event){
    var target = event.findElement('a[rel*="lightbox"]') || event.findElement('area[rel*="lightbox"]') || event.findElement('span[rel*="lightbox"]');
    if (target) {
        event.stop();
        gbl_addDownloadButton();
    }
}).bind(this));
var _to    = '';
var _last  = '';
function gbl_addDownloadButton()
{
	if ( typeof( ipsLightbox.lightboxImage ) != 'undefined' && ipsLightbox.lightboxImage.src )
	{
		if ( _last != ipsLightbox.lightboxImage.src )
		{
			if ( ! $('gbl_d') )
			{
				$('bottomNav').insert( { top: "<div id='gbl_d' style='text-align:right;padding-bottom:4px;'></div>" } );
			}
			
			$('gbl_d').update( "<a href='"+ ipsLightbox.lightboxImage.src + "' target='_blank'><img src='http://www.touchofdeathforums.com/community/public/style_images/eclipse31/lightbox/download-icon.png' /></a>" );
			
			_last = ipsLightbox.lightboxImage.src;
		}
	}
	
	/* Check for init and then keep checking for new image */
	_to = setTimeout( "gbl_addDownloadButton()", 1000 );
}
//]]>
</script>
			
			
		</div>
		
		
	
<div style="position: absolute; display: none; z-index: 9999;" jumpid="0737678001" id="pj_anonymous_element_1_wrap" class="ipbmenu_content pj0737678001"><h3 style="z-index: 10000;" class="bar">Jump to page</h3><p style="z-index: 10000;" class="ipsPad"><input style="z-index: 10000;" class="input_text" id="pj_anonymous_element_1_input" size="8" type="text"> <input style="z-index: 10000;" value="Go" class="input_submit add_folder" id="pj_anonymous_element_1_submit" type="submit"></p></div><div style="position: absolute; display: none; z-index: 9999;" jumpid="0737678001" id="pj_anonymous_element_2_wrap" class="ipbmenu_content pj0737678001"><h3 style="z-index: 10000;" class="bar">Jump to page</h3><p style="z-index: 10000;" class="ipsPad"><input style="z-index: 10000;" class="input_text" id="pj_anonymous_element_2_input" size="8" type="text"> <input style="z-index: 10000;" value="Go" class="input_submit add_folder" id="pj_anonymous_element_2_submit" type="submit"></p></div><div style="display: none;" id="overlay"></div><div style="display: none;" id="lightbox"><div style="width: 250px; height: 250px;" id="outerImageContainer"><div id="imageContainer"><img id="lightboxImage"><div id="hoverNav"><a id="prevLink" href="#"></a><a id="nextLink" href="#"></a></div><div id="loading"><a id="loadingLink" href="#"><img src="Event%20System%202.3%20into%202.0.php_files/loading.gif"></a></div></div></div><div id="imageDataContainer"><div id="imageData"><div id="imageDetails"><span id="caption"></span><span id="numberDisplay"></span></div><div id="bottomNav"><a id="bottomNavClose" href="#"><img src="Event%20System%202.3%20into%202.0.php_files/closelabel.gif"></a></div></div></div></div></body></html>